
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://interview-notes.com/spring/security/security/">
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../annotations/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Spring Security - Interview Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spring-security" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Interview Notes" class="md-header__button md-logo" aria-label="Interview Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Interview Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Spring Security
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../java/" class="md-tabs__link">
          
  
    
  
  Languages

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Web Development

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../mq/kafka/" class="md-tabs__link">
          
  
    
  
  MQ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../devops/" class="md-tabs__link">
          
  
    
  
  DevOps

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../db/" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7v10c0 2.21 3.59 4 8 4s8-1.79 8-4V7c0-2.21-3.58-4-8-4m6 14c0 .5-2.13 2-6 2s-6-1.5-6-2v-2.23c1.61.78 3.72 1.23 6 1.23s4.39-.45 6-1.23V17m0-4.55c-1.3.95-3.58 1.55-6 1.55s-4.7-.6-6-1.55V9.64c1.47.83 3.61 1.36 6 1.36s4.53-.53 6-1.36v2.81M12 9C8.13 9 6 7.5 6 7s2.13-2 6-2 6 1.5 6 2-2.13 2-6 2Z"/></svg>
    
  
  Database

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../design-pattern/" class="md-tabs__link">
          
  
    
  
  Design Pattern

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ds-algo/" class="md-tabs__link">
          
  
    
  
  Algorithms

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../qa/" class="md-tabs__link">
          
  
    
  
  QA

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../misc/agile/" class="md-tabs__link">
          
  
    
  
  Misc

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../tags/" class="md-tabs__link">
        
  
    
  
  Tags

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Interview Notes" class="md-nav__button md-logo" aria-label="Interview Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Interview Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Languages
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../java/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Java
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java8/java8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java 8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java8/FunctionalInterface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../java/java17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java 17
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../nodejs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Node.js
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nodejs/module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nodejs/eventloop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event Loop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nodejs/express/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Express.js
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../python/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Python
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../golang/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Golang
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Golang
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Web Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Web Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Spring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Spring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Spring Security
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Spring Security
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spring-security_1" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Spring Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-spring-security-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Spring Security Matters:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Spring Security Matters:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-protecting-user-data" class="md-nav__link">
    <span class="md-ellipsis">
      1. Protecting User Data:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-preventing-unauthorized-access" class="md-nav__link">
    <span class="md-ellipsis">
      2. Preventing Unauthorized Access:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-safeguarding-against-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      3. Safeguarding Against Attacks:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Using Spring Security:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features-and-customization" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features and Customization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features and Customization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-custom-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      1. Custom Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      2. Method-Level Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-custom-access-denied-handling" class="md-nav__link">
    <span class="md-ellipsis">
      3. Custom Access Denied Handling:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-security-headers" class="md-nav__link">
    <span class="md-ellipsis">
      4. Security Headers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integrating-spring-security-with-oauth-20" class="md-nav__link">
    <span class="md-ellipsis">
      Integrating Spring Security with OAuth 2.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-oauth-20" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding OAuth 2.0:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-oauth-20-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why OAuth 2.0 Matters:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why OAuth 2.0 Matters:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-third-party-integration" class="md-nav__link">
    <span class="md-ellipsis">
      2. Third-Party Integration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-single-sign-on-sso" class="md-nav__link">
    <span class="md-ellipsis">
      3. Single Sign-On (SSO):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-oauth-20-with-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing OAuth 2.0 with Spring Security:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-components-of-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components of Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components of Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      1. Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      2. Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-filters" class="md-nav__link">
    <span class="md-ellipsis">
      3. Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-security-context" class="md-nav__link">
    <span class="md-ellipsis">
      4. Security Context:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-provider-and-manager" class="md-nav__link">
    <span class="md-ellipsis">
      5. Provider and Manager:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      6. Configuration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-sessions-and-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      7. Sessions and Tokens:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      8. Exception Handling:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-security-events-and-auditing" class="md-nav__link">
    <span class="md-ellipsis">
      9. Security Events and Auditing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-csrf-protection" class="md-nav__link">
    <span class="md-ellipsis">
      10. CSRF Protection:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-password-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      11. Password Encoding:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-remember-me-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      12. Remember-Me Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication and Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication and Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-authentication-example" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Authentication Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-authorization-example" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Authorization Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-securitys-role" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security's Role:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-flow-in-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Flow in Spring Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Flow:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-spring-security-features" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Spring Security Features:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-and-authorization_1" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication and Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication and Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication_1" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization_1" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-vs-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication vs. Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-they-work-together" class="md-nav__link">
    <span class="md-ellipsis">
      How They Work Together:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-principal-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Principal and Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Principal and Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principal" class="md-nav__link">
    <span class="md-ellipsis">
      Principal:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication_2" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-and-principal" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security and Principal:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security and Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-example" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-principal-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the Principal and Authentication:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accessing the Principal and Authentication:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-the-principal" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the Principal:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-cases-for-principal-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases for Principal and Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-userdetails-and-userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding UserDetails and UserDetailsService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding UserDetails and UserDetailsService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#userdetails" class="md-nav__link">
    <span class="md-ellipsis">
      UserDetails:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      UserDetailsService:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-userdetails-and-userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing UserDetails and UserDetailsService:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-example_1" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-custom-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Custom Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing Custom Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-implement-custom-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Implement Custom Authentication:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps to Implement Custom Authentication:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-a-user-details-class" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create a User Details Class:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-define-a-user-details-service" class="md-nav__link">
    <span class="md-ellipsis">
      2. Define a User Details Service:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-implement-authentication-provider" class="md-nav__link">
    <span class="md-ellipsis">
      3. Implement Authentication Provider:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-configure-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      4. Configure Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-implement-authentication-logic" class="md-nav__link">
    <span class="md-ellipsis">
      5. Implement Authentication Logic:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-implement-userdetails-logic" class="md-nav__link">
    <span class="md-ellipsis">
      6. Implement UserDetails Logic:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-additional-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      7. Additional Configuration:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#role-based-and-permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based and Permission-Based Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role-Based and Permission-Based Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based Access Control:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role-Based Access Control:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Permission-Based Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Permission-Based Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-based-vs-permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based vs. Permission-Based Access Control:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combining-role-based-and-permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Combining Role-Based and Permission-Based Access Control:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Role-Based Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Role-Based Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-configure-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Configure Role-Based Access Control:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps to Configure Role-Based Access Control:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-define-roles" class="md-nav__link">
    <span class="md-ellipsis">
      1. Define Roles:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-access-rules" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configure Access Rules:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-security" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configure Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-assign-roles-to-users" class="md-nav__link">
    <span class="md-ellipsis">
      4. Assign Roles to Users:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-secure-resources-and-actions" class="md-nav__link">
    <span class="md-ellipsis">
      5. Secure Resources and Actions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-considerations-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Considerations and Best Practices:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explaining-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      Explaining Method-Level Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explaining Method-Level Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Method-Level Security:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Method-Level Security:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-components" class="md-nav__link">
    <span class="md-ellipsis">
      Key Components:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Implementation:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Implementation:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enable-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enable Method-Level Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-preauthorize-and-postauthorize-annotations" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use @PreAuthorize and @PostAuthorize Annotations:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-define-access-control-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      3. Define Access Control Expressions:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-access-control-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      4. Access Control Expressions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-considerations-and-best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Considerations and Best Practices:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-spring-security-filters-and-their-purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Spring Security Filters and Their Purpose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Spring Security Filters and Their Purpose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purpose-of-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Purpose of Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#important-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Important Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-of-a-spring-security-filter-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example of a Spring Security Filter Configuration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customizing-and-extending-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing and Extending Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-order-and-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Order and Execution:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-chain-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Chain Overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-filters-and-customization" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Filters and Customization:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring-security-session-management-and-authentication-mechanisms-jwt-and-oauth2" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Session Management and Authentication Mechanisms (JWT and OAuth2)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring Security Session Management and Authentication Mechanisms (JWT and OAuth2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spring-security-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Session Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwt-json-web-tokens-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      JWT (JSON Web Tokens) Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oauth2-integration" class="md-nav__link">
    <span class="md-ellipsis">
      OAuth2 Integration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-considerations-and-best-practices_2" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Considerations and Best Practices:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Authentication Providers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Authentication Providers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#role-of-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Role of Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#built-in-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-example-with-daoauthenticationprovider" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Example with DaoAuthenticationProvider:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-provider-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Provider Configuration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Flow:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples-of-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Examples of Authentication Providers:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples of Authentication Providers:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-pingfederate" class="md-nav__link">
    <span class="md-ellipsis">
      1. PingFederate:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-okta" class="md-nav__link">
    <span class="md-ellipsis">
      2. Okta:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-custom-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      3. Custom Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-microsoft-azure-active-directory-azure-ad" class="md-nav__link">
    <span class="md-ellipsis">
      4. Microsoft Azure Active Directory (Azure AD):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-keycloak" class="md-nav__link">
    <span class="md-ellipsis">
      5. Keycloak:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-security-best-practices-with-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Common Security Best Practices with Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Security Best Practices with Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-strong-password-management" class="md-nav__link">
    <span class="md-ellipsis">
      1. Strong Password Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Session Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-secure-communication" class="md-nav__link">
    <span class="md-ellipsis">
      3. Secure Communication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-user-account-management" class="md-nav__link">
    <span class="md-ellipsis">
      4. User Account Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-auditing-and-logging" class="md-nav__link">
    <span class="md-ellipsis">
      5. Auditing and Logging:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-security-headers" class="md-nav__link">
    <span class="md-ellipsis">
      6. Security Headers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      7. Role-Based Access Control:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-regular-security-updates" class="md-nav__link">
    <span class="md-ellipsis">
      8. Regular Security Updates:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-implement-two-factor-authentication-2fa" class="md-nav__link">
    <span class="md-ellipsis">
      9. Implement Two-Factor Authentication (2FA):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-protect-against-cross-site-request-forgery-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      10. Protect Against Cross-Site Request Forgery (CSRF):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-validate-and-sanitize-user-input" class="md-nav__link">
    <span class="md-ellipsis">
      11. Validate and Sanitize User Input:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-rate-limiting-and-brute-force-protection" class="md-nav__link">
    <span class="md-ellipsis">
      12. Rate Limiting and Brute-Force Protection:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      13. Security Testing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      14. Error Handling:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-security-headers-in-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      15. Security Headers in Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-regular-security-training" class="md-nav__link">
    <span class="md-ellipsis">
      16. Regular Security Training:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-compliance-with-regulations" class="md-nav__link">
    <span class="md-ellipsis">
      17. Compliance with Regulations:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secure-rest-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Secure REST APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Secure REST APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-to-securing-rest-apis-with-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Securing REST APIs with Spring Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-the-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the Basics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-guide-to-securing-rest-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Guide to Securing REST APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step-by-Step Guide to Securing REST APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-spring-security-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      1. Add Spring Security Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-websecurityconfigureradapter" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configure WebSecurityConfigurerAdapter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-implement-authentication-mechanism" class="md-nav__link">
    <span class="md-ellipsis">
      3. Implement Authentication Mechanism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-customize-userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      4. Customize UserDetailsService
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-secure-rest-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      5. Secure REST Endpoints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enhancing-security-with-advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Enhancing Security with Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enhancing Security with Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-implement-jwt-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      6. Implement JWT Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-secure-rest-apis-with-oauth2" class="md-nav__link">
    <span class="md-ellipsis">
      7. Secure REST APIs with OAuth2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-use-https-for-secure-communication" class="md-nav__link">
    <span class="md-ellipsis">
      8. Use HTTPS for Secure Communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-role-based-access-control-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      9. Role-Based Access Control (RBAC)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-monitor-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      10. Monitor and Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-thoughts" class="md-nav__link">
    <span class="md-ellipsis">
      Final Thoughts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-jwt-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing JWT Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing JWT Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-add-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Add Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-jwt-utility-class" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create JWT Utility Class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-implement-authentication-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Implement Authentication Filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-spring-security-to-use-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Configure Spring Security to Use JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-add-authentication-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Add Authentication Endpoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-jwt-authentication-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced JWT Authentication Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced JWT Authentication Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#refresh-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Refresh Tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Exception Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cors-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      CORS Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-token-storage-on-client-side" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Token Storage on Client Side
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-revocation-and-blacklisting" class="md-nav__link">
    <span class="md-ellipsis">
      Token Revocation and Blacklisting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-and-analytics" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring and Analytics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-enhancements-and-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Code Enhancements and Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Security Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring-security-filter-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Filter Chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring Security Filter Chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#role-in-the-security-process" class="md-nav__link">
    <span class="md-ellipsis">
      Role in the Security Process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role in the Security Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-request-capture" class="md-nav__link">
    <span class="md-ellipsis">
      1. Request Capture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      2. Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      3. Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      4. Exception Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      5. Session Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-csrf-protection" class="md-nav__link">
    <span class="md-ellipsis">
      6. CSRF Protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-logout-processing" class="md-nav__link">
    <span class="md-ellipsis">
      7. Logout Processing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customization-and-extension" class="md-nav__link">
    <span class="md-ellipsis">
      Customization and Extension
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customizing-the-filter-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing the Filter Chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customizing the Filter Chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-httpsecurity" class="md-nav__link">
    <span class="md-ellipsis">
      Using HttpSecurity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-custom-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Custom Filters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-filters-in-the-spring-security-filter-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Key Filters in the Spring Security Filter Chain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extending-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Extending Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extending Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-custom-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Custom Filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overriding-default-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      Overriding Default Behavior
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-context-persistence-across-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Security Context Persistence Across Requests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-custom-roles" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Custom Roles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Custom Roles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-define-custom-roles" class="md-nav__link">
    <span class="md-ellipsis">
      1. Define Custom Roles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-assign-roles-to-users" class="md-nav__link">
    <span class="md-ellipsis">
      2. Assign Roles to Users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-secure-endpoints-using-custom-roles" class="md-nav__link">
    <span class="md-ellipsis">
      3. Secure Endpoints Using Custom Roles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Secure Endpoints Using Custom Roles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-method-level-security-annotations" class="md-nav__link">
    <span class="md-ellipsis">
      Using Method-Level Security Annotations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-url-based-security" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring URL-Based Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-role-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      4. Role Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-role-based-access-control-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Role-Based Access Control and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-role-assignment-and-management" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Role Assignment and Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-grained-permissions-with-spring-security-acl" class="md-nav__link">
    <span class="md-ellipsis">
      Fine-Grained Permissions with Spring Security ACL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-security-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Method Security Expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-and-permission-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Role and Permission Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-security-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Security Configurations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Security Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Security Filters 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../springboot/spring-boot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Boot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../springboot/springboot-actuator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Boot Actuator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spring-mvc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring MVC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transaction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Transaction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../webFlux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring WebFlux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../microservices/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Microservices
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Microservices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../microservices/solid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SOLID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../angular/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Angular
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Angular
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../javascript/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Javascript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../typescript/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    TypeScript
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            TypeScript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../react/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    React
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            React
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/lifecycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lifecycle Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/react-component/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React Component
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/jest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/enzyme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enzyme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/eslint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ESLint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/react-router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React Router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/redux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/redux-thunk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redux Thunk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/rest-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rest API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../react/nextjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../html/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HTML
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            HTML
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../css/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    CSS
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            CSS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MQ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            MQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache Kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/rebbitmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RabbitMQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/activemq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache ActiveMQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/sqs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Amazon SQS (Simple Queue Service)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/servicebus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft Azure sqs.md
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google Cloud Pub/Sub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mq/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis Pub/Sub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../devops/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            DevOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/cloud/aws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/cloud/azure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/cloud/gcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/cloud/openshift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/vcs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VCS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/cicd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI/CD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/orchestration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containerization and Orchestration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/iac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure as Code (IaC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring and Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Container Registries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Scanning and Compliance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/artifact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artifact Repository
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/gitops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitOps
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../db/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7v10c0 2.21 3.59 4 8 4s8-1.79 8-4V7c0-2.21-3.58-4-8-4m6 14c0 .5-2.13 2-6 2s-6-1.5-6-2v-2.23c1.61.78 3.72 1.23 6 1.23s4.39-.45 6-1.23V17m0-4.55c-1.3.95-3.58 1.55-6 1.55s-4.7-.6-6-1.55V9.64c1.47.83 3.61 1.36 6 1.36s4.53-.53 6-1.36v2.81M12 9C8.13 9 6 7.5 6 7s2.13-2 6-2 6 1.5 6 2-2.13 2-6 2Z"/></svg>
  
  <span class="md-ellipsis">
    Database
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/cassandra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassandra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/couchbase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Couchbase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/dynamoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/oracle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oracle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/postgreSql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../design-pattern/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Design Pattern
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Design Pattern
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design-pattern/behavioral-pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Behavioral Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design-pattern/creational-pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creational Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design-pattern/structural-pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structural Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design-pattern/other-pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ds-algo/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Algorithms
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ds-algo/algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Algorithms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../qa/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    QA
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            QA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/cucumber/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cucumber
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/website/selenium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selenium
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/website/protractor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protractor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/website/cypress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cypress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/website/webdriverIO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebdriverIO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/apigee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apigee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/apigee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cucumber
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/jest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/mocha-chai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mocha/Chai
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/karate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    karate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/postman/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postman
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/rest-assured/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rest Assured
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/microservices/testng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestNG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/mobile/appium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Appium
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/mobile/robot-framework/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Robot Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../qa/jmeter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JMeter
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/agile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agile methodology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/security-scan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Scan Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/production-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Production Support Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spring-security_1" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Spring Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-spring-security-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Spring Security Matters:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Spring Security Matters:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-protecting-user-data" class="md-nav__link">
    <span class="md-ellipsis">
      1. Protecting User Data:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-preventing-unauthorized-access" class="md-nav__link">
    <span class="md-ellipsis">
      2. Preventing Unauthorized Access:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-safeguarding-against-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      3. Safeguarding Against Attacks:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Using Spring Security:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features-and-customization" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features and Customization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features and Customization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-custom-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      1. Custom Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      2. Method-Level Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-custom-access-denied-handling" class="md-nav__link">
    <span class="md-ellipsis">
      3. Custom Access Denied Handling:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-security-headers" class="md-nav__link">
    <span class="md-ellipsis">
      4. Security Headers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integrating-spring-security-with-oauth-20" class="md-nav__link">
    <span class="md-ellipsis">
      Integrating Spring Security with OAuth 2.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-oauth-20" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding OAuth 2.0:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-oauth-20-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why OAuth 2.0 Matters:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why OAuth 2.0 Matters:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-third-party-integration" class="md-nav__link">
    <span class="md-ellipsis">
      2. Third-Party Integration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-single-sign-on-sso" class="md-nav__link">
    <span class="md-ellipsis">
      3. Single Sign-On (SSO):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-oauth-20-with-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing OAuth 2.0 with Spring Security:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-components-of-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components of Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components of Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      1. Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      2. Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-filters" class="md-nav__link">
    <span class="md-ellipsis">
      3. Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-security-context" class="md-nav__link">
    <span class="md-ellipsis">
      4. Security Context:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-provider-and-manager" class="md-nav__link">
    <span class="md-ellipsis">
      5. Provider and Manager:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      6. Configuration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-sessions-and-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      7. Sessions and Tokens:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      8. Exception Handling:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-security-events-and-auditing" class="md-nav__link">
    <span class="md-ellipsis">
      9. Security Events and Auditing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-csrf-protection" class="md-nav__link">
    <span class="md-ellipsis">
      10. CSRF Protection:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-password-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      11. Password Encoding:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-remember-me-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      12. Remember-Me Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication and Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication and Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-authentication-example" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Authentication Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-authorization-example" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Authorization Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-securitys-role" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security's Role:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-flow-in-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Flow in Spring Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Flow:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-spring-security-features" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Spring Security Features:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-and-authorization_1" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication and Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication and Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication_1" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization_1" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-vs-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication vs. Authorization:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-they-work-together" class="md-nav__link">
    <span class="md-ellipsis">
      How They Work Together:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-principal-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Principal and Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Principal and Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principal" class="md-nav__link">
    <span class="md-ellipsis">
      Principal:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication_2" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-and-principal" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security and Principal:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring-security-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security and Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-example" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-principal-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the Principal and Authentication:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accessing the Principal and Authentication:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-the-principal" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the Principal:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-cases-for-principal-and-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases for Principal and Authentication:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-userdetails-and-userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding UserDetails and UserDetailsService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding UserDetails and UserDetailsService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#userdetails" class="md-nav__link">
    <span class="md-ellipsis">
      UserDetails:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      UserDetailsService:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-userdetails-and-userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing UserDetails and UserDetailsService:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-example_1" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-custom-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Custom Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing Custom Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-implement-custom-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Implement Custom Authentication:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps to Implement Custom Authentication:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-a-user-details-class" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create a User Details Class:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-define-a-user-details-service" class="md-nav__link">
    <span class="md-ellipsis">
      2. Define a User Details Service:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-implement-authentication-provider" class="md-nav__link">
    <span class="md-ellipsis">
      3. Implement Authentication Provider:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-configure-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      4. Configure Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-implement-authentication-logic" class="md-nav__link">
    <span class="md-ellipsis">
      5. Implement Authentication Logic:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-implement-userdetails-logic" class="md-nav__link">
    <span class="md-ellipsis">
      6. Implement UserDetails Logic:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-additional-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      7. Additional Configuration:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#role-based-and-permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based and Permission-Based Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role-Based and Permission-Based Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based Access Control:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role-Based Access Control:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Permission-Based Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Permission-Based Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-based-vs-permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based vs. Permission-Based Access Control:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combining-role-based-and-permission-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Combining Role-Based and Permission-Based Access Control:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Role-Based Access Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Role-Based Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-configure-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Configure Role-Based Access Control:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps to Configure Role-Based Access Control:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-define-roles" class="md-nav__link">
    <span class="md-ellipsis">
      1. Define Roles:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-access-rules" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configure Access Rules:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-security" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configure Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-assign-roles-to-users" class="md-nav__link">
    <span class="md-ellipsis">
      4. Assign Roles to Users:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-secure-resources-and-actions" class="md-nav__link">
    <span class="md-ellipsis">
      5. Secure Resources and Actions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-considerations-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Considerations and Best Practices:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explaining-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      Explaining Method-Level Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explaining Method-Level Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Method-Level Security:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Method-Level Security:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-components" class="md-nav__link">
    <span class="md-ellipsis">
      Key Components:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Implementation:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Implementation:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enable-method-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enable Method-Level Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-preauthorize-and-postauthorize-annotations" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use @PreAuthorize and @PostAuthorize Annotations:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-define-access-control-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      3. Define Access Control Expressions:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-access-control-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      4. Access Control Expressions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-considerations-and-best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Considerations and Best Practices:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-spring-security-filters-and-their-purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Spring Security Filters and Their Purpose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Spring Security Filters and Their Purpose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purpose-of-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Purpose of Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#important-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Important Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-of-a-spring-security-filter-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example of a Spring Security Filter Configuration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customizing-and-extending-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing and Extending Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-order-and-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Order and Execution:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-chain-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Chain Overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-filters-and-customization" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Filters and Customization:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring-security-session-management-and-authentication-mechanisms-jwt-and-oauth2" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Session Management and Authentication Mechanisms (JWT and OAuth2)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring Security Session Management and Authentication Mechanisms (JWT and OAuth2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spring-security-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Session Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwt-json-web-tokens-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      JWT (JSON Web Tokens) Authentication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oauth2-integration" class="md-nav__link">
    <span class="md-ellipsis">
      OAuth2 Integration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-considerations-and-best-practices_2" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Considerations and Best Practices:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Authentication Providers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Authentication Providers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#role-of-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Role of Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#built-in-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-example-with-daoauthenticationprovider" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Example with DaoAuthenticationProvider:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-provider-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Provider Configuration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Flow:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples-of-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Examples of Authentication Providers:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples of Authentication Providers:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-pingfederate" class="md-nav__link">
    <span class="md-ellipsis">
      1. PingFederate:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-okta" class="md-nav__link">
    <span class="md-ellipsis">
      2. Okta:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-custom-authentication-providers" class="md-nav__link">
    <span class="md-ellipsis">
      3. Custom Authentication Providers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-microsoft-azure-active-directory-azure-ad" class="md-nav__link">
    <span class="md-ellipsis">
      4. Microsoft Azure Active Directory (Azure AD):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-keycloak" class="md-nav__link">
    <span class="md-ellipsis">
      5. Keycloak:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-security-best-practices-with-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Common Security Best Practices with Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Security Best Practices with Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-strong-password-management" class="md-nav__link">
    <span class="md-ellipsis">
      1. Strong Password Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Session Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-secure-communication" class="md-nav__link">
    <span class="md-ellipsis">
      3. Secure Communication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-user-account-management" class="md-nav__link">
    <span class="md-ellipsis">
      4. User Account Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-auditing-and-logging" class="md-nav__link">
    <span class="md-ellipsis">
      5. Auditing and Logging:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-security-headers" class="md-nav__link">
    <span class="md-ellipsis">
      6. Security Headers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      7. Role-Based Access Control:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-regular-security-updates" class="md-nav__link">
    <span class="md-ellipsis">
      8. Regular Security Updates:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-implement-two-factor-authentication-2fa" class="md-nav__link">
    <span class="md-ellipsis">
      9. Implement Two-Factor Authentication (2FA):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-protect-against-cross-site-request-forgery-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      10. Protect Against Cross-Site Request Forgery (CSRF):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-validate-and-sanitize-user-input" class="md-nav__link">
    <span class="md-ellipsis">
      11. Validate and Sanitize User Input:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-rate-limiting-and-brute-force-protection" class="md-nav__link">
    <span class="md-ellipsis">
      12. Rate Limiting and Brute-Force Protection:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      13. Security Testing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      14. Error Handling:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-security-headers-in-spring-security-filters" class="md-nav__link">
    <span class="md-ellipsis">
      15. Security Headers in Spring Security Filters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-regular-security-training" class="md-nav__link">
    <span class="md-ellipsis">
      16. Regular Security Training:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-compliance-with-regulations" class="md-nav__link">
    <span class="md-ellipsis">
      17. Compliance with Regulations:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secure-rest-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Secure REST APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Secure REST APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-to-securing-rest-apis-with-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Securing REST APIs with Spring Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-the-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the Basics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-guide-to-securing-rest-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Guide to Securing REST APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step-by-Step Guide to Securing REST APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-spring-security-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      1. Add Spring Security Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-websecurityconfigureradapter" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configure WebSecurityConfigurerAdapter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-implement-authentication-mechanism" class="md-nav__link">
    <span class="md-ellipsis">
      3. Implement Authentication Mechanism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-customize-userdetailsservice" class="md-nav__link">
    <span class="md-ellipsis">
      4. Customize UserDetailsService
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-secure-rest-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      5. Secure REST Endpoints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enhancing-security-with-advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Enhancing Security with Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enhancing Security with Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-implement-jwt-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      6. Implement JWT Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-secure-rest-apis-with-oauth2" class="md-nav__link">
    <span class="md-ellipsis">
      7. Secure REST APIs with OAuth2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-use-https-for-secure-communication" class="md-nav__link">
    <span class="md-ellipsis">
      8. Use HTTPS for Secure Communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-role-based-access-control-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      9. Role-Based Access Control (RBAC)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-monitor-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      10. Monitor and Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-thoughts" class="md-nav__link">
    <span class="md-ellipsis">
      Final Thoughts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-jwt-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing JWT Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing JWT Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-add-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Add Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-jwt-utility-class" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create JWT Utility Class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-implement-authentication-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Implement Authentication Filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-spring-security-to-use-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Configure Spring Security to Use JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-add-authentication-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Add Authentication Endpoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-jwt-authentication-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced JWT Authentication Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced JWT Authentication Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#refresh-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Refresh Tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Exception Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cors-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      CORS Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-token-storage-on-client-side" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Token Storage on Client Side
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-revocation-and-blacklisting" class="md-nav__link">
    <span class="md-ellipsis">
      Token Revocation and Blacklisting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-and-analytics" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring and Analytics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-enhancements-and-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Code Enhancements and Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Security Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring-security-filter-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Spring Security Filter Chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring Security Filter Chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#role-in-the-security-process" class="md-nav__link">
    <span class="md-ellipsis">
      Role in the Security Process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role in the Security Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-request-capture" class="md-nav__link">
    <span class="md-ellipsis">
      1. Request Capture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      2. Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      3. Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      4. Exception Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      5. Session Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-csrf-protection" class="md-nav__link">
    <span class="md-ellipsis">
      6. CSRF Protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-logout-processing" class="md-nav__link">
    <span class="md-ellipsis">
      7. Logout Processing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customization-and-extension" class="md-nav__link">
    <span class="md-ellipsis">
      Customization and Extension
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customizing-the-filter-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing the Filter Chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customizing the Filter Chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-httpsecurity" class="md-nav__link">
    <span class="md-ellipsis">
      Using HttpSecurity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-custom-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Custom Filters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-filters-in-the-spring-security-filter-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Key Filters in the Spring Security Filter Chain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extending-spring-security" class="md-nav__link">
    <span class="md-ellipsis">
      Extending Spring Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extending Spring Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-custom-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Custom Filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overriding-default-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      Overriding Default Behavior
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-context-persistence-across-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Security Context Persistence Across Requests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-custom-roles" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Custom Roles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Custom Roles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-define-custom-roles" class="md-nav__link">
    <span class="md-ellipsis">
      1. Define Custom Roles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-assign-roles-to-users" class="md-nav__link">
    <span class="md-ellipsis">
      2. Assign Roles to Users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-secure-endpoints-using-custom-roles" class="md-nav__link">
    <span class="md-ellipsis">
      3. Secure Endpoints Using Custom Roles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Secure Endpoints Using Custom Roles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-method-level-security-annotations" class="md-nav__link">
    <span class="md-ellipsis">
      Using Method-Level Security Annotations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-url-based-security" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring URL-Based Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-role-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      4. Role Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-role-based-access-control-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Role-Based Access Control and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-role-assignment-and-management" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Role Assignment and Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-grained-permissions-with-spring-security-acl" class="md-nav__link">
    <span class="md-ellipsis">
      Fine-Grained Permissions with Spring Security ACL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-security-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Method Security Expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-and-permission-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Role and Permission Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-security-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Security Configurations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Security Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
  

<nav class="md-tags" hidden>
  
    
    
    
      <a href="../../../tags/#spring-security" class="md-tag">Spring Security</a>
    
  
</nav>



<h1 id="spring-security">Spring Security<a class="headerlink" href="#spring-security" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="spring-security_1">Spring Security<a class="headerlink" href="#spring-security_1" title="Permanent link">&para;</a></h2>
<hr />
<p>Spring Security is a powerful framework that provides authentication, authorization, and protection against common
security vulnerabilities for Spring-based applications. It plays a crucial role in safeguarding your application and its
data from unauthorized access and attacks. In this article, we'll explore the fundamentals of Spring Security, why it's
important, and how to use it effectively with easy-to-understand examples and code snippets.</p>
<p>Spring Security is a vital component in the world of Spring-based applications, ensuring the safety and security of your
software. It provides comprehensive solutions for authentication, authorization, and protection against common security
threats. In this article, we'll delve into what Spring Security is, why it's essential, and how you can use it
effectively.</p>
<h3 id="understanding-spring-security">Understanding Spring Security:<a class="headerlink" href="#understanding-spring-security" title="Permanent link">&para;</a></h3>
<p>Spring Security is an integral part of the Spring ecosystem, specifically designed to address security concerns. It
offers a range of features that allow developers to build secure applications with ease. Let's break down its key
components:</p>
<ol>
<li>
<p><strong>Authentication:</strong> Authentication is the process of verifying a user's identity. Spring Security provides various
   authentication mechanisms, such as username/password, token-based authentication, and integration with external
   authentication providers like LDAP or OAuth.</p>
</li>
<li>
<p><strong>Authorization:</strong> Authorization determines what actions a user is allowed to perform within an application. Spring
   Security offers role-based and attribute-based access control, allowing you to define fine-grained permissions.</p>
</li>
<li>
<p><strong>Protection against Common Threats:</strong> Spring Security helps protect your application against common security threats
   like cross-site scripting (XSS), cross-site request forgery (CSRF), and SQL injection by providing built-in defenses.</p>
</li>
</ol>
<h3 id="why-spring-security-matters">Why Spring Security Matters:<a class="headerlink" href="#why-spring-security-matters" title="Permanent link">&para;</a></h3>
<h4 id="1-protecting-user-data">1. Protecting User Data:<a class="headerlink" href="#1-protecting-user-data" title="Permanent link">&para;</a></h4>
<p>Imagine you're building an e-commerce platform where users store personal and financial information. Spring Security
ensures that only authorized users can access and modify this data. Without it, sensitive information could be at risk.</p>
<h4 id="2-preventing-unauthorized-access">2. Preventing Unauthorized Access:<a class="headerlink" href="#2-preventing-unauthorized-access" title="Permanent link">&para;</a></h4>
<p>In a collaborative project management tool, you wouldn't want one user to access another user's projects or data. Spring
Security's authorization mechanisms allow you to specify who can do what within your application.</p>
<h4 id="3-safeguarding-against-attacks">3. Safeguarding Against Attacks:<a class="headerlink" href="#3-safeguarding-against-attacks" title="Permanent link">&para;</a></h4>
<p>Malicious users may attempt to exploit vulnerabilities in your application. Spring Security's built-in protection
mechanisms help defend against common security threats, providing an additional layer of defense.</p>
<h3 id="using-spring-security">Using Spring Security:<a class="headerlink" href="#using-spring-security" title="Permanent link">&para;</a></h3>
<p>Let's get hands-on with a simple example. Suppose you're developing a web application using Spring Boot, and you want to
protect certain endpoints. Here's how you can do it:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">            </span><span class="p">.</span><span class="na">formLogin</span><span class="p">()</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">                </span><span class="p">.</span><span class="na">loginPage</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">            </span><span class="p">.</span><span class="na">logout</span><span class="p">()</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">();</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we're permitting access to public resources while requiring authentication for other endpoints. We've
also defined a custom login page and enabled logout functionality.</p>
<p>Spring Security is an indispensable tool for any Spring-based application. It ensures that your software is protected
against unauthorized access and common security threats, making it an essential part of your development toolkit. By
following best practices and leveraging Spring Security's features, you can build robust and secure applications that
users can trust.</p>
<h2 id="advanced-features-and-customization">Advanced Features and Customization<a class="headerlink" href="#advanced-features-and-customization" title="Permanent link">&para;</a></h2>
<p>Having covered the basics of Spring Security, it's time to explore some advanced features and customization options that
make Spring Security a versatile choice for securing your Spring-based application.</p>
<h3 id="1-custom-authentication-providers">1. Custom Authentication Providers:<a class="headerlink" href="#1-custom-authentication-providers" title="Permanent link">&para;</a></h3>
<p>While Spring Security provides a range of built-in authentication methods, you might have unique requirements. You can
create custom authentication providers to integrate with external systems or implement unconventional authentication
methods. Here's an example of a custom authentication provider using a username and a custom token:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nd">@Component</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getCredentials</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">        </span><span class="c1">// Perform custom authentication logic here</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">Collections</span><span class="p">.</span><span class="na">emptyList</span><span class="p">());</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="2-method-level-security">2. Method-Level Security:<a class="headerlink" href="#2-method-level-security" title="Permanent link">&para;</a></h3>
<p>Spring Security allows you to secure individual methods within your application. This is particularly useful when you
need fine-grained control over who can access specific functionality. Here's an example using method-level security
annotations:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nd">@Service</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteUser</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">        </span><span class="c1">// Delete user logic here</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, the <code>deleteUser</code> method can only be executed by users with the "ADMIN" role.</p>
<h3 id="3-custom-access-denied-handling">3. Custom Access Denied Handling:<a class="headerlink" href="#3-custom-access-denied-handling" title="Permanent link">&para;</a></h3>
<p>When an unauthorized user tries to access a protected resource, you can customize how Spring Security handles the access
denied situation. You can create a custom access denied handler like this:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nd">@Component</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAccessDeniedHandler</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AccessDeniedHandler</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">AccessDeniedException</span><span class="w"> </span><span class="n">accessDeniedException</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ServletException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">        </span><span class="c1">// Custom access denied logic, e.g., redirect to a specific error page</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">        </span><span class="n">response</span><span class="p">.</span><span class="na">sendRedirect</span><span class="p">(</span><span class="s">&quot;/access-denied&quot;</span><span class="p">);</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="4-security-headers">4. Security Headers:<a class="headerlink" href="#4-security-headers" title="Permanent link">&para;</a></h3>
<p>To enhance security, Spring Security provides features to control security headers in HTTP responses. You can configure
headers like Content Security Policy (CSP), X-Content-Type-Options, and X-Frame-Options to protect against common web
vulnerabilities.</p>
<p>Spring Security is not only about basic authentication and authorization; it offers advanced features and customization
options to cater to diverse security requirements. By leveraging these capabilities, you can build highly secure
applications that meet the specific needs of your project while adhering to best security practices. Whether you're
working on a simple web application or a complex enterprise system, Spring Security has you covered.</p>
<h3 id="integrating-spring-security-with-oauth-20">Integrating Spring Security with OAuth 2.0<a class="headerlink" href="#integrating-spring-security-with-oauth-20" title="Permanent link">&para;</a></h3>
<p>let's now delve into integrating OAuth 2.0 with your Spring-based application. OAuth 2.0 is a popular protocol for
secure authorization, widely used for third-party authentication and API access control. This article explains the
significance of OAuth 2.0, its implementation with Spring Security, and how it benefits your application.</p>
<p>As we continue our journey into the realm of Spring Security, it's essential to understand how to integrate OAuth 2.0, a
critical protocol for secure authorization, into your Spring-based application. OAuth 2.0 plays a pivotal role in
granting third-party applications limited access to your resources while keeping user data secure. Let's explore why
OAuth 2.0 matters and how to implement it with Spring Security.</p>
<h3 id="understanding-oauth-20">Understanding OAuth 2.0:<a class="headerlink" href="#understanding-oauth-20" title="Permanent link">&para;</a></h3>
<p>OAuth 2.0 is a widely adopted open standard for access delegation. It allows users to grant third-party applications
limited access to their resources without exposing their credentials. OAuth 2.0 is prevalent in scenarios such as social
media logins, granting access to APIs, and single sign-on (SSO) solutions.</p>
<h3 id="why-oauth-20-matters">Why OAuth 2.0 Matters:<a class="headerlink" href="#why-oauth-20-matters" title="Permanent link">&para;</a></h3>
<h4 id="1-enhanced-security">1. Enhanced Security:<a class="headerlink" href="#1-enhanced-security" title="Permanent link">&para;</a></h4>
<p>OAuth 2.0 provides a secure way to delegate access to resources. Instead of sharing passwords, users can grant limited
and time-bound access tokens, reducing the risk of unauthorized access.</p>
<h4 id="2-third-party-integration">2. Third-Party Integration:<a class="headerlink" href="#2-third-party-integration" title="Permanent link">&para;</a></h4>
<p>OAuth 2.0 enables seamless integration with third-party applications and services, expanding the functionality and reach
of your application.</p>
<h4 id="3-single-sign-on-sso">3. Single Sign-On (SSO):<a class="headerlink" href="#3-single-sign-on-sso" title="Permanent link">&para;</a></h4>
<p>OAuth 2.0 can be used to implement single sign-on solutions, allowing users to access multiple applications with a
single set of credentials.</p>
<h3 id="implementing-oauth-20-with-spring-security">Implementing OAuth 2.0 with Spring Security:<a class="headerlink" href="#implementing-oauth-20-with-spring-security" title="Permanent link">&para;</a></h3>
<p>Let's walk through a simple example of how to integrate OAuth 2.0 with Spring Security using the OAuth 2.0 Authorization
Code Grant flow. Suppose you want to allow users to log in with their Google accounts:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/login**&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/error**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">            </span><span class="p">.</span><span class="na">oauth2Login</span><span class="p">()</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">                </span><span class="p">.</span><span class="na">loginPage</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">                </span><span class="p">.</span><span class="na">defaultSuccessURL</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">)</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">            </span><span class="p">.</span><span class="na">logout</span><span class="p">()</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">                </span><span class="p">.</span><span class="na">logoutSuccessUrl</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">            </span><span class="p">.</span><span class="na">exceptionHandling</span><span class="p">()</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">                </span><span class="p">.</span><span class="na">accessDeniedPage</span><span class="p">(</span><span class="s">&quot;/access-denied&quot;</span><span class="p">);</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we configure Spring Security to use Google as an OAuth 2.0 provider for authentication. Users can log
in with their Google accounts, and upon successful authentication, they are redirected to the "/user" page.</p>
<p>Integrating OAuth 2.0 with Spring Security opens up exciting possibilities for secure third-party authentication and
resource access control in your Spring-based application. Whether you're building a platform that connects with social
media accounts or providing APIs for external developers, OAuth 2.0 ensures robust security while delivering a seamless
user experience. By mastering OAuth 2.0 integration with Spring Security, you can unlock the full potential of secure
authorization in your applications.</p>
<hr />
<h2 id="core-components-of-spring-security">Core Components of Spring Security<a class="headerlink" href="#core-components-of-spring-security" title="Permanent link">&para;</a></h2>
<p>Spring Security comprises several core components that work together to provide robust security for your applications.
In this article, we'll explore these fundamental building blocks, their roles, and how they contribute to the overall
security of your Spring-based applications. You'll gain a clear understanding of Spring Security's core components and
their importance.</p>
<p>Spring Security, as a comprehensive security framework for Spring-based applications, relies on a set of core
components. These components work in harmony to provide a secure environment, ensuring that only authorized users can
access your application's resources. Let's delve into each of these core components to understand their roles and
significance.</p>
<h3 id="1-authentication">1. Authentication:<a class="headerlink" href="#1-authentication" title="Permanent link">&para;</a></h3>
<p>Authentication is the process of verifying a user's identity. Spring Security offers various authentication mechanisms,
including:</p>
<ul>
<li><strong>Username and Password:</strong> The traditional method where users provide their credentials.</li>
<li><strong>Token-Based:</strong> Authentication via tokens (e.g., JWT) where the user's identity is stored in a token.</li>
<li><strong>OAuth 2.0:</strong> Integrating with third-party identity providers like Google or Facebook.</li>
</ul>
<p>Example Code (Username and Password Authentication):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="n">auth</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">            </span><span class="p">.</span><span class="na">inMemoryAuthentication</span><span class="p">()</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">                </span><span class="p">.</span><span class="na">withUser</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">                </span><span class="p">.</span><span class="na">password</span><span class="p">(</span><span class="s">&quot;{noop}password&quot;</span><span class="p">)</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">                </span><span class="p">.</span><span class="na">roles</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">);</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="2-authorization">2. Authorization:<a class="headerlink" href="#2-authorization" title="Permanent link">&para;</a></h3>
<p>Authorization determines what actions a user is allowed to perform within the application. Spring Security supports
role-based and attribute-based access control:</p>
<ul>
<li><strong>Role-Based:</strong> Users are assigned roles (e.g., "ADMIN" or "USER"), and certain actions are restricted to specific
  roles.</li>
<li><strong>Attribute-Based:</strong> Access control based on specific attributes of the user, such as their username or custom
  properties.</li>
</ul>
<p>Example Code (Role-Based Authorization):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nd">@EnableGlobalMethodSecurity</span><span class="p">(</span><span class="n">prePostEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MethodSecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GlobalMethodSecurityConfiguration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">MethodSecurityExpressionHandler</span><span class="w"> </span><span class="nf">createExpressionHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultMethodSecurityExpressionHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">                </span><span class="n">setPermissionEvaluator</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CustomPermissionEvaluator</span><span class="p">());</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="3-filters">3. Filters:<a class="headerlink" href="#3-filters" title="Permanent link">&para;</a></h3>
<p>Spring Security uses filters to process and manipulate HTTP requests and responses. Filters play a vital role in various
security aspects, such as authentication, authorization, and protection against common web vulnerabilities (e.g., CSRF
or XSS).</p>
<p>Example Code (Custom Filter):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomFilter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GenericFilterBean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doFilter</span><span class="p">(</span><span class="n">ServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">ServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">FilterChain</span><span class="w"> </span><span class="n">chain</span><span class="p">)</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ServletException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="c1">// Custom filter logic here</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">        </span><span class="n">chain</span><span class="p">.</span><span class="na">doFilter</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="4-security-context">4. Security Context:<a class="headerlink" href="#4-security-context" title="Permanent link">&para;</a></h3>
<p>The security context holds the current user's security information. It allows you to access the authenticated user's
details and make authorization decisions throughout the application.</p>
<p>Example Code (Accessing Security Context):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecurityContextHolder</span><span class="p">.</span><span class="na">getContext</span><span class="p">().</span><span class="na">getAuthentication</span><span class="p">();</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">String</span><span class="w"> </span><span class="n">currentUsername</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="5-provider-and-manager">5. Provider and Manager:<a class="headerlink" href="#5-provider-and-manager" title="Permanent link">&para;</a></h3>
<p>Authentication providers validate user credentials, while authentication managers coordinate the authentication process
by working with multiple providers if necessary.</p>
<p>Example Code (Custom Authentication Provider):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nd">@Component</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">        </span><span class="c1">// Custom authentication logic here</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>These core components form the foundation of Spring Security, ensuring the security of your Spring-based applications.
By understanding how they work together, you can build robust and secure systems that protect your resources and data
while providing a seamless user experience.</p>
<h3 id="6-configuration">6. Configuration:<a class="headerlink" href="#6-configuration" title="Permanent link">&para;</a></h3>
<p>Spring Security's configuration is a critical aspect of its setup. You can customize security settings and policies by
creating configuration classes or XML configurations. These configurations define which components are used and how they
interact within your application.</p>
<p>Example Code (Security Configuration):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">            </span><span class="p">.</span><span class="na">formLogin</span><span class="p">()</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">                </span><span class="p">.</span><span class="na">loginPage</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">            </span><span class="p">.</span><span class="na">logout</span><span class="p">()</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">();</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="7-sessions-and-tokens">7. Sessions and Tokens:<a class="headerlink" href="#7-sessions-and-tokens" title="Permanent link">&para;</a></h3>
<p>Spring Security manages user sessions and authentication tokens. Sessions keep track of user state, and tokens are used
to maintain user identity across requests. You can configure how sessions and tokens are handled, including using
stateless token-based authentication.</p>
<p>Example Code (Token-Based Authentication with JWT):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">            </span><span class="p">.</span><span class="na">sessionManagement</span><span class="p">()</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">                </span><span class="p">.</span><span class="na">sessionCreationPolicy</span><span class="p">(</span><span class="n">SessionCreationPolicy</span><span class="p">.</span><span class="na">STATELESS</span><span class="p">)</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">            </span><span class="p">.</span><span class="na">addFilterBefore</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JwtAuthenticationFilter</span><span class="p">(),</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationFilter</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="8-exception-handling">8. Exception Handling:<a class="headerlink" href="#8-exception-handling" title="Permanent link">&para;</a></h3>
<p>Spring Security provides ways to handle exceptions that may occur during authentication or authorization processes. You
can define custom exception handlers to control how errors are presented to users.</p>
<p>Example Code (Custom Access Denied Handler):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nd">@Component</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAccessDeniedHandler</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AccessDeniedHandler</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">AccessDeniedException</span><span class="w"> </span><span class="n">accessDeniedException</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ServletException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">        </span><span class="c1">// Custom access denied logic, e.g., redirect to an error page</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">        </span><span class="n">response</span><span class="p">.</span><span class="na">sendRedirect</span><span class="p">(</span><span class="s">&quot;/access-denied&quot;</span><span class="p">);</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>Understanding these core components of Spring Security is essential for building secure Spring-based applications. By
grasping their roles and how they interact, you gain the ability to configure, customize, and extend security features
to meet your specific requirements. Whether you're working on a simple web application or a complex enterprise system,
these building blocks empower you to create a robust and secure environment for your users and data.</p>
<h3 id="9-security-events-and-auditing">9. Security Events and Auditing:<a class="headerlink" href="#9-security-events-and-auditing" title="Permanent link">&para;</a></h3>
<p>Spring Security allows you to monitor and log security-related events within your application. By leveraging security
events and auditing mechanisms, you can gain insights into user interactions, failed login attempts, and other
security-related activities.</p>
<p>Example Code (Custom Security Event Listener):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nd">@Component</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomSecurityEventListener</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ApplicationListener</span><span class="o">&lt;</span><span class="n">AbstractAuthenticationEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onApplicationEvent</span><span class="p">(</span><span class="n">AbstractAuthenticationEvent</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">        </span><span class="c1">// Custom security event handling logic here</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="10-csrf-protection">10. CSRF Protection:<a class="headerlink" href="#10-csrf-protection" title="Permanent link">&para;</a></h3>
<p>Cross-Site Request Forgery (CSRF) is a common web vulnerability. Spring Security provides built-in CSRF protection by
generating and validating CSRF tokens. This prevents malicious websites from making unauthorized requests on behalf of
authenticated users.</p>
<p>Example Code (CSRF Protection):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">            </span><span class="p">.</span><span class="na">csrf</span><span class="p">()</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">                </span><span class="p">.</span><span class="na">csrfTokenRepository</span><span class="p">(</span><span class="n">CookieCsrfTokenRepository</span><span class="p">.</span><span class="na">withHttpOnlyFalse</span><span class="p">());</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="11-password-encoding">11. Password Encoding:<a class="headerlink" href="#11-password-encoding" title="Permanent link">&para;</a></h3>
<p>Storing passwords securely is crucial for user authentication. Spring Security encourages the use of password encoding
techniques, such as BCrypt, to store passwords securely in your database.</p>
<p>Example Code (Password Encoding):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nd">@Bean</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="12-remember-me-authentication">12. Remember-Me Authentication:<a class="headerlink" href="#12-remember-me-authentication" title="Permanent link">&para;</a></h3>
<p>Spring Security provides a "remember-me" authentication feature, allowing users to stay logged in across sessions even
after browser restarts. This feature enhances user convenience while maintaining security.</p>
<p>Example Code (Remember-Me Authentication):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">            </span><span class="p">.</span><span class="na">rememberMe</span><span class="p">()</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">                </span><span class="p">.</span><span class="na">key</span><span class="p">(</span><span class="s">&quot;mySecretKey&quot;</span><span class="p">)</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">                </span><span class="p">.</span><span class="na">tokenValiditySeconds</span><span class="p">(</span><span class="mi">604800</span><span class="p">);</span><span class="w"> </span><span class="c1">// 7 days</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="p">}</span>
</span></code></pre></div>
<p>These additional components and features complement the core elements of Spring Security, enabling you to tailor your
security implementation to specific requirements. By combining these building blocks effectively, you can create a
highly secure environment for your Spring-based applications, ensuring the protection of sensitive data and the
integrity of user interactions.</p>
<hr />
<h2 id="authentication-and-authorization">Authentication and Authorization<a class="headerlink" href="#authentication-and-authorization" title="Permanent link">&para;</a></h2>
<p>Authentication and authorization are two fundamental concepts in securing applications. Authentication verifies the
identity of a user, while authorization determines what actions they can perform. In this article, we'll explore these
concepts in detail and see how Spring Security, a powerful framework for Java applications, handles them with practical
examples.</p>
<p>Authentication and authorization are key pillars of application security. Authentication verifies the identity of a
user, while authorization determines what that user is allowed to do within the application. Spring Security, a robust
framework for securing Java applications, provides a comprehensive solution for handling both authentication and
authorization. In this article, we'll delve into these concepts and understand how Spring Security manages them
effectively.</p>
<h3 id="authentication">Authentication:<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h3>
<p><strong>Authentication</strong> is the process of verifying the identity of a user, ensuring that they are who they claim to be. It
answers the question, "Who are you?" Spring Security supports various authentication methods, including:</p>
<ol>
<li>
<p><strong>Username and Password:</strong> The most common method where users provide their credentials (username and password) for
   verification.</p>
</li>
<li>
<p><strong>Token-Based:</strong> Authentication using tokens like JSON Web Tokens (JWT), which store user identity information and
   are often used for stateless authentication.</p>
</li>
<li>
<p><strong>OAuth 2.0:</strong> Integration with third-party identity providers like Google or Facebook for user authentication.</p>
</li>
</ol>
<h3 id="spring-security-authentication-example">Spring Security Authentication Example:<a class="headerlink" href="#spring-security-authentication-example" title="Permanent link">&para;</a></h3>
<p>Let's consider a basic example of username and password authentication in a Spring Security configuration:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">        </span><span class="n">auth</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">            </span><span class="p">.</span><span class="na">inMemoryAuthentication</span><span class="p">()</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">                </span><span class="p">.</span><span class="na">withUser</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">                </span><span class="p">.</span><span class="na">password</span><span class="p">(</span><span class="s">&quot;{noop}password&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Passwords should be securely hashed in production</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">                </span><span class="p">.</span><span class="na">roles</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">);</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we configure Spring Security to use in-memory authentication with a single user "user" and password "
password" (note that passwords should be securely hashed in a real application). This user has the "USER" role.</p>
<h3 id="authorization">Authorization:<a class="headerlink" href="#authorization" title="Permanent link">&para;</a></h3>
<p><strong>Authorization</strong> deals with determining what actions or resources a user is allowed to access or manipulate within an
application. It answers the question, "What are you allowed to do?" Spring Security offers two primary approaches to
authorization:</p>
<ol>
<li>
<p><strong>Role-Based Authorization:</strong> Users are assigned roles (e.g., "ADMIN" or "USER"), and specific actions or resources
   are restricted to users with particular roles.</p>
</li>
<li>
<p><strong>Attribute-Based Authorization:</strong> Access control based on specific attributes of the user, such as their username,
   custom properties, or data associated with them.</p>
</li>
</ol>
<h3 id="spring-security-authorization-example">Spring Security Authorization Example:<a class="headerlink" href="#spring-security-authorization-example" title="Permanent link">&para;</a></h3>
<p>Here's an example of role-based authorization using Spring Security annotations:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nd">@EnableGlobalMethodSecurity</span><span class="p">(</span><span class="n">prePostEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MethodSecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GlobalMethodSecurityConfiguration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">MethodSecurityExpressionHandler</span><span class="w"> </span><span class="nf">createExpressionHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultMethodSecurityExpressionHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">                </span><span class="n">setPermissionEvaluator</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CustomPermissionEvaluator</span><span class="p">());</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we enable method-level security and define a custom permission evaluator. You can then use annotations
like <code>@PreAuthorize</code> and <code>@PostAuthorize</code> to specify authorization rules on your methods.</p>
<h3 id="spring-securitys-role">Spring Security's Role:<a class="headerlink" href="#spring-securitys-role" title="Permanent link">&para;</a></h3>
<p>Spring Security seamlessly integrates authentication and authorization, allowing you to build secure applications with
ease. By configuring authentication providers, defining roles, and specifying access control rules, you can ensure that
your application only grants access to authorized users while protecting sensitive data and functionality.</p>
<p>Understanding these fundamental concepts and Spring Security's role in managing them is essential for creating robust
and secure applications that protect user information and maintain the integrity of your system.</p>
<h3 id="authentication-flow-in-spring-security">Authentication Flow in Spring Security:<a class="headerlink" href="#authentication-flow-in-spring-security" title="Permanent link">&para;</a></h3>
<p>To understand how Spring Security handles authentication, let's walk through the authentication flow:</p>
<ol>
<li>
<p><strong>User Authentication Request:</strong> When a user tries to access a secured resource, Spring Security intercepts the
   request. If the user is not authenticated (i.e., they haven't provided valid credentials), they are redirected to a
   login page or prompted to provide credentials via a login form.</p>
</li>
<li>
<p><strong>Authentication Provider:</strong> Spring Security uses authentication providers to validate the provided credentials.
   These providers can be configured for various authentication methods, such as in-memory authentication,
   database-based authentication, or integration with external identity providers.</p>
</li>
<li>
<p><strong>Authentication Manager:</strong> The authentication manager coordinates the authentication process, working with one or
   more authentication providers if necessary. It delegates the credential verification to the appropriate provider
   based on the authentication method used.</p>
</li>
<li>
<p><strong>Successful Authentication:</strong> If the user provides valid credentials, Spring Security establishes their identity and
   creates an <code>Authentication</code> object. This object contains details about the authenticated user, such as their username
   and authorities (roles).</p>
</li>
<li>
<p><strong>Security Context:</strong> Spring Security stores the <code>Authentication</code> object in the security context. This context is
   accessible throughout the application, allowing you to make authorization decisions and retrieve user details when
   needed.</p>
</li>
<li>
<p><strong>Access Granted:</strong> With a valid <code>Authentication</code> object in the security context, Spring Security grants access to
   the requested resource or action based on the user's authorities or roles.</p>
</li>
</ol>
<h3 id="authorization-flow">Authorization Flow:<a class="headerlink" href="#authorization-flow" title="Permanent link">&para;</a></h3>
<p>Now, let's explore how Spring Security handles authorization:</p>
<ol>
<li>
<p><strong>Authorization Check:</strong> Once a user is authenticated, Spring Security performs authorization checks to determine
   whether the user is allowed to access specific resources or perform certain actions.</p>
</li>
<li>
<p><strong>Access Control Rules:</strong> Spring Security allows you to define access control rules based on roles or attributes.
   These rules specify which users or roles have permission to perform specific actions.</p>
</li>
<li>
<p><strong>Pre- and Post-Processing:</strong> Spring Security provides annotations like <code>@PreAuthorize</code> and <code>@PostAuthorize</code> that you
   can use to apply authorization checks at the method level in your code. These annotations enable fine-grained control
   over access to methods.</p>
</li>
<li>
<p><strong>Permission Evaluator:</strong> If you require custom authorization logic beyond simple role-based checks, you can
   implement a custom permission evaluator to evaluate access control decisions based on specific attributes or
   conditions.</p>
</li>
<li>
<p><strong>Access Denied Handling:</strong> If a user tries to access a resource or perform an action for which they are not
   authorized, Spring Security can handle this situation according to your configuration. For example, you can redirect
   the user to an access denied page or return an error message.</p>
</li>
</ol>
<p>By understanding this authentication and authorization flow in Spring Security, you can design your application's
security architecture effectively, ensuring that users are authenticated securely and have appropriate access to
resources and actions. This knowledge empowers you to create secure and well-structured applications that protect
sensitive data and functionality.</p>
<h3 id="additional-spring-security-features">Additional Spring Security Features:<a class="headerlink" href="#additional-spring-security-features" title="Permanent link">&para;</a></h3>
<p>While authentication and authorization are the core functions of Spring Security, the framework offers additional
features to enhance the security of your applications:</p>
<ol>
<li>
<p><strong>Session Management:</strong> Spring Security provides options for managing user sessions, including controlling the number
   of allowed sessions per user and handling session fixation attacks.</p>
</li>
<li>
<p><strong>Remember-Me Authentication:</strong> This feature allows users to remain authenticated even after they close and reopen
   their browsers. It's useful for applications that require persistent user sessions.</p>
</li>
<li>
<p><strong>CSRF Protection:</strong> Cross-Site Request Forgery (CSRF) protection is built into Spring Security. It helps prevent
   malicious websites from making unauthorized requests on behalf of authenticated users.</p>
</li>
<li>
<p><strong>Password Encoding:</strong> Spring Security encourages the use of password encoding techniques like BCrypt to securely
   store user passwords in databases.</p>
</li>
<li>
<p><strong>Security Headers:</strong> You can configure Spring Security to include security headers in HTTP responses, such as
   Content Security Policy (CSP), X-Content-Type-Options, and X-Frame-Options, to mitigate common web vulnerabilities.</p>
</li>
<li>
<p><strong>Security Events and Auditing:</strong> Spring Security allows you to monitor and log security-related events within your
   application. This auditing helps you track user interactions and security incidents.</p>
</li>
<li>
<p><strong>Custom Filters:</strong> You can add custom filters to the Spring Security filter chain to implement additional security
   logic tailored to your application's requirements.</p>
</li>
<li>
<p><strong>Integration with External Identity Providers:</strong> Spring Security supports integration with external identity
   providers using protocols like OAuth 2.0 and OpenID Connect. This is valuable when implementing single sign-on (SSO)
   or allowing users to log in with their social media accounts.</p>
</li>
<li>
<p><strong>Password Policies:</strong> Spring Security allows you to define password policies, such as password expiration,
   complexity requirements, and account lockout policies, to enhance security.</p>
</li>
</ol>
<p>By utilizing these additional features, you can further strengthen the security posture of your Spring-based
applications and protect them against a wide range of threats and vulnerabilities.</p>
<p>In summary, authentication and authorization are the foundation of Spring Security, providing a robust framework for
securing Java applications. Understanding how Spring Security handles these aspects, along with its supplementary
features, empowers you to create secure, resilient, and user-friendly applications that meet the diverse security needs
of your users and organizations.</p>
<hr />
<h2 id="authentication-and-authorization_1">Authentication and Authorization<a class="headerlink" href="#authentication-and-authorization_1" title="Permanent link">&para;</a></h2>
<p>Authentication and authorization are two distinct concepts in application security. Authentication verifies a user's
identity, while authorization determines what actions or resources a user is allowed to access. In this article, we'll
clarify these differences with clear examples and illustrate how they work together to safeguard your applications.</p>
<p>Authentication and authorization are core principles of application security, and understanding their differences is
crucial. Authentication verifies who the user is, while authorization defines what the user can do. Let's explore these
concepts in detail and see how they complement each other to secure your applications effectively.</p>
<h3 id="authentication_1">Authentication:<a class="headerlink" href="#authentication_1" title="Permanent link">&para;</a></h3>
<p><strong>Authentication</strong> is the process of verifying a user's identity. It answers the question, "Who are you?" Authentication
ensures that the user is indeed the person they claim to be. Common authentication methods include:</p>
<ul>
<li><strong>Username and Password:</strong> Users provide a username and a password to prove their identity.</li>
<li><strong>Token-Based:</strong> Authentication using tokens like JSON Web Tokens (JWT), which contain user identity information.</li>
<li><strong>OAuth 2.0:</strong> Integration with third-party identity providers like Google or Facebook for user authentication.</li>
</ul>
<p><strong>Example:</strong> Think of authentication as the process of showing your ID card at the entrance of a building. The security
personnel verify your ID to ensure you are who you claim to be before granting access.</p>
<h3 id="authorization_1">Authorization:<a class="headerlink" href="#authorization_1" title="Permanent link">&para;</a></h3>
<p><strong>Authorization</strong>, on the other hand, deals with determining what actions or resources a user is allowed to access or
manipulate within an application. It answers the question, "What are you allowed to do?" Authorization defines
permissions based on roles, attributes, or other criteria. Common authorization methods include:</p>
<ul>
<li><strong>Role-Based Authorization:</strong> Users are assigned roles (e.g., "ADMIN" or "USER"), and specific actions or resources
  are restricted to users with particular roles.</li>
<li><strong>Attribute-Based Authorization:</strong> Access control based on specific attributes of the user, such as their username,
  custom properties, or data associated with them.</li>
</ul>
<p><strong>Example:</strong> Authorization is akin to the permissions granted to different employees within an organization. Managers
have access to sensitive data, while regular employees may have limited access.</p>
<h3 id="authentication-vs-authorization">Authentication vs. Authorization:<a class="headerlink" href="#authentication-vs-authorization" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Purpose</strong>:</p>
<ul>
<li>Authentication verifies identity.</li>
<li>Authorization determines access rights.</li>
</ul>
</li>
<li>
<p><strong>Question</strong>:</p>
<ul>
<li>Authentication asks, "Who are you?"</li>
<li>Authorization asks, "What are you allowed to do?"</li>
</ul>
</li>
<li>
<p><strong>Outcome</strong>:</p>
<ul>
<li>Authentication results in the establishment of a user's identity.</li>
<li>Authorization results in granting or denying access to specific actions or resources.</li>
</ul>
</li>
<li>
<p><strong>Examples</strong>:</p>
<ul>
<li>Authentication: Verifying a user's username and password.</li>
<li>Authorization: Allowing an admin to delete user accounts.</li>
</ul>
</li>
<li>
<p><strong>Relationship</strong>:</p>
<ul>
<li>Authentication precedes authorization. You must first authenticate a user before determining what they can access.</li>
</ul>
</li>
</ol>
<h3 id="how-they-work-together">How They Work Together:<a class="headerlink" href="#how-they-work-together" title="Permanent link">&para;</a></h3>
<p>Authentication and authorization work in tandem to secure applications. After a user is authenticated (proving their
identity), the system checks their authorization (permissions) to determine what actions or resources they can access.</p>
<p><strong>Example:</strong> When logging into an email account, authentication involves entering your username and password. Once
authenticated, the system checks if you have the authorization to read, send, or delete emails based on your role and
settings.</p>
<p>In conclusion, understanding the distinctions between authentication and authorization is vital for building secure
applications. Authentication verifies identity, while authorization controls access. Together, they form the foundation
of application security, ensuring that users are who they claim to be and that they can only perform actions they are
allowed to do.</p>
<hr />
<h2 id="understanding-principal-and-authentication">Understanding Principal and Authentication<a class="headerlink" href="#understanding-principal-and-authentication" title="Permanent link">&para;</a></h2>
<p>In Spring Security, a <strong>Principal</strong> represents the currently authenticated user, while <strong>Authentication</strong> encapsulates
the user's credentials and authorities. This article dives into these concepts, explaining how Spring Security uses them
to secure your applications, with practical examples for clarity.</p>
<p>In Spring Security, the concepts of <strong>Principal</strong> and <strong>Authentication</strong> play pivotal roles in ensuring the security of
your applications. A <strong>Principal</strong> represents the currently authenticated user, while <strong>Authentication</strong> encapsulates
the user's credentials and authorities. Let's explore these concepts in detail and understand how Spring Security
employs them to safeguard your applications.</p>
<h3 id="principal">Principal:<a class="headerlink" href="#principal" title="Permanent link">&para;</a></h3>
<p>A <strong>Principal</strong> in Spring Security represents the currently authenticated user or entity. It encapsulates information
about the user, such as their username or user object. Essentially, the Principal object provides a way to identify who
is interacting with the application.</p>
<ul>
<li><strong>Principal Object:</strong> A Principal can be represented as a Java object containing user information. It helps answer the
  question, "Who is the user?"</li>
</ul>
<h3 id="authentication_2">Authentication:<a class="headerlink" href="#authentication_2" title="Permanent link">&para;</a></h3>
<p><strong>Authentication</strong> in Spring Security represents the process of verifying a user's identity. It contains the user's
credentials (e.g., username and password) and information about the user's authorities or roles. Authentication verifies
that the user is indeed who they claim to be.</p>
<ul>
<li><strong>Credentials:</strong> These are the user's proof of identity, such as a username and password.</li>
<li><strong>Authorities:</strong> Authorities define what actions or resources the user is allowed to access within the application.</li>
</ul>
<h3 id="spring-security-and-principal">Spring Security and Principal:<a class="headerlink" href="#spring-security-and-principal" title="Permanent link">&para;</a></h3>
<p>In Spring Security, once a user is authenticated, the authenticated user's information is stored in a <strong>Principal</strong>
object. The Principal represents the authenticated user, allowing the application to make authorization decisions and
access user-specific data.</p>
<h3 id="spring-security-and-authentication">Spring Security and Authentication:<a class="headerlink" href="#spring-security-and-authentication" title="Permanent link">&para;</a></h3>
<p>Spring Security manages the entire authentication process, from verifying user credentials to creating an *
<em>Authentication*</em> object. This object contains the user's details and authorities, encapsulating everything needed to
determine what the user can access within the application.</p>
<h3 id="practical-example">Practical Example:<a class="headerlink" href="#practical-example" title="Permanent link">&para;</a></h3>
<p>Consider a Spring Security configuration that enables username and password authentication:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">        </span><span class="n">auth</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">            </span><span class="p">.</span><span class="na">inMemoryAuthentication</span><span class="p">()</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">                </span><span class="p">.</span><span class="na">withUser</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">                </span><span class="p">.</span><span class="na">password</span><span class="p">(</span><span class="s">&quot;{noop}password&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Passwords should be securely hashed in production</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">                </span><span class="p">.</span><span class="na">roles</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">);</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, when a user provides valid credentials (username "user" and password "password"), Spring Security
creates an <strong>Authentication</strong> object containing information about the user's identity and role (in this case, the role "
USER"). The authenticated user becomes the <strong>Principal</strong>, allowing them to access resources permitted for a "USER" role.</p>
<p>In Spring Security, a <strong>Principal</strong> represents the authenticated user, while <strong>Authentication</strong> encapsulates their
credentials and authorities. These concepts are fundamental to securing your applications, enabling you to identify
users and control their access to resources and actions. Understanding how Spring Security handles these concepts
empowers you to build robust and secure systems that protect sensitive data and functionality.</p>
<h3 id="accessing-the-principal-and-authentication">Accessing the Principal and Authentication:<a class="headerlink" href="#accessing-the-principal-and-authentication" title="Permanent link">&para;</a></h3>
<p>Once Spring Security has authenticated a user, you can access the <strong>Principal</strong> and <strong>Authentication</strong> within your
application to make authorization decisions or retrieve user-specific information.</p>
<h4 id="accessing-the-principal">Accessing the Principal:<a class="headerlink" href="#accessing-the-principal" title="Permanent link">&para;</a></h4>
<p>You can access the <strong>Principal</strong> directly in your code using the <code>SecurityContextHolder</code> class, which provides a static
method called <code>getContext()</code>:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.Authentication</span><span class="p">;</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.context.SecurityContextHolder</span><span class="p">;</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UserDetails</span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="p">...</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecurityContextHolder</span><span class="p">.</span><span class="na">getContext</span><span class="p">().</span><span class="na">getAuthentication</span><span class="p">();</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">authentication</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getPrincipal</span><span class="p">()</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">UserDetails</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">    </span><span class="n">UserDetails</span><span class="w"> </span><span class="n">userDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UserDetails</span><span class="p">)</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getPrincipal</span><span class="p">();</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userDetails</span><span class="p">.</span><span class="na">getUsername</span><span class="p">();</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">    </span><span class="c1">// You can also access authorities, additional user information, etc.</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="p">}</span>
</span></code></pre></div>
<p>In the above code, we first retrieve the current <strong>Authentication</strong> object from the <strong>SecurityContextHolder</strong> and then
extract the <strong>Principal</strong> information, which could be a <strong>UserDetails</strong> object representing the authenticated user.</p>
<h4 id="accessing-the-authentication">Accessing the Authentication:<a class="headerlink" href="#accessing-the-authentication" title="Permanent link">&para;</a></h4>
<p>To access the <strong>Authentication</strong> object directly, you can use the same <code>SecurityContextHolder</code>:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.Authentication</span><span class="p">;</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.context.SecurityContextHolder</span><span class="p">;</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="p">...</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecurityContextHolder</span><span class="p">.</span><span class="na">getContext</span><span class="p">().</span><span class="na">getAuthentication</span><span class="p">();</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">authentication</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">    </span><span class="c1">// Access authentication information, such as credentials and authorities</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>With access to the <strong>Authentication</strong> object, you can check the user's credentials, roles, and any additional details
related to the authentication process.</p>
<h3 id="use-cases-for-principal-and-authentication">Use Cases for Principal and Authentication:<a class="headerlink" href="#use-cases-for-principal-and-authentication" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Authorization Logic:</strong> You can use the <strong>Principal</strong> and <strong>Authentication</strong> objects to make authorization decisions
  in your application. For example, you can check if the current user has the necessary roles or permissions to access a
  specific resource or perform an action.</p>
</li>
<li>
<p><strong>Custom User Information:</strong> You can extend the <strong>Principal</strong> object or customize the <strong>Authentication</strong> to include
  additional user information relevant to your application, such as user preferences or user-specific settings.</p>
</li>
<li>
<p><strong>Audit Logging:</strong> You can log authentication events and user interactions by extracting information from the *
  <em>Principal*</em> and <strong>Authentication</strong> objects, helping you monitor and track user activities within your application.</p>
</li>
</ul>
<p>By understanding how to access and utilize the <strong>Principal</strong> and <strong>Authentication</strong> in Spring Security, you can
effectively implement security measures, personalize user experiences, and maintain a secure and accountable environment
for your users and applications.</p>
<hr />
<h2 id="understanding-userdetails-and-userdetailsservice">Understanding UserDetails and UserDetailsService<a class="headerlink" href="#understanding-userdetails-and-userdetailsservice" title="Permanent link">&para;</a></h2>
<p>In Spring Security, <strong>UserDetails</strong> represents user-specific information, while <strong>UserDetailsService</strong> is responsible
for loading user information during authentication. This article delves into these concepts, explaining their roles and
providing practical insights with code examples for a clearer understanding.</p>
<p>In Spring Security, <strong>UserDetails</strong> and <strong>UserDetailsService</strong> are crucial components for managing user authentication
and authorization. <strong>UserDetails</strong> represents user-specific information, while <strong>UserDetailsService</strong> loads user details
during authentication. Let's explore these concepts in depth and understand how they contribute to securing your
applications.</p>
<h3 id="userdetails">UserDetails:<a class="headerlink" href="#userdetails" title="Permanent link">&para;</a></h3>
<p><strong>UserDetails</strong> is an interface in Spring Security that represents user-specific information. It encapsulates details
about a user, including their username, password, and authorities (roles). By implementing the <strong>UserDetails</strong> interface
or using classes that implement it, you provide Spring Security with essential information about your application's
users.</p>
<p>Key attributes of <strong>UserDetails</strong> include:</p>
<ul>
<li><strong>Username</strong>: The user's unique identifier.</li>
<li><strong>Password</strong>: The user's password, which should be securely hashed.</li>
<li><strong>Authorities</strong>: The roles or permissions associated with the user.</li>
</ul>
<h3 id="userdetailsservice">UserDetailsService:<a class="headerlink" href="#userdetailsservice" title="Permanent link">&para;</a></h3>
<p><strong>UserDetailsService</strong> is an interface responsible for loading user-specific data during the authentication process.
It's a vital part of Spring Security's authentication mechanism. When a user attempts to log in, the *
<em>UserDetailsService*</em> is used to retrieve the user's information from a data source (e.g., a database) based on their
username. Spring Security then uses this information to perform authentication.</p>
<p>Key responsibilities of <strong>UserDetailsService</strong> include:</p>
<ul>
<li>Loading user data, typically from a database or another data source.</li>
<li>Returning an instance of <strong>UserDetails</strong> populated with the user's information.</li>
<li>Handling exceptions if the user is not found or if there are any errors during user data retrieval.</li>
</ul>
<h3 id="implementing-userdetails-and-userdetailsservice">Implementing UserDetails and UserDetailsService:<a class="headerlink" href="#implementing-userdetails-and-userdetailsservice" title="Permanent link">&para;</a></h3>
<p>To use <strong>UserDetails</strong> and <strong>UserDetailsService</strong> effectively, you'll typically follow these steps:</p>
<ol>
<li><strong>Implement UserDetails</strong>: Create a class that implements the <strong>UserDetails</strong> interface or use an existing class that
   provides user-specific information. This class should contain the user's username, password (hashed), and
   authorities.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetails</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">       </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">       </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">       </span><span class="kd">private</span><span class="w"> </span><span class="n">Collection</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GrantedAuthority</span><span class="o">&gt;</span><span class="w"> </span><span class="n">authorities</span><span class="p">;</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">       </span><span class="c1">// Implement UserDetails methods</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<ol>
<li><strong>Implement UserDetailsService</strong>: Create a class that implements the <strong>UserDetailsService</strong> interface. Override
   the <code>loadUserByUsername</code> method to load user data based on the provided username.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w">   </span><span class="nd">@Service</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetailsService</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">       </span><span class="nd">@Override</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="nf">loadUserByUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">           </span><span class="c1">// Load user data from a data source (e.g., database)</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">           </span><span class="c1">// Create a UserDetails instance and return it</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<ol>
<li><strong>Configure Authentication Provider</strong>: Configure Spring Security to use your custom <strong>UserDetailsService</strong> to load
   user data during authentication.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="w">   </span><span class="nd">@Autowired</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">   </span><span class="nd">@Override</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">   </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">       </span><span class="n">auth</span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">userDetailsService</span><span class="p">).</span><span class="na">passwordEncoder</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">());</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<ol>
<li><strong>Use UserDetails for Authentication</strong>: During authentication, Spring Security uses the <strong>UserDetails</strong> instance
   returned by the <strong>UserDetailsService</strong> to compare the provided credentials with the stored ones and perform the
   authentication process.</li>
</ol>
<h3 id="practical-example_1">Practical Example:<a class="headerlink" href="#practical-example_1" title="Permanent link">&para;</a></h3>
<p>Here's a simplified example of implementing <strong>UserDetails</strong> and <strong>UserDetailsService</strong>:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nd">@Entity</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="nd">@Id</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="c1">// Other user properties, getters, and setters</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="p">}</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="nd">@Service</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetailsServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">userRepository</span><span class="p">;</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="nf">loadUserByUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">        </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userRepository</span><span class="p">.</span><span class="na">findByUsername</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">                </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="p">(</span><span class="s">&quot;User not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="p">));</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">User</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">                </span><span class="p">.</span><span class="na">username</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">getUsername</span><span class="p">())</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">                </span><span class="p">.</span><span class="na">password</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">getPassword</span><span class="p">())</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">                </span><span class="p">.</span><span class="na">authorities</span><span class="p">(</span><span class="n">Collections</span><span class="p">.</span><span class="na">singleton</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">SimpleGrantedAuthority</span><span class="p">(</span><span class="s">&quot;ROLE_USER&quot;</span><span class="p">)))</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="p">}</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="nd">@Configuration</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="w">        </span><span class="n">auth</span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">userDetailsService</span><span class="p">).</span><span class="na">passwordEncoder</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">());</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a>
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a><span class="w">    </span><span class="c1">// Other security configuration</span>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we define a <strong>User</strong> entity representing our application's users and a <strong>CustomUserDetailsServiceImpl</strong>
implementing <strong>UserDetailsService</strong> to load user data from a database. We then configure Spring Security to use this
custom <strong>UserDetailsService</strong> for authentication.</p>
<p>In Spring Security, <strong>UserDetails</strong> and <strong>UserDetailsService</strong> are essential components for managing user
authentication. <strong>UserDetails</strong> represents user-specific information, while <strong>UserDetailsService</strong> loads this
information during authentication. By implementing these interfaces and configuring Spring Security to use them, you can
securely authenticate users and authorize their access to your application's resources. Understanding these concepts is
crucial for building robust and secure authentication mechanisms in your Spring applications.</p>
<hr />
<h2 id="implementing-custom-authentication">Implementing Custom Authentication<a class="headerlink" href="#implementing-custom-authentication" title="Permanent link">&para;</a></h2>
<p>Implementing custom authentication in Spring Security involves creating a custom authentication provider, defining a
user details service, and configuring authentication using your custom components. This article offers a step-by-step
guide with practical examples to help you understand and implement custom authentication effectively.</p>
<p>Implementing custom authentication in Spring Security allows you to tailor the authentication process to your
application's specific requirements. This involves creating a custom authentication provider, defining a user details
service, and configuring authentication using your custom components. Let's walk through the steps of implementing
custom authentication in Spring Security with practical examples.</p>
<h3 id="steps-to-implement-custom-authentication">Steps to Implement Custom Authentication:<a class="headerlink" href="#steps-to-implement-custom-authentication" title="Permanent link">&para;</a></h3>
<h4 id="1-create-a-user-details-class">1. Create a User Details Class:<a class="headerlink" href="#1-create-a-user-details-class" title="Permanent link">&para;</a></h4>
<p>Start by creating a class that implements the <code>UserDetails</code> interface or extends a class that implements it. This class
represents user-specific information and should include details such as the username, password, and authorities (roles).</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.GrantedAuthority</span><span class="p">;</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UserDetails</span><span class="p">;</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collection</span><span class="p">;</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetails</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Collection</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GrantedAuthority</span><span class="o">&gt;</span><span class="w"> </span><span class="n">authorities</span><span class="p">;</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="w">    </span><span class="c1">// Implement UserDetails methods</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="2-define-a-user-details-service">2. Define a User Details Service:<a class="headerlink" href="#2-define-a-user-details-service" title="Permanent link">&para;</a></h4>
<p>Create a custom user details service by implementing the <code>UserDetailsService</code> interface. Override
the <code>loadUserByUsername</code> method to retrieve user data based on the provided username. In this method, you'll return an
instance of your custom <code>UserDetails</code> class populated with the user's information.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UserDetails</span><span class="p">;</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UserDetailsService</span><span class="p">;</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UsernameNotFoundException</span><span class="p">;</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetailsService</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="nf">loadUserByUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">        </span><span class="c1">// Load user data from your data source (e.g., database)</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">        </span><span class="c1">// Create a CustomUserDetails instance and return it</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="3-implement-authentication-provider">3. Implement Authentication Provider:<a class="headerlink" href="#3-implement-authentication-provider" title="Permanent link">&para;</a></h4>
<p>Next, create a custom authentication provider by implementing the <code>AuthenticationProvider</code> interface. Override
the <code>authenticate</code> method to perform authentication based on your custom logic. This is where you can validate user
credentials and create an <code>Authentication</code> object if authentication succeeds.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.authentication.AuthenticationProvider</span><span class="p">;</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.Authentication</span><span class="p">;</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.AuthenticationException</span><span class="p">;</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">        </span><span class="c1">// Custom authentication logic here</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="w">        </span><span class="c1">// Specify the authentication token class supported by this provider</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="4-configure-authentication">4. Configure Authentication:<a class="headerlink" href="#4-configure-authentication" title="Permanent link">&para;</a></h4>
<p>In your Spring Security configuration class, configure authentication to use your custom user details service and
authentication provider. Also, specify the password encoder you want to use for secure password storage.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomAuthenticationProvider</span><span class="w"> </span><span class="n">customAuthenticationProvider</span><span class="p">;</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">        </span><span class="n">auth</span><span class="p">.</span><span class="na">authenticationProvider</span><span class="p">(</span><span class="n">customAuthenticationProvider</span><span class="p">)</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w">            </span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">userDetailsService</span><span class="p">)</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="w">            </span><span class="p">.</span><span class="na">passwordEncoder</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">());</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a><span class="w">    </span><span class="c1">// Other security configurations</span>
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="5-implement-authentication-logic">5. Implement Authentication Logic:<a class="headerlink" href="#5-implement-authentication-logic" title="Permanent link">&para;</a></h4>
<p>Inside your custom authentication provider's <code>authenticate</code> method, implement your authentication logic. This typically
involves checking the provided credentials (e.g., username and password) against your data source, performing any
necessary validation, and creating an <code>Authentication</code> object if the authentication is successful.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.authentication.UsernamePasswordAuthenticationToken</span><span class="p">;</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.Authentication</span><span class="p">;</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.AuthenticationException</span><span class="p">;</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.authority.SimpleGrantedAuthority</span><span class="p">;</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.User</span><span class="p">;</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UserDetails</span><span class="p">;</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">getCredentials</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w">        </span><span class="c1">// Replace this with your actual user data retrieval logic</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="w">        </span><span class="n">UserDetails</span><span class="w"> </span><span class="n">userDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loadUserByUsername</span><span class="p">(</span><span class="n">username</span><span class="p">);</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userDetails</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">userDetails</span><span class="p">.</span><span class="na">getPassword</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">password</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="w">            </span><span class="c1">// Authentication succeeds</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">(</span><span class="n">userDetails</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">userDetails</span><span class="p">.</span><span class="na">getAuthorities</span><span class="p">());</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="w">            </span><span class="c1">// Authentication fails</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BadCredentialsException</span><span class="p">(</span><span class="s">&quot;Authentication failed&quot;</span><span class="p">);</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">authentication</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="6-implement-userdetails-logic">6. Implement UserDetails Logic:<a class="headerlink" href="#6-implement-userdetails-logic" title="Permanent link">&para;</a></h4>
<p>In your custom user details service's <code>loadUserByUsername</code> method, load user data from your data source and populate the
custom <code>UserDetails</code> object with the necessary information, including the username, password, and authorities (roles).</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.User</span><span class="p">;</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UserDetails</span><span class="p">;</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.userdetails.UsernameNotFoundException</span><span class="p">;</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collections</span><span class="p">;</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetailsService</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="nf">loadUserByUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="w">        </span><span class="c1">// Replace this with your actual user data retrieval logic</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">username</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="w">            </span><span class="c1">// Simulate user data retrieval</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{noop}password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Collections</span><span class="p">.</span><span class="na">singleton</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">SimpleGrantedAuthority</span><span class="p">(</span><span class="s">&quot;ROLE_USER&quot;</span><span class="p">)));</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="p">(</span><span class="s">&quot;User not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="p">);</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="7-additional-configuration">7. Additional Configuration:<a class="headerlink" href="#7-additional-configuration" title="Permanent link">&para;</a></h4>
<p>Customize your Spring Security configuration according to your application's needs. You can specify URL-based security
rules, configure</p>
<hr />
<h2 id="role-based-and-permission-based-access-control">Role-Based and Permission-Based Access Control<a class="headerlink" href="#role-based-and-permission-based-access-control" title="Permanent link">&para;</a></h2>
<p>Role-based and permission-based access control are mechanisms in Spring Security that define who can access specific
resources or perform certain actions in an application. Role-based access control assigns roles to users, while
permission-based access control grants specific permissions to users or roles. This article explores the purposes of
these mechanisms with practical examples and code snippets to illustrate their implementation.</p>
<p>In Spring Security, role-based and permission-based access control are fundamental strategies for managing and enforcing
access to resources and actions within an application. These mechanisms define who can access specific parts of the
application and perform certain actions. Let's delve into the purposes of role-based and permission-based access
control, accompanied by practical examples and code snippets to clarify their implementation.</p>
<h3 id="role-based-access-control">Role-Based Access Control:<a class="headerlink" href="#role-based-access-control" title="Permanent link">&para;</a></h3>
<p>Role-based access control (RBAC) aims to assign roles to users based on their responsibilities or job functions. Users
with specific roles are granted access to resources or actions associated with those roles. RBAC simplifies access
control by categorizing users into roles and defining access rules based on these roles.</p>
<h4 id="implementation">Implementation:<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Define Roles</strong>: Create roles that represent different levels of access or responsibilities within the application.
   Common roles might include "ADMIN," "USER," or "MANAGER."</p>
</li>
<li>
<p><strong>Assign Roles</strong>: Assign roles to users during user registration or based on their responsibilities within the
   organization.</p>
</li>
<li>
<p><strong>Configure Access Rules</strong>: In your Spring Security configuration, specify which roles can access specific resources
   or perform certain actions. You can use annotations like <code>@PreAuthorize</code> and <code>@Secured</code> or configure security rules
   in XML.</p>
</li>
</ol>
<p>Example using annotations:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nd">@Controller</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">)</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">adminPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">        </span><span class="c1">// Only users with the &#39;ADMIN&#39; role can access this page</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="p">;</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="permission-based-access-control">Permission-Based Access Control<a class="headerlink" href="#permission-based-access-control" title="Permanent link">&para;</a></h3>
<p>Permission-based access control (PBAC) provides fine-grained control over who can access specific resources or perform
actions. Instead of relying solely on roles, PBAC assigns explicit permissions to users or roles. This approach is
valuable when users within the same role require different levels of access.</p>
<h4 id="implementation_1">Implementation:<a class="headerlink" href="#implementation_1" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Define Permissions</strong>: Create permissions that represent specific actions or access levels within the application.
   Permissions can be strings like "READ", "WRITE", "DELETE", or custom names.</p>
</li>
<li>
<p><strong>Assign Permissions</strong>: Assign permissions to users or roles based on their requirements. Users can have multiple
   permissions, each representing a different action they can perform.</p>
</li>
<li>
<p><strong>Configure Access Rules</strong>: In your Spring Security configuration, define access rules that specify which users or
   roles are allowed to access resources or perform actions based on the assigned permissions.</p>
</li>
</ol>
<p>Example using annotations:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nd">@Controller</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/edit&quot;</span><span class="p">)</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasPermission(&#39;RESOURCE&#39;, &#39;WRITE&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">editResource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">        </span><span class="c1">// Users with &#39;WRITE&#39; permission on &#39;RESOURCE&#39; can access this action</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;edit&quot;</span><span class="p">;</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="role-based-vs-permission-based-access-control">Role-Based vs. Permission-Based Access Control:<a class="headerlink" href="#role-based-vs-permission-based-access-control" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Role-Based Access Control</strong> is suitable when users with the same responsibilities have identical access rights. It
  simplifies access control by grouping users into roles and defining access based on roles.</p>
</li>
<li>
<p><strong>Permission-Based Access Control</strong> is ideal when users within the same role require different levels of access. It
  offers greater granularity and flexibility by assigning explicit permissions to users or roles.</p>
</li>
</ul>
<p>In practice, a combination of both RBAC and PBAC can be used to strike a balance between simplicity and granularity in
access control. Spring Security provides tools and annotations to support both strategies, allowing you to choose the
approach that best fits your application's requirements.</p>
<p>By understanding the purposes and implementations of role-based and permission-based access control in Spring Security,
you can design a robust and secure access control system that ensures users have appropriate access to your
application's resources and actions.</p>
<h3 id="combining-role-based-and-permission-based-access-control">Combining Role-Based and Permission-Based Access Control:<a class="headerlink" href="#combining-role-based-and-permission-based-access-control" title="Permanent link">&para;</a></h3>
<p>In many real-world applications, it's common to combine both role-based and permission-based access control to achieve a
flexible and comprehensive access control system. Here's how you can integrate both strategies effectively:</p>
<ol>
<li>
<p><strong>Assign Roles</strong>: Assign roles to users based on their primary responsibilities or job functions. Roles provide a
   high-level categorization of access rights.</p>
</li>
<li>
<p><strong>Assign Permissions</strong>: Assign permissions to users or roles to grant fine-grained access for specific actions or
   resources. Permissions allow for more detailed control.</p>
</li>
<li>
<p><strong>Role-Permission Mapping</strong>: Define a mapping between roles and permissions. Each role may have associated
   permissions that define the actions users with that role can perform.</p>
</li>
<li>
<p><strong>Configure Access Rules</strong>: In your Spring Security configuration, combine role-based and permission-based access
   rules. Use annotations or configuration to specify which roles or permissions are required to access resources or
   perform actions.</p>
</li>
</ol>
<p>Example combining roles and permissions:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="nd">@Controller</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">)</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;) or hasPermission(&#39;RESOURCE&#39;, &#39;WRITE&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">adminPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">        </span><span class="c1">// Users with &#39;ADMIN&#39; role or &#39;WRITE&#39; permission on &#39;RESOURCE&#39; can access this page</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="p">;</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="p">}</span>
</span></code></pre></div>
<p>By integrating both role-based and permission-based access control, you can achieve a flexible and granular access
control system that accommodates varying levels of access within your application. This approach allows you to strike a
balance between simplicity and fine-grained control, ensuring that users have appropriate access to resources and
actions while maintaining security and flexibility.</p>
<p>Remember that the choice between role-based and permission-based access control, or a combination of both, depends on
your application's specific requirements and the complexity of access control scenarios. Spring Security provides the
tools and flexibility to implement the most suitable access control strategy for your project.</p>
<hr />
<h2 id="configuring-role-based-access-control">Configuring Role-Based Access Control<a class="headerlink" href="#configuring-role-based-access-control" title="Permanent link">&para;</a></h2>
<p>Configuring role-based access control in Spring Security involves defining roles, specifying access rules based on
roles, and configuring security settings to enforce these rules. This article provides a step-by-step guide with
practical examples and code snippets to help you set up role-based access control effectively.</p>
<p>Role-based access control (RBAC) is a vital aspect of security in Spring Security, allowing you to define roles,
associate them with users, and specify access rules based on roles. Configuring RBAC involves defining roles, specifying
access rules, and configuring security settings to enforce these rules. Let's explore how to configure role-based access
control in Spring Security step by step with practical examples.</p>
<h3 id="steps-to-configure-role-based-access-control">Steps to Configure Role-Based Access Control:<a class="headerlink" href="#steps-to-configure-role-based-access-control" title="Permanent link">&para;</a></h3>
<h4 id="1-define-roles">1. Define Roles:<a class="headerlink" href="#1-define-roles" title="Permanent link">&para;</a></h4>
<p>Start by defining roles that represent different levels of access or responsibilities within your application. Common
roles may include "ADMIN," "USER," or "MANAGER." You can define roles as constants or use an enum for better
organization.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Roles</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">ADMIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ADMIN&quot;</span><span class="p">;</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;USER&quot;</span><span class="p">;</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="c1">// Define other roles as needed</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="2-configure-access-rules">2. Configure Access Rules:<a class="headerlink" href="#2-configure-access-rules" title="Permanent link">&para;</a></h4>
<p>In your Spring Security configuration class, specify which roles are allowed to access specific resources or perform
certain actions. Use annotations like <code>@PreAuthorize</code> or <code>@Secured</code> to define access rules. For example, in a
controller:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nd">@Controller</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">)</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">adminPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">        </span><span class="c1">// Only users with the &#39;ADMIN&#39; role can access this page</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="p">;</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="3-configure-security">3. Configure Security:<a class="headerlink" href="#3-configure-security" title="Permanent link">&para;</a></h4>
<p>Configure your Spring Security settings to enforce the access rules defined in step 2. In your security configuration
class, use the <code>antMatchers</code> method to specify URL patterns and their required roles. You can also configure role-based
access at the method level using <code>@EnableGlobalMethodSecurity(prePostEnabled = true)</code>.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="nd">@EnableGlobalMethodSecurity</span><span class="p">(</span><span class="n">prePostEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="w">        </span><span class="n">http</span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="w">            </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="n">Roles</span><span class="p">.</span><span class="na">ADMIN</span><span class="p">)</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="w">            </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="n">Roles</span><span class="p">.</span><span class="na">USER</span><span class="p">)</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="w">            </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">            </span><span class="p">.</span><span class="na">formLogin</span><span class="p">()</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="w">            </span><span class="p">.</span><span class="na">logout</span><span class="p">().</span><span class="na">permitAll</span><span class="p">();</span>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="w">    </span><span class="c1">// Other security configurations</span>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, the <code>configure</code> method specifies that the "/admin" URL requires the "ADMIN" role, and the "/user" URL
requires the "USER" role for access. Any other requests are authenticated but do not require specific roles.</p>
<h4 id="4-assign-roles-to-users">4. Assign Roles to Users:<a class="headerlink" href="#4-assign-roles-to-users" title="Permanent link">&para;</a></h4>
<p>During user registration or when managing user profiles, assign roles to users based on their responsibilities or access
requirements. You can store user roles in a database or any other data source.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nd">@Entity</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="nd">@Id</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">    </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span><span class="w"> </span><span class="n">roles</span><span class="p">;</span><span class="w"> </span><span class="c1">// Use a Set to manage multiple roles per user</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="w">    </span><span class="c1">// Other user properties, getters, and setters</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="5-secure-resources-and-actions">5. Secure Resources and Actions:<a class="headerlink" href="#5-secure-resources-and-actions" title="Permanent link">&para;</a></h4>
<p>With roles assigned to users, the security configuration ensures that only users with the appropriate roles can access
protected resources or perform actions. Users without the required roles will be denied access.</p>
<p>Configuring role-based access control in Spring Security involves defining roles, specifying access rules, and
configuring security settings to enforce these rules. By following these steps and using annotations and configuration,
you can effectively implement RBAC in your Spring applications, ensuring that users have appropriate access to resources
and actions based on their roles and responsibilities.</p>
<h3 id="additional-considerations-and-best-practices">Additional Considerations and Best Practices:<a class="headerlink" href="#additional-considerations-and-best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Role Hierarchy</strong>: In some applications, you may have a hierarchy of roles where one role includes the permissions
   of another role. Spring Security supports role hierarchies, allowing you to specify relationships between roles.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="w">   </span><span class="nd">@Override</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">   </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">       </span><span class="n">http</span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">           </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;ADMIN&quot;</span><span class="p">)</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">           </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/manager&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;MANAGER&quot;</span><span class="p">)</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">           </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">)</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">           </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">           </span><span class="p">.</span><span class="na">formLogin</span><span class="p">()</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">           </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">           </span><span class="p">.</span><span class="na">logout</span><span class="p">().</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">           </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">           </span><span class="p">.</span><span class="na">hierarchicalRoleNames</span><span class="p">()</span><span class="w"> </span><span class="c1">// Enable role hierarchy</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">           </span><span class="p">.</span><span class="na">authorityRolePrefix</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Remove &quot;ROLE_&quot; prefix for roles</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<ol>
<li><strong>Custom Access Denied Page</strong>: You can customize the page or behavior displayed when a user without the required role
   attempts to access a restricted resource. This is done by configuring the <code>accessDeniedPage</code> or handling access
   denied exceptions.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="w">   </span><span class="nd">@Override</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">   </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">       </span><span class="n">http</span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">           </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;ADMIN&quot;</span><span class="p">)</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">           </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">)</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">           </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">           </span><span class="p">.</span><span class="na">exceptionHandling</span><span class="p">()</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">           </span><span class="p">.</span><span class="na">accessDeniedPage</span><span class="p">(</span><span class="s">&quot;/access-denied&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Custom access denied page</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<ol>
<li>
<p><strong>Dynamic Role Assignment</strong>: Depending on your application, you may need to dynamically assign roles to users based
   on various factors. Consider using custom logic or services to handle dynamic role assignment.</p>
</li>
<li>
<p><strong>Testing</strong>: Thoroughly test your role-based access control to ensure that users with the correct roles can access
   the expected resources and that unauthorized users are denied access.</p>
</li>
<li>
<p><strong>Regular Auditing</strong>: Regularly audit and review roles and access rules to ensure that they align with your
   application's security requirements and remain up to date.</p>
</li>
</ol>
<p>Role-based access control is a fundamental concept in Spring Security, providing a structured and manageable way to
control access to resources and actions within your application. By configuring RBAC effectively and following best
practices, you can strengthen the security of your Spring-based applications while ensuring that users have the
appropriate level of access.</p>
<hr />
<h2 id="explaining-method-level-security">Explaining Method-Level Security<a class="headerlink" href="#explaining-method-level-security" title="Permanent link">&para;</a></h2>
<p>Method-level security in Spring Security allows you to control access to specific methods or functions within your
application. You can define access rules and permissions on individual methods, ensuring that only authorized users can
execute them. This article provides a comprehensive explanation of method-level security, including practical examples
and code snippets to illustrate its implementation.</p>
<p>Method-level security is a powerful feature in Spring Security that allows you to control access to specific methods or
functions within your application. With method-level security, you can define access rules and permissions on individual
methods, ensuring that only authorized users can execute them. Let's dive into the concept of method-level security in
Spring Security, providing a thorough explanation along with practical examples and code snippets to demonstrate its
implementation.</p>
<h3 id="understanding-method-level-security">Understanding Method-Level Security:<a class="headerlink" href="#understanding-method-level-security" title="Permanent link">&para;</a></h3>
<p>Method-level security complements the traditional URL-based security provided by Spring Security. While URL-based
security focuses on securing specific URLs or resources, method-level security focuses on securing methods or functions
within your application. This is particularly useful when you want to apply fine-grained access control to various parts
of your code.</p>
<h4 id="key-components">Key Components:<a class="headerlink" href="#key-components" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Annotations</strong>: Spring Security provides annotations that you can use to define access rules on methods. The most
   commonly used annotations for method-level security are <code>@PreAuthorize</code> and <code>@PostAuthorize</code>.</p>
</li>
<li>
<p><strong>Expression Language</strong>: These annotations allow you to specify access control expressions using Spring Security's
   expression language (SpEL). In these expressions, you define who is allowed to execute a method based on user roles,
   permissions, or other conditions.</p>
</li>
</ol>
<h3 id="practical-implementation">Practical Implementation:<a class="headerlink" href="#practical-implementation" title="Permanent link">&para;</a></h3>
<h4 id="1-enable-method-level-security">1. Enable Method-Level Security:<a class="headerlink" href="#1-enable-method-level-security" title="Permanent link">&para;</a></h4>
<p>To enable method-level security, you need to configure your Spring Security application to use method security
annotations. This is typically done by adding <code>@EnableGlobalMethodSecurity(prePostEnabled = true)</code> to your security
configuration class.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="nd">@EnableGlobalMethodSecurity</span><span class="p">(</span><span class="n">prePostEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">    </span><span class="c1">// Configuration settings</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="2-use-preauthorize-and-postauthorize-annotations">2. Use <code>@PreAuthorize</code> and <code>@PostAuthorize</code> Annotations:<a class="headerlink" href="#2-use-preauthorize-and-postauthorize-annotations" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><code>@PreAuthorize</code>: This annotation is used to specify access control conditions that must be met before a method is
  executed. It allows you to define who is authorized to invoke the method based on expressions.</p>
</li>
<li>
<p><code>@PostAuthorize</code>: This annotation is used to specify access control conditions that are checked after a method is
  executed. It allows you to filter the results of a method based on expressions.</p>
</li>
</ul>
<h4 id="3-define-access-control-expressions">3. Define Access Control Expressions:<a class="headerlink" href="#3-define-access-control-expressions" title="Permanent link">&para;</a></h4>
<p>In your code, annotate the methods you want to secure with <code>@PreAuthorize</code> or <code>@PostAuthorize</code> and provide access
control expressions as values. These expressions define the conditions under which the method can be executed.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nd">@Service</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">adminOnlyMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">        </span><span class="c1">// This method can only be executed by users with the &#39;ADMIN&#39; role.</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasAnyRole(&#39;USER&#39;, &#39;MANAGER&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">userAndManagerMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">        </span><span class="c1">// This method can be executed by users with either the &#39;USER&#39; or &#39;MANAGER&#39; role.</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">    </span><span class="nd">@PostAuthorize</span><span class="p">(</span><span class="s">&quot;returnObject.createdBy == authentication.name&quot;</span><span class="p">)</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">MyResource</span><span class="w"> </span><span class="nf">getMyResource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="w">        </span><span class="c1">// This method returns MyResource objects, and the result will be filtered to include</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="w">        </span><span class="c1">// only those where &#39;createdBy&#39; matches the authenticated user&#39;s name.</span>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="4-access-control-expressions">4. Access Control Expressions:<a class="headerlink" href="#4-access-control-expressions" title="Permanent link">&para;</a></h4>
<p>In access control expressions, you can use various SpEL elements and functions to define conditions. For example:</p>
<ul>
<li><code>hasRole('ROLE_NAME')</code>: Checks if the user has a specific role.</li>
<li><code>hasAnyRole('ROLE1', 'ROLE2')</code>: Checks if the user has any of the specified roles.</li>
<li><code>hasAuthority('PERMISSION')</code>: Checks if the user has a specific permission.</li>
<li><code>hasAnyAuthority('PERM1', 'PERM2')</code>: Checks if the user has any of the specified permissions.</li>
<li><code>isAuthenticated()</code>: Checks if the user is authenticated.</li>
<li><code>isAnonymous()</code>: Checks if the user is anonymous (not authenticated).</li>
</ul>
<p>Method-level security in Spring Security empowers you to apply fine-grained access control to specific methods or
functions within your application. By using annotations like <code>@PreAuthorize</code> and <code>@PostAuthorize</code>, along with SpEL
expressions, you can define who is authorized to execute a method based on roles, permissions, or custom conditions.
This level of control enhances the security and flexibility of your application, ensuring that sensitive operations are
protected from unauthorized access.</p>
<h3 id="additional-considerations-and-best-practices_1">Additional Considerations and Best Practices:<a class="headerlink" href="#additional-considerations-and-best-practices_1" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Access Control Expressions</strong>: Be mindful of the complexity of your access control expressions. While method-level
   security offers fine-grained control, overly complex expressions can make your code less maintainable. Keep
   expressions concise and well-documented.</p>
</li>
<li>
<p><strong>Resource-Level Security</strong>: In addition to method-level security, consider implementing resource-level security.
   This involves securing individual resources, such as database records or files, based on user roles or permissions.</p>
</li>
<li>
<p><strong>Error Handling</strong>: Properly handle exceptions and error messages when access control expressions fail. Spring
   Security provides mechanisms to handle authentication and authorization exceptions gracefully.</p>
</li>
<li>
<p><strong>Testing</strong>: Thoroughly test your method-level security configurations to ensure that access control expressions work
   as expected. Write unit tests that cover various scenarios and edge cases.</p>
</li>
<li>
<p><strong>Audit Trails</strong>: Consider implementing audit trails to log access to sensitive methods. This can help in tracking
   and monitoring user activities.</p>
</li>
<li>
<p><strong>Documentation</strong>: Clearly document the access control expressions used in your code. Make it easy for other
   developers (and yourself) to understand the security requirements of each method.</p>
</li>
<li>
<p><strong>Code Reviews</strong>: Include security-related code reviews as part of your development process. Ensure that method-level
   security is correctly implemented and aligned with your application's security policy.</p>
</li>
<li>
<p><strong>Regular Updates</strong>: Periodically review and update your access control expressions to accommodate changes in your
   application's requirements or security policies.</p>
</li>
</ol>
<p>Method-level security in Spring Security is a valuable tool for enforcing fine-grained access control within your
application. When used effectively, it enhances the security of your code by ensuring that only authorized users can
execute specific methods. By following best practices and considering the points mentioned above, you can maintain a
secure and manageable codebase while benefiting from the flexibility offered by method-level security.</p>
<hr />
<h2 id="understanding-spring-security-filters-and-their-purpose">Understanding Spring Security Filters and Their Purpose<a class="headerlink" href="#understanding-spring-security-filters-and-their-purpose" title="Permanent link">&para;</a></h2>
<p>Spring Security filters are essential components that play a crucial role in the authentication and authorization
process of Spring Security. They handle various security-related tasks, such as authentication, authorization, and
request processing. Some important Spring Security filters
include <code>UsernamePasswordAuthenticationFilter</code>, <code>BasicAuthenticationFilter</code>, and <code>FilterSecurityInterceptor</code>. This
article explains the purpose of Spring Security filters and provides insights into several significant filters used in
Spring Security.</p>
<p>Spring Security filters are vital components of the Spring Security framework responsible for managing security-related
tasks during the authentication and authorization process. These filters handle a wide range of responsibilities,
including user authentication, authorization, request processing, and more. Understanding the purpose and function of
Spring Security filters is essential for building secure and protected web applications. In this article, we will delve
into the role of Spring Security filters and introduce some of the important filters commonly used in Spring Security.</p>
<h3 id="purpose-of-spring-security-filters">Purpose of Spring Security Filters:<a class="headerlink" href="#purpose-of-spring-security-filters" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Authentication</strong>: Spring Security filters are responsible for handling user authentication. They intercept login
   requests, validate user credentials, and establish user sessions if authentication is successful.</p>
</li>
<li>
<p><strong>Authorization</strong>: Filters enforce access control by verifying whether a user is authorized to access specific
   resources or perform certain actions. They enforce security policies defined in the application.</p>
</li>
<li>
<p><strong>Request Processing</strong>: Spring Security filters intercept incoming requests and decide whether they should be allowed
   to proceed or denied based on security rules.</p>
</li>
<li>
<p><strong>Session Management</strong>: Filters manage user sessions, including session creation, tracking, and termination. They can
   handle features like single sign-on (SSO) and session timeout.</p>
</li>
<li>
<p><strong>Security Headers</strong>: Some filters are responsible for adding security-related HTTP headers to responses, such as
   content security policies (CSP), cross-origin resource sharing (CORS) headers, and HTTP strict transport security (
   HSTS).</p>
</li>
</ol>
<h3 id="important-spring-security-filters">Important Spring Security Filters:<a class="headerlink" href="#important-spring-security-filters" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>UsernamePasswordAuthenticationFilter</strong>: This filter handles form-based authentication. It intercepts login
   requests, extracts user credentials, and initiates the authentication process.</p>
</li>
<li>
<p><strong>BasicAuthenticationFilter</strong>: Responsible for processing HTTP Basic Authentication requests, where the username and
   password are included in the request headers. It extracts credentials and initiates authentication.</p>
</li>
<li>
<p><strong>FilterSecurityInterceptor</strong>: Enforces access control decisions for secure objects (resources). It checks whether a
   user has the required roles or permissions to access a specific resource and decides whether to grant or deny access.</p>
</li>
<li>
<p><strong>ExceptionTranslationFilter</strong>: Deals with exceptions thrown during the authentication and authorization process. It
   translates exceptions into appropriate HTTP responses, such as redirecting to a login page or returning an access
   denied response.</p>
</li>
<li>
<p><strong>CsrfFilter</strong>: Helps protect against Cross-Site Request Forgery (CSRF) attacks by verifying that incoming requests
   contain a valid CSRF token.</p>
</li>
<li>
<p><strong>SessionManagementFilter</strong>: Manages user sessions, including session fixation protection, session timeout handling,
   and concurrent session control.</p>
</li>
<li>
<p><strong>SecurityHeadersFilter</strong>: Adds security-related HTTP headers to responses to enhance security, including headers
   like X-Content-Type-Options, X-Frame-Options, and Content-Security-Policy (CSP).</p>
</li>
</ol>
<h3 id="example-of-a-spring-security-filter-configuration">Example of a Spring Security Filter Configuration:<a class="headerlink" href="#example-of-a-spring-security-filter-configuration" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomAuthenticationProvider</span><span class="w"> </span><span class="n">customAuthenticationProvider</span><span class="p">;</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin/**&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;ADMIN&quot;</span><span class="p">)</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">            </span><span class="p">.</span><span class="na">formLogin</span><span class="p">()</span>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">                </span><span class="p">.</span><span class="na">loginPage</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-43-19"><a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-43-20"><a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a><span class="w">            </span><span class="p">.</span><span class="na">logout</span><span class="p">()</span>
</span><span id="__span-43-21"><a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a><span class="w">                </span><span class="p">.</span><span class="na">logoutUrl</span><span class="p">(</span><span class="s">&quot;/logout&quot;</span><span class="p">)</span>
</span><span id="__span-43-22"><a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">();</span>
</span><span id="__span-43-23"><a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-24"><a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a>
</span><span id="__span-43-25"><a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-43-26"><a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-27"><a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a><span class="w">        </span><span class="n">auth</span><span class="p">.</span><span class="na">authenticationProvider</span><span class="p">(</span><span class="n">customAuthenticationProvider</span><span class="p">);</span>
</span><span id="__span-43-28"><a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-29"><a id="__codelineno-43-29" name="__codelineno-43-29" href="#__codelineno-43-29"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we configure various Spring Security filters through the <code>HttpSecurity</code> object. We specify access rules
for different URL patterns, define custom login and logout pages, and configure the authentication provider. Spring
Security filters work together to enforce these security settings.</p>
<p>Understanding the purpose of Spring Security filters and their interactions is essential for building robust and secure
applications. These filters form the backbone of Spring Security's authentication and authorization mechanisms, ensuring
that your application's resources are protected and access is controlled according to your security policies.</p>
<h3 id="additional-spring-security-filters">Additional Spring Security Filters:<a class="headerlink" href="#additional-spring-security-filters" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>ConcurrentSessionFilter</strong>: Enforces restrictions on concurrent user sessions, preventing users from being logged in
   multiple times concurrently. You can configure the maximum number of allowed sessions per user.</p>
</li>
<li>
<p><strong>RememberMeAuthenticationFilter</strong>: Manages remember-me authentication, allowing users to be automatically logged in
   even after their session has expired. It handles the remember-me token validation.</p>
</li>
<li>
<p><strong>CorsFilter</strong>: Handles Cross-Origin Resource Sharing (CORS) by adding appropriate HTTP headers to responses,
    allowing or denying cross-origin requests based on the configured policies.</p>
</li>
<li>
<p><strong>RequestCacheAwareFilter</strong>: Facilitates handling of cached requests. It can be used in scenarios where a user is
    redirected to the login page due to authentication requirements and is then redirected back to their original
    request after successful login.</p>
</li>
<li>
<p><strong>LogoutFilter</strong>: Manages the logout process by intercepting logout requests, invalidating user sessions, clearing
    authentication tokens, and redirecting users to a specified logout success URL.</p>
</li>
<li>
<p><strong>SessionFixationProtectionFilter</strong>: Mitigates session fixation attacks by changing the session ID upon successful
    login. This ensures that any previously obtained session ID becomes invalid.</p>
</li>
<li>
<p><strong>X509AuthenticationFilter</strong>: Handles X.509 client certificate authentication, allowing clients to authenticate
    using X.509 certificates.</p>
</li>
<li>
<p><strong>AnonymousAuthenticationFilter</strong>: Provides an anonymous authentication token for unauthenticated users, allowing
    them to access certain resources while keeping track of their anonymity.</p>
</li>
</ol>
<p>These additional Spring Security filters cater to specific security requirements and scenarios, enhancing the overall
security posture of your application.</p>
<h3 id="customizing-and-extending-filters">Customizing and Extending Filters:<a class="headerlink" href="#customizing-and-extending-filters" title="Permanent link">&para;</a></h3>
<p>Spring Security offers flexibility in customizing and extending filters to meet your application's unique needs. You can
create custom filters by implementing the <code>javax.servlet.Filter</code> interface and integrate them into the Spring Security
filter chain. Custom filters allow you to add custom authentication mechanisms, logging, auditing, or any other
security-related functionality.</p>
<p>Here's an example of how to add a custom filter to the Spring Security filter chain:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomFilter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GenericFilterBean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doFilter</span><span class="p">(</span><span class="n">ServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">ServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">FilterChain</span><span class="w"> </span><span class="n">chain</span><span class="p">)</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ServletException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">        </span><span class="c1">// Implement custom filter logic here</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">        </span><span class="n">chain</span><span class="p">.</span><span class="na">doFilter</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="p">}</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="nd">@Configuration</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomFilter</span><span class="w"> </span><span class="n">customFilter</span><span class="p">;</span>
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a><span class="w">        </span><span class="n">http</span><span class="p">.</span><span class="na">addFilterBefore</span><span class="p">(</span><span class="n">customFilter</span><span class="p">,</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationFilter</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a><span class="w">        </span><span class="c1">// Configure other security settings</span>
</span><span id="__span-44-21"><a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-44-22"><a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we create a custom filter <code>CustomFilter</code> by implementing the <code>GenericFilterBean</code> interface. We then add
this custom filter to the Spring Security filter chain using the <code>addFilterBefore</code> method.</p>
<p>Understanding Spring Security filters and their role in the authentication and authorization process is crucial for
building secure web applications. By configuring and customizing these filters effectively, you can enhance the security
of your application, protect sensitive resources, and control access based on your application's security policies.</p>
<h3 id="filter-order-and-execution">Filter Order and Execution:<a class="headerlink" href="#filter-order-and-execution" title="Permanent link">&para;</a></h3>
<p>It's essential to understand the order in which Spring Security filters are executed in the filter chain. Filters are
executed sequentially based on their position in the chain. The order typically matters because some filters may depend
on the actions or data manipulated by earlier filters.</p>
<p>Spring Security uses integer values to specify filter order, with lower values indicating filters that execute earlier.
Filters with higher order values execute later in the chain.</p>
<p>For example, the <code>UsernamePasswordAuthenticationFilter</code>, which handles form-based authentication, usually executes early
in the chain to process login requests. The <code>FilterSecurityInterceptor</code>, responsible for enforcing access control
decisions, typically executes later in the chain.</p>
<p>You can explicitly set the order of custom filters using the <code>setOrder</code> method when adding them to the filter chain.
This allows you to control the order in which your custom filters are executed.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomFilter</span><span class="w"> </span><span class="n">customFilter</span><span class="p">;</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">        </span><span class="n">http</span><span class="p">.</span><span class="na">addFilterBefore</span><span class="p">(</span><span class="n">customFilter</span><span class="p">,</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationFilter</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin/**&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;ADMIN&quot;</span><span class="p">)</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="w">            </span><span class="p">.</span><span class="na">formLogin</span><span class="p">()</span>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a><span class="w">                </span><span class="p">.</span><span class="na">loginPage</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a><span class="w">            </span><span class="p">.</span><span class="na">logout</span><span class="p">()</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="w">                </span><span class="p">.</span><span class="na">logoutUrl</span><span class="p">(</span><span class="s">&quot;/logout&quot;</span><span class="p">)</span>
</span><span id="__span-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="w">                </span><span class="p">.</span><span class="na">permitAll</span><span class="p">();</span>
</span><span id="__span-45-21"><a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-45-22"><a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we add the <code>customFilter</code> before the <code>UsernamePasswordAuthenticationFilter</code> to ensure that our custom
filter executes before the authentication filter.</p>
<p>Understanding the order of execution is crucial when integrating custom filters or configuring Spring Security in your
application to ensure that filters are applied in the desired sequence.</p>
<p>In conclusion, Spring Security filters are essential components responsible for managing various security-related tasks
in your web application. They play a pivotal role in authentication, authorization, request processing, and securing
your resources. By configuring, customizing, and understanding the order of execution of these filters, you can build a
robust and secure application that adheres to your specific security requirements.</p>
<h3 id="filter-chain-overview">Filter Chain Overview:<a class="headerlink" href="#filter-chain-overview" title="Permanent link">&para;</a></h3>
<p>To gain a better understanding of how Spring Security filters work together, it's helpful to visualize the typical
filter chain in a Spring Security-enabled web application:</p>
<ol>
<li>
<p><strong>SecurityContextPersistenceFilter</strong>: This filter ensures that the <code>SecurityContext</code> (which holds the user's
   authentication details) is available for the duration of the request. It might load the user's authentication details
   from a session or a security token.</p>
</li>
<li>
<p><strong>UsernamePasswordAuthenticationFilter</strong>: Responsible for handling form-based authentication. It intercepts login
   requests, validates user credentials, and creates an <code>Authentication</code> object if authentication is successful.</p>
</li>
<li>
<p><strong>BasicAuthenticationFilter</strong>: Processes HTTP Basic Authentication requests. If a request includes basic
   authentication headers, this filter extracts and validates the credentials.</p>
</li>
<li>
<p><strong>RememberMeAuthenticationFilter</strong>: Manages remember-me authentication, allowing users to be automatically logged in
   based on a remember-me token.</p>
</li>
<li>
<p><strong>AnonymousAuthenticationFilter</strong>: Provides an anonymous authentication token for unauthenticated users. This allows
   anonymous access to certain resources while still keeping track of the user's anonymity.</p>
</li>
<li>
<p><strong>ExceptionTranslationFilter</strong>: Handles exceptions thrown during the authentication and authorization process. It
   translates exceptions into appropriate HTTP responses, such as redirecting to a login page or returning an access
   denied response.</p>
</li>
<li>
<p><strong>FilterSecurityInterceptor</strong>: Enforces access control decisions for secure objects (resources). It checks whether a
   user has the required roles or permissions to access a specific resource and decides whether to grant or deny access.</p>
</li>
<li>
<p><strong>LogoutFilter</strong>: Manages the logout process, intercepting logout requests, invalidating user sessions, clearing
   authentication tokens, and redirecting users to a specified logout success URL.</p>
</li>
<li>
<p><strong>SessionManagementFilter</strong>: Manages user sessions, including session fixation protection, session timeout handling,
   and concurrent session control.</p>
</li>
<li>
<p><strong>CsrfFilter</strong>: Protects against Cross-Site Request Forgery (CSRF) attacks by verifying that incoming requests
    contain a valid CSRF token.</p>
</li>
<li>
<p><strong>SecurityHeadersFilter</strong>: Adds security-related HTTP headers to responses, enhancing security by configuring
    headers like X-Content-Type-Options, X-Frame-Options, and Content-Security-Policy (CSP).</p>
</li>
<li>
<p><strong>CorsFilter</strong>: Handles Cross-Origin Resource Sharing (CORS) by adding appropriate HTTP headers to responses,
    allowing or denying cross-origin requests based on the configured policies.</p>
</li>
<li>
<p><strong>RequestCacheAwareFilter</strong>: Facilitates handling of cached requests, ensuring that users are redirected back to
    their original requests after successful login.</p>
</li>
<li>
<p><strong>SessionFixationProtectionFilter</strong>: Mitigates session fixation attacks by changing the session ID upon successful
    login, making any previously obtained session ID invalid.</p>
</li>
<li>
<p><strong>X509AuthenticationFilter</strong>: Handles X.509 client certificate authentication, allowing clients to authenticate
    using X.509 certificates.</p>
</li>
<li>
<p><strong>ConcurrentSessionFilter</strong>: Enforces restrictions on concurrent user sessions, preventing users from being logged
    in multiple times concurrently.</p>
</li>
</ol>
<p>These filters work together to ensure the security of your web application. The order of execution, as previously
mentioned, is determined by the filter chain configuration and the filter's order values.</p>
<p>As a developer, you can customize and extend this filter chain to meet your application's specific security
requirements. Understanding the purpose and order of Spring Security filters is crucial for building a secure and
well-protected web application.</p>
<h3 id="additional-filters-and-customization">Additional Filters and Customization:<a class="headerlink" href="#additional-filters-and-customization" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Custom Filters</strong>: Apart from the built-in filters, you can create your custom filters to address specific security
    requirements. Custom filters give you complete control over how requests are processed, authenticated, and
    authorized. You can implement custom filters by extending the <code>GenericFilterBean</code> class and implementing
    the <code>doFilter</code> method.</p>
</li>
<li>
<p><strong>Filter Chain Customization</strong>: Spring Security provides extensive flexibility for customizing the filter chain to
    match your application's needs. You can add, remove, or reorder filters in the chain to tailor the security
    processing flow. Customizing the filter chain is often done through Java configuration or XML configuration,
    depending on your project setup.</p>
</li>
<li>
<p><strong>Conditional Filters</strong>: You can conditionally enable or disable filters based on specific conditions. For example,
    you might enable certain filters only for specific URL patterns or based on user roles.</p>
</li>
<li>
<p><strong>Composite Filters</strong>: Spring Security allows you to create composite filters that encapsulate multiple filters and
    apply them as a single unit. This is useful for simplifying filter chain configuration when dealing with complex
    security requirements.</p>
</li>
<li>
<p><strong>Filter Chaining</strong>: Spring Security supports multiple filter chains within a single application. This is
    particularly valuable when you need different security configurations for various parts of your application. Each
    filter chain can have its set of filters and rules.</p>
</li>
<li>
<p><strong>Exception Handling</strong>: Filters may throw exceptions during processing, such as authentication failures or access
    denied exceptions. Properly handle these exceptions to provide meaningful error messages or redirect users to
    appropriate error pages.</p>
</li>
<li>
<p><strong>Logging and Auditing</strong>: Consider adding logging and auditing mechanisms within your custom filters to monitor and
    record security-related events. This can be invaluable for troubleshooting and security analysis.</p>
</li>
<li>
<p><strong>Security Headers Configuration</strong>: Configure security headers in your application to protect against common web
    security threats. Spring Security provides filter-based mechanisms for adding security headers, but you can also set
    them in your application server or web server.</p>
</li>
<li>
<p><strong>Third-Party Integration</strong>: When working with third-party authentication providers (e.g., OAuth2 or SAML), you may
    need to integrate additional filters specific to those providers. Spring Security offers extensions and libraries
    for seamless integration.</p>
</li>
<li>
<p><strong>Testing Filters</strong>: Testing Spring Security filters is essential to ensure they function as expected. Use tools
    like Spring Security Test to create unit tests for your custom filters and validate their behavior.</p>
</li>
</ol>
<p>By understanding these additional aspects and taking advantage of customization options, you can tailor Spring Security
filters to meet the unique security requirements of your application. Effective configuration and management of filters
are key to building a robust and secure web application that protects sensitive data and resources.</p>
<hr />
<h2 id="spring-security-session-management-and-authentication-mechanisms-jwt-and-oauth2">Spring Security Session Management and Authentication Mechanisms (JWT and OAuth2)<a class="headerlink" href="#spring-security-session-management-and-authentication-mechanisms-jwt-and-oauth2" title="Permanent link">&para;</a></h2>
<p>Spring Security provides flexible options for session management and supports various authentication mechanisms,
including JWT (JSON Web Tokens) and OAuth2. It offers built-in support for session handling, and you can integrate
third-party libraries for JWT and OAuth2. This article explains Spring Security's session management features, JWT
authentication, and OAuth2 integration with practical examples.</p>
<p>Spring Security is a versatile framework that offers robust solutions for session management and supports various
authentication mechanisms, including JWT (JSON Web Tokens) and OAuth2. This article explores how Spring Security handles
session management and integrates with these authentication mechanisms to provide secure authentication and
authorization in your applications.</p>
<h3 id="spring-security-session-management">Spring Security Session Management:<a class="headerlink" href="#spring-security-session-management" title="Permanent link">&para;</a></h3>
<p>Spring Security provides comprehensive session management capabilities to control user sessions and enhance security.
Key features include:</p>
<ol>
<li>
<p><strong>Session Fixation Protection</strong>: Spring Security protects against session fixation attacks by automatically
   generating a new session upon user authentication. This ensures that any existing session is invalidated.</p>
</li>
<li>
<p><strong>Session Timeout Handling</strong>: You can configure session timeout settings, defining how long an idle session remains
   active before it expires. When a session times out, users are automatically logged out.</p>
</li>
<li>
<p><strong>Concurrent Session Control</strong>: Spring Security enables you to limit the number of concurrent user sessions. You can
   specify the maximum number of allowed sessions per user, and additional login attempts are denied once the limit is
   reached.</p>
</li>
<li>
<p><strong>Single Sign-On (SSO)</strong>: Spring Security supports single sign-on mechanisms, allowing users to log in once and
   access multiple applications without needing to authenticate repeatedly.</p>
</li>
</ol>
<h3 id="jwt-json-web-tokens-authentication">JWT (JSON Web Tokens) Authentication:<a class="headerlink" href="#jwt-json-web-tokens-authentication" title="Permanent link">&para;</a></h3>
<p>JWT is a popular authentication mechanism used in modern web applications. Spring Security can integrate JWT
authentication seamlessly. Here's a high-level overview of how it works:</p>
<ol>
<li>
<p><strong>JWT Generation</strong>: When a user successfully authenticates, the server generates a JWT containing user information
   and signs it with a secret key. The JWT is then sent to the client.</p>
</li>
<li>
<p><strong>JWT Storage</strong>: The client stores the JWT, typically in local storage or a cookie.</p>
</li>
<li>
<p><strong>JWT Authentication</strong>: For subsequent requests, the client includes the JWT in the request header. Spring Security
   validates the JWT's signature, extracts user information, and authenticates the user based on the JWT content.</p>
</li>
<li>
<p><strong>Authorization</strong>: After successful JWT validation, Spring Security authorizes the user to access protected resources
   based on their roles and permissions.</p>
</li>
</ol>
<p>Example configuration for JWT authentication in Spring Security:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="w">        </span><span class="n">http</span><span class="p">.</span><span class="na">csrf</span><span class="p">().</span><span class="na">disable</span><span class="p">()</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/secure/**&quot;</span><span class="p">).</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="w">            </span><span class="p">.</span><span class="na">addFilter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JwtAuthenticationFilter</span><span class="p">(</span><span class="n">authenticationManager</span><span class="p">()))</span>
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="w">            </span><span class="p">.</span><span class="na">sessionManagement</span><span class="p">().</span><span class="na">sessionCreationPolicy</span><span class="p">(</span><span class="n">SessionCreationPolicy</span><span class="p">.</span><span class="na">STATELESS</span><span class="p">);</span>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="oauth2-integration">OAuth2 Integration:<a class="headerlink" href="#oauth2-integration" title="Permanent link">&para;</a></h3>
<p>OAuth2 is a widely adopted standard for secure authentication and authorization. Spring Security can be extended to
integrate OAuth2 providers such as Google, Facebook, or custom OAuth2 servers. Here's an overview:</p>
<ol>
<li>
<p><strong>OAuth2 Provider Configuration</strong>: Configure Spring Security to recognize and interact with your chosen OAuth2
   provider, specifying client credentials and redirect URIs.</p>
</li>
<li>
<p><strong>User Authentication</strong>: When a user initiates OAuth2 login, Spring Security redirects them to the OAuth2 provider's
   login page. After successful authentication, the provider issues an access token.</p>
</li>
<li>
<p><strong>Access Token Handling</strong>: Spring Security validates the access token received from the OAuth2 provider. If valid, it
   associates the authenticated user with the local session.</p>
</li>
<li>
<p><strong>Authorization</strong>: Users are granted access to resources based on their roles and permissions, similar to traditional
   Spring Security authentication.</p>
</li>
</ol>
<p>Example configuration for OAuth2 integration with Google in Spring Security:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="nd">@EnableOAuth2Client</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">OAuth2ClientContext</span><span class="w"> </span><span class="n">oauth2ClientContext</span><span class="p">;</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/secure/**&quot;</span><span class="p">).</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a><span class="w">            </span><span class="p">.</span><span class="na">addFilterBefore</span><span class="p">(</span><span class="n">ssoFilter</span><span class="p">(),</span><span class="w"> </span><span class="n">BasicAuthenticationFilter</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a><span class="w">            </span><span class="p">.</span><span class="na">csrf</span><span class="p">().</span><span class="na">disable</span><span class="p">();</span>
</span><span id="__span-47-17"><a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-47-18"><a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a>
</span><span id="__span-47-19"><a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Filter</span><span class="w"> </span><span class="nf">ssoFilter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-20"><a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a><span class="w">        </span><span class="n">OAuth2ClientAuthenticationProcessingFilter</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OAuth2ClientAuthenticationProcessingFilter</span><span class="p">(</span><span class="s">&quot;/login/google&quot;</span><span class="p">);</span>
</span><span id="__span-47-21"><a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a><span class="w">        </span><span class="n">OAuth2RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OAuth2RestTemplate</span><span class="p">(</span><span class="n">google</span><span class="p">(),</span><span class="w"> </span><span class="n">oauth2ClientContext</span><span class="p">);</span>
</span><span id="__span-47-22"><a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a><span class="w">        </span><span class="n">filter</span><span class="p">.</span><span class="na">setRestTemplate</span><span class="p">(</span><span class="n">restTemplate</span><span class="p">);</span>
</span><span id="__span-47-23"><a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a><span class="w">        </span><span class="n">filter</span><span class="p">.</span><span class="na">setTokenServices</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">UserInfoTokenServices</span><span class="p">(</span><span class="n">googleResource</span><span class="p">().</span><span class="na">getUserInfoUri</span><span class="p">(),</span><span class="w"> </span><span class="n">google</span><span class="p">().</span><span class="na">getClientId</span><span class="p">()));</span>
</span><span id="__span-47-24"><a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">filter</span><span class="p">;</span>
</span><span id="__span-47-25"><a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-47-26"><a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a>
</span><span id="__span-47-27"><a id="__codelineno-47-27" name="__codelineno-47-27" href="#__codelineno-47-27"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-47-28"><a id="__codelineno-47-28" name="__codelineno-47-28" href="#__codelineno-47-28"></a><span class="w">    </span><span class="nd">@ConfigurationProperties</span><span class="p">(</span><span class="s">&quot;google.client&quot;</span><span class="p">)</span>
</span><span id="__span-47-29"><a id="__codelineno-47-29" name="__codelineno-47-29" href="#__codelineno-47-29"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AuthorizationCodeResourceDetails</span><span class="w"> </span><span class="nf">google</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-30"><a id="__codelineno-47-30" name="__codelineno-47-30" href="#__codelineno-47-30"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AuthorizationCodeResourceDetails</span><span class="p">();</span>
</span><span id="__span-47-31"><a id="__codelineno-47-31" name="__codelineno-47-31" href="#__codelineno-47-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-47-32"><a id="__codelineno-47-32" name="__codelineno-47-32" href="#__codelineno-47-32"></a>
</span><span id="__span-47-33"><a id="__codelineno-47-33" name="__codelineno-47-33" href="#__codelineno-47-33"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-47-34"><a id="__codelineno-47-34" name="__codelineno-47-34" href="#__codelineno-47-34"></a><span class="w">    </span><span class="nd">@ConfigurationProperties</span><span class="p">(</span><span class="s">&quot;google.resource&quot;</span><span class="p">)</span>
</span><span id="__span-47-35"><a id="__codelineno-47-35" name="__codelineno-47-35" href="#__codelineno-47-35"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResourceServerProperties</span><span class="w"> </span><span class="nf">googleResource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-36"><a id="__codelineno-47-36" name="__codelineno-47-36" href="#__codelineno-47-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResourceServerProperties</span><span class="p">();</span>
</span><span id="__span-47-37"><a id="__codelineno-47-37" name="__codelineno-47-37" href="#__codelineno-47-37"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-47-38"><a id="__codelineno-47-38" name="__codelineno-47-38" href="#__codelineno-47-38"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we configure OAuth2 integration with Google as an OAuth2 provider. Spring Security handles the OAuth2
authentication process and allows access to protected resources after successful authentication.</p>
<p>By leveraging Spring Security's session management and integrating with authentication mechanisms like JWT and OAuth2,
you can build secure and user-friendly web applications that protect user data and ensure seamless authentication and
authorization. These features make Spring Security a powerful choice for implementing robust security in your projects.</p>
<h3 id="additional-considerations-and-best-practices_2">Additional Considerations and Best Practices:<a class="headerlink" href="#additional-considerations-and-best-practices_2" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Token Expiration</strong>: When using JWT or OAuth2, it's essential to configure token expiration properly. Short-lived
   tokens reduce the risk of unauthorized access if tokens are leaked. Implement token refresh mechanisms when
   necessary.</p>
</li>
<li>
<p><strong>Token Validation</strong>: Ensure that tokens are validated correctly, including signature verification and checking the
   token's integrity. Avoid using insecure JWT libraries or configurations.</p>
</li>
<li>
<p><strong>Secret Management</strong>: Safeguard the secrets used for signing JWTs or interacting with OAuth2 providers. Store
   secrets securely and avoid hardcoding them in your application code.</p>
</li>
<li>
<p><strong>Token Revocation</strong>: Consider implementing token revocation mechanisms to invalidate tokens in case of security
   breaches or user logout.</p>
</li>
<li>
<p><strong>OAuth2 Scopes</strong>: Understand and use OAuth2 scopes effectively to control the level of access granted to third-party
   applications. Define scopes that align with your application's security requirements.</p>
</li>
<li>
<p><strong>User Consent</strong>: If your application uses OAuth2 for third-party authentication, ensure that users are provided with
   clear information and options to consent to the data access requested by the third-party application.</p>
</li>
<li>
<p><strong>Logging and Monitoring</strong>: Implement logging and monitoring of authentication and authorization processes. This
   helps in detecting and responding to security incidents.</p>
</li>
<li>
<p><strong>Rate Limiting</strong>: Protect your authentication and authorization endpoints with rate limiting to mitigate brute-force
   and denial-of-service attacks.</p>
</li>
<li>
<p><strong>HTTPS</strong>: Always use HTTPS to secure communication between your application and the authentication provider,
   especially when dealing with tokens and sensitive user information.</p>
</li>
<li>
<p><strong>User Management</strong>: Ensure that user accounts are managed securely, including password management, account recovery
    processes, and enforcing strong password policies.</p>
</li>
<li>
<p><strong>JWT Claims</strong>: Use JWT claims to convey additional information about the user or the token itself. Be cautious
    about the information included in claims to avoid potential security risks.</p>
</li>
<li>
<p><strong>Token Storage</strong>: When working with JWT, consider where and how tokens are stored on the client-side. Avoid
    exposing tokens in URLs or storing them in insecure locations.</p>
</li>
<li>
<p><strong>OpenID Connect</strong>: If implementing OAuth2 for identity and user information, consider using OpenID Connect, an
    authentication layer on top of OAuth2 that provides standardized user information and authentication features.</p>
</li>
<li>
<p><strong>Testing</strong>: Perform security testing, including penetration testing and vulnerability scanning, to identify and
    address security weaknesses in your authentication mechanisms.</p>
</li>
<li>
<p><strong>Keep Dependencies Updated</strong>: Regularly update your Spring Security, JWT, or OAuth2 dependencies to benefit from
    security patches and improvements.</p>
</li>
</ol>
<p>By following these additional considerations and best practices, you can enhance the security of your authentication
mechanisms and provide a safer and more reliable experience for your users while using Spring Security in your
applications.</p>
<hr />
<h2 id="understanding-authentication-providers">Understanding Authentication Providers<a class="headerlink" href="#understanding-authentication-providers" title="Permanent link">&para;</a></h2>
<p>Authentication providers in Spring Security are responsible for validating user credentials and determining if a user is
who they claim to be. They play a crucial role in the authentication process by verifying usernames and passwords or
other authentication tokens. Spring Security supports various authentication providers,
including <code>DaoAuthenticationProvider</code>, <code>LdapAuthenticationProvider</code>, and custom providers. This article explores the
concept of authentication providers in Spring Security with practical examples.</p>
<p>Authentication providers in Spring Security are central components responsible for verifying the identity of users
during the authentication process. They determine whether a user is who they claim to be by validating their
credentials, such as usernames and passwords, or other authentication tokens. Spring Security offers flexibility in
choosing and configuring authentication providers to suit your application's needs. This article delves into the concept
of authentication providers in Spring Security and provides insights with practical examples.</p>
<h3 id="role-of-authentication-providers">Role of Authentication Providers:<a class="headerlink" href="#role-of-authentication-providers" title="Permanent link">&para;</a></h3>
<p>Authentication providers perform the following key tasks:</p>
<ol>
<li>
<p><strong>Credential Validation</strong>: Authentication providers validate user-supplied credentials, such as usernames and
   passwords, to ensure they match the expected values stored in a data source. This data source can be a database, LDAP
   server, or any custom authentication repository.</p>
</li>
<li>
<p><strong>Authentication Token Creation</strong>: Upon successful validation, authentication providers create an authentication
   token representing the authenticated user. This token is then associated with the user's security context for the
   duration of their session.</p>
</li>
<li>
<p><strong>Error Handling</strong>: Authentication providers handle authentication failures by throwing appropriate exceptions when
   credentials are incorrect. Spring Security can translate these exceptions into meaningful error messages or redirect
   users to a login page.</p>
</li>
</ol>
<h3 id="built-in-authentication-providers">Built-in Authentication Providers:<a class="headerlink" href="#built-in-authentication-providers" title="Permanent link">&para;</a></h3>
<p>Spring Security provides several built-in authentication providers:</p>
<ol>
<li>
<p><strong>DaoAuthenticationProvider</strong>: This provider is commonly used for database-based authentication. It validates
   credentials against a database table, where user details such as usernames and encrypted passwords are stored.</p>
</li>
<li>
<p><strong>LdapAuthenticationProvider</strong>: Used for LDAP (Lightweight Directory Access Protocol) authentication. It connects to
   an LDAP server to validate user credentials and retrieve user details.</p>
</li>
<li>
<p><strong>JwtAuthenticationProvider</strong>: Specialized for validating JWT (JSON Web Tokens) issued by external identity providers
   or for stateless authentication.</p>
</li>
<li>
<p><strong>RememberMeAuthenticationProvider</strong>: Handles remember-me authentication, allowing users to be automatically logged
   in based on remember-me tokens.</p>
</li>
<li>
<p><strong>AnonymousAuthenticationProvider</strong>: Provides an anonymous authentication token for unauthenticated users, allowing
   them to access certain resources while maintaining anonymity.</p>
</li>
</ol>
<h3 id="configuration-example-with-daoauthenticationprovider">Configuration Example with DaoAuthenticationProvider:<a class="headerlink" href="#configuration-example-with-daoauthenticationprovider" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">DaoAuthenticationProvider</span><span class="w"> </span><span class="nf">authenticationProvider</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="w">        </span><span class="n">DaoAuthenticationProvider</span><span class="w"> </span><span class="n">authProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DaoAuthenticationProvider</span><span class="p">();</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="w">        </span><span class="n">authProvider</span><span class="p">.</span><span class="na">setUserDetailsService</span><span class="p">(</span><span class="n">userDetailsService</span><span class="p">);</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="w">        </span><span class="n">authProvider</span><span class="p">.</span><span class="na">setPasswordEncoder</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">());</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">authProvider</span><span class="p">;</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="w">        </span><span class="n">auth</span><span class="p">.</span><span class="na">authenticationProvider</span><span class="p">(</span><span class="n">authenticationProvider</span><span class="p">());</span>
</span><span id="__span-48-19"><a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-20"><a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a>
</span><span id="__span-48-21"><a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-48-22"><a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-23"><a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-48-24"><a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-25"><a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we configure a <code>DaoAuthenticationProvider</code> to validate user credentials stored in a database. We
specify a custom <code>UserDetailsService</code> to load user details from the database, and we use the BCrypt password encoder for
secure password hashing.</p>
<h3 id="custom-authentication-providers">Custom Authentication Providers:<a class="headerlink" href="#custom-authentication-providers" title="Permanent link">&para;</a></h3>
<p>You can also create custom authentication providers by implementing the <code>AuthenticationProvider</code> interface. Custom
providers allow you to integrate with unique authentication sources or implement complex authentication logic specific
to your application.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w">        </span><span class="c1">// Implement custom authentication logic here</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="w">        </span><span class="c1">// Return an Authentication object if authentication is successful</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="w">        </span><span class="c1">// Throw AuthenticationException if authentication fails</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="w">        </span><span class="c1">// Specify which authentication token types this provider supports</span>
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="w">        </span><span class="c1">// For example, UsernamePasswordAuthenticationToken.class</span>
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="p">}</span>
</span></code></pre></div>
<p>Custom authentication providers can be added to the authentication manager using the <code>AuthenticationManagerBuilder</code>.</p>
<p>By understanding the role and configuration of authentication providers in Spring Security, you can implement secure and
flexible authentication processes that suit your application's requirements. Whether using built-in providers or
creating custom ones, authentication providers are essential for ensuring the identity and security of your users.</p>
<h3 id="authentication-provider-configuration">Authentication Provider Configuration:<a class="headerlink" href="#authentication-provider-configuration" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>AuthenticationManagerBuilder</strong>: Spring Security offers the <code>AuthenticationManagerBuilder</code> class, which simplifies
   the configuration of authentication providers. You can use its fluent API to specify authentication providers and
   configure their behavior.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="w">   </span><span class="nd">@Configuration</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">   </span><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">       </span><span class="nd">@Autowired</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">       </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">       </span><span class="nd">@Autowired</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureGlobal</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">           </span><span class="n">auth</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="w">               </span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">userDetailsService</span><span class="p">)</span>
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w">               </span><span class="p">.</span><span class="na">passwordEncoder</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">());</span>
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a>
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="w">       </span><span class="nd">@Bean</span>
</span><span id="__span-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-17"><a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a><span class="w">           </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-50-18"><a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-50-19"><a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we configure a <code>DaoAuthenticationProvider</code> that uses a <code>UserDetailsService</code> to load user details and
a <code>BCryptPasswordEncoder</code> for password encoding.</p>
<ol>
<li><strong>AuthenticationProvider Interface</strong>: When creating custom authentication providers, you implement
   the <code>AuthenticationProvider</code> interface. This interface requires you to implement the <code>authenticate</code> method, where you
   perform custom authentication logic. You also need to define the <code>supports</code> method to specify which authentication
   token types the provider supports.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">       </span><span class="nd">@Override</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">           </span><span class="c1">// Implement custom authentication logic here</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="w">       </span><span class="nd">@Override</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">           </span><span class="c1">// Specify supported authentication token types</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<p>After implementing your custom provider, you can configure it in your Spring Security configuration.</p>
<ol>
<li><strong>Multiple Authentication Providers</strong>: Spring Security allows you to configure multiple authentication providers,
   which can be used for different authentication mechanisms or sources. When multiple providers are configured, Spring
   Security iterates through them to find the one that supports the provided authentication token.</li>
</ol>
<div class="language-java highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="w">   </span><span class="nd">@Configuration</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w">   </span><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="w">       </span><span class="nd">@Autowired</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="w">       </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="w">       </span><span class="nd">@Autowired</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="w">       </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomAuthenticationProvider</span><span class="w"> </span><span class="n">customAuthenticationProvider</span><span class="p">;</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a><span class="w">       </span><span class="nd">@Override</span>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="w">           </span><span class="n">auth</span>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="w">               </span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">userDetailsService</span><span class="p">)</span>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="w">               </span><span class="p">.</span><span class="na">passwordEncoder</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">())</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="w">               </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">               </span><span class="p">.</span><span class="na">authenticationProvider</span><span class="p">(</span><span class="n">customAuthenticationProvider</span><span class="p">);</span>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a>
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="w">       </span><span class="nd">@Bean</span>
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a><span class="w">           </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<p>In this example, both a built-in <code>DaoAuthenticationProvider</code> and a custom <code>CustomAuthenticationProvider</code> are configured
to handle authentication.</p>
<h3 id="authentication-flow">Authentication Flow:<a class="headerlink" href="#authentication-flow" title="Permanent link">&para;</a></h3>
<p>When a user attempts to authenticate, Spring Security's authentication manager iterates through the configured
authentication providers, invoking the <code>authenticate</code> method of each provider. If a provider successfully authenticates
the user, it returns an <code>Authentication</code> object with the user's details and credentials.</p>
<p>The authentication manager selects the first successful authentication provider and associates the
corresponding <code>Authentication</code> object with the user's security context. If none of the providers succeeds,
an <code>AuthenticationException</code> is thrown, indicating authentication failure.</p>
<p>Authentication providers in Spring Security are a crucial part of the authentication process, allowing you to integrate
various authentication sources and mechanisms seamlessly. Whether using built-in providers or creating custom ones,
understanding their configuration and role is essential for building a secure authentication system in your application.</p>
<h3 id="examples-of-authentication-providers">Examples of Authentication Providers:<a class="headerlink" href="#examples-of-authentication-providers" title="Permanent link">&para;</a></h3>
<h4 id="1-pingfederate">1. <strong>PingFederate</strong>:<a class="headerlink" href="#1-pingfederate" title="Permanent link">&para;</a></h4>
<p><a href="https://www.pingidentity.com/en/products/pingfederate.html">PingFederate</a> is a popular identity provider that supports
various authentication methods, including SAML (Security Assertion Markup Language) and OAuth2. To integrate
PingFederate with Spring Security, you can use the <code>SAMLAuthenticationProvider</code> or <code>OAuth2LoginAuthenticationProvider</code>
provided by Spring Security.</p>
<p>Example configuration for PingFederate SAML integration:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="w">   </span><span class="nd">@Bean</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="n">SAMLConfigurer</span><span class="w"> </span><span class="nf">saml</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SAMLConfigurer</span><span class="p">()</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="w">           </span><span class="p">.</span><span class="na">sso</span><span class="p">()</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">               </span><span class="p">.</span><span class="na">defaultSuccessURL</span><span class="p">(</span><span class="s">&quot;/home&quot;</span><span class="p">)</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="w">               </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="w">           </span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">samlUserDetailsService</span><span class="p">())</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="w">           </span><span class="p">.</span><span class="na">sso</span><span class="p">()</span>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="w">               </span><span class="p">.</span><span class="na">ssoEndpoint</span><span class="p">(</span><span class="s">&quot;/sso/pingfederate&quot;</span><span class="p">)</span>
</span><span id="__span-53-10"><a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a><span class="w">               </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-53-11"><a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a><span class="w">           </span><span class="p">.</span><span class="na">metadataManager</span><span class="p">()</span>
</span><span id="__span-53-12"><a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a><span class="w">               </span><span class="p">.</span><span class="na">metadata</span><span class="p">(</span><span class="s">&quot;https://pingfederate.example.com/idp/metadata&quot;</span><span class="p">)</span>
</span><span id="__span-53-13"><a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a><span class="w">               </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-53-14"><a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a><span class="w">           </span><span class="p">.</span><span class="na">keyManager</span><span class="p">()</span>
</span><span id="__span-53-15"><a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a><span class="w">               </span><span class="p">.</span><span class="na">storeFilePath</span><span class="p">(</span><span class="s">&quot;classpath:saml/keystore.jks&quot;</span><span class="p">)</span>
</span><span id="__span-53-16"><a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="w">               </span><span class="p">.</span><span class="na">storePassword</span><span class="p">(</span><span class="s">&quot;keystore-password&quot;</span><span class="p">)</span>
</span><span id="__span-53-17"><a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="w">               </span><span class="p">.</span><span class="na">defaultKey</span><span class="p">(</span><span class="s">&quot;key-alias&quot;</span><span class="p">);</span>
</span><span id="__span-53-18"><a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<h4 id="2-okta">2. <strong>Okta</strong>:<a class="headerlink" href="#2-okta" title="Permanent link">&para;</a></h4>
<p><a href="https://www.okta.com/">Okta</a> is an identity and access management platform. To integrate Okta with Spring Security, you
can use Okta's OIDC (OpenID Connect) authentication flow along with Spring Security's <code>OidcUserService</code>.</p>
<p>Example configuration for Okta OIDC integration:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="w">   </span><span class="nd">@Bean</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="n">SecurityFilterChain</span><span class="w"> </span><span class="nf">defaultSecurityFilterChain</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">       </span><span class="n">http</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="w">           </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">(</span><span class="n">authorizeRequests</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="w">               </span><span class="n">authorizeRequests</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="w">                   </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">                   </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="w">           </span><span class="p">)</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="w">           </span><span class="p">.</span><span class="na">oauth2Login</span><span class="p">(</span><span class="n">oauth2Login</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="w">               </span><span class="n">oauth2Login</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a><span class="w">                   </span><span class="p">.</span><span class="na">userInfoEndpoint</span><span class="p">(</span><span class="n">userInfoEndpoint</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="w">                       </span><span class="n">userInfoEndpoint</span><span class="p">.</span><span class="na">oidcUserService</span><span class="p">(</span><span class="n">oidcUserService</span><span class="p">())</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a><span class="w">                   </span><span class="p">)</span>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a><span class="w">           </span><span class="p">);</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<h4 id="3-custom-authentication-providers">3. <strong>Custom Authentication Providers</strong>:<a class="headerlink" href="#3-custom-authentication-providers" title="Permanent link">&para;</a></h4>
<p>Besides external identity providers, you can also create custom authentication providers to integrate with in-house
authentication systems or other third-party systems that don't follow standard protocols. Implement
the <code>AuthenticationProvider</code> interface to define your custom authentication logic.</p>
<p>Example of a custom authentication provider:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthenticationProvider</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">       </span><span class="nd">@Override</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="n">Authentication</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">AuthenticationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">           </span><span class="c1">// Implement custom authentication logic here</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="w">       </span><span class="nd">@Override</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">       </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">authentication</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="w">           </span><span class="c1">// Specify supported authentication token types</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">       </span><span class="p">}</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<p>Authentication providers in Spring Security provide the flexibility to integrate with a wide range of identity and
authentication systems, allowing your application to leverage external authentication sources seamlessly. Whether you're
integrating with well-known identity providers like PingFederate and Okta or building custom authentication solutions,
Spring Security offers the tools and configurations needed to make the integration process straightforward and secure.</p>
<h4 id="4-microsoft-azure-active-directory-azure-ad">4. <strong>Microsoft Azure Active Directory (Azure AD)</strong>:<a class="headerlink" href="#4-microsoft-azure-active-directory-azure-ad" title="Permanent link">&para;</a></h4>
<p><a href="https://azure.microsoft.com/en-us/services/active-directory/">Azure AD</a> is Microsoft's cloud-based identity and access
management service. It supports various authentication protocols, including OpenID Connect and SAML. To integrate Azure
AD with Spring Security, you can use Spring Security's <code>OidcUserService</code> for OpenID Connect-based authentication
or <code>SAMLConfigurer</code> for SAML-based authentication.</p>
<p>Example configuration for Azure AD OpenID Connect integration:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="w">   </span><span class="nd">@Bean</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="n">SecurityFilterChain</span><span class="w"> </span><span class="nf">defaultSecurityFilterChain</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="w">       </span><span class="n">http</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="w">           </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">(</span><span class="n">authorizeRequests</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="w">               </span><span class="n">authorizeRequests</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="w">                   </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="w">                   </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="w">           </span><span class="p">)</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="w">           </span><span class="p">.</span><span class="na">oauth2Login</span><span class="p">(</span><span class="n">oauth2Login</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="w">               </span><span class="n">oauth2Login</span>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">                   </span><span class="p">.</span><span class="na">userInfoEndpoint</span><span class="p">(</span><span class="n">userInfoEndpoint</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="w">                       </span><span class="n">userInfoEndpoint</span><span class="p">.</span><span class="na">oidcUserService</span><span class="p">(</span><span class="n">oidcUserService</span><span class="p">())</span>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a><span class="w">                   </span><span class="p">)</span>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="w">           </span><span class="p">);</span>
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-56-16"><a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<h4 id="5-keycloak">5. <strong>Keycloak</strong>:<a class="headerlink" href="#5-keycloak" title="Permanent link">&para;</a></h4>
<p><a href="https://www.keycloak.org/">Keycloak</a> is an open-source identity and access management solution. It supports standard
protocols like OpenID Connect and OAuth2. To integrate Keycloak with Spring Security, you can use Spring
Security's <code>OidcUserService</code> for OpenID Connect-based authentication or <code>OAuth2LoginAuthenticationProvider</code> for
OAuth2-based authentication.</p>
<p>Example configuration for Keycloak OpenID Connect integration:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="w">   </span><span class="nd">@Bean</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="n">SecurityFilterChain</span><span class="w"> </span><span class="nf">defaultSecurityFilterChain</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">       </span><span class="n">http</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">           </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">(</span><span class="n">authorizeRequests</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="w">               </span><span class="n">authorizeRequests</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">                   </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="w">                   </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="w">           </span><span class="p">)</span>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="w">           </span><span class="p">.</span><span class="na">oauth2Login</span><span class="p">(</span><span class="n">oauth2Login</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="w">               </span><span class="n">oauth2Login</span>
</span><span id="__span-57-11"><a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="w">                   </span><span class="p">.</span><span class="na">userInfoEndpoint</span><span class="p">(</span><span class="n">userInfoEndpoint</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-57-12"><a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="w">                       </span><span class="n">userInfoEndpoint</span><span class="p">.</span><span class="na">oidcUserService</span><span class="p">(</span><span class="n">oidcUserService</span><span class="p">())</span>
</span><span id="__span-57-13"><a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="w">                   </span><span class="p">)</span>
</span><span id="__span-57-14"><a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="w">           </span><span class="p">);</span>
</span><span id="__span-57-15"><a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-57-16"><a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<p>These are just a few examples of identity providers that you can integrate with Spring Security. Each identity provider
may require specific configurations and settings in your Spring Security configuration. By understanding the integration
requirements of your chosen identity provider and leveraging Spring Security's extensibility, you can seamlessly
integrate external authentication systems into your application and enhance its security and user experience.</p>
<hr />
<h2 id="common-security-best-practices-with-spring-security">Common Security Best Practices with Spring Security<a class="headerlink" href="#common-security-best-practices-with-spring-security" title="Permanent link">&para;</a></h2>
<p>When using Spring Security, implementing robust security practices is essential to protect your application from
threats. This article outlines key security best practices, including strong password management, session management,
secure communication, and auditing. By following these practices, you can build a secure and resilient application using
Spring Security.</p>
<p>Spring Security is a powerful framework for securing your Java-based applications, but effective security requires a
proactive approach. Here are some common security best practices to follow when using Spring Security:</p>
<h3 id="1-strong-password-management">1. Strong Password Management:<a class="headerlink" href="#1-strong-password-management" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Password Hashing</strong>: Store passwords securely by using strong cryptographic hash functions like BCrypt. Spring
  Security provides password encoder implementations for this purpose.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="w">   </span><span class="nd">@Bean</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BCryptPasswordEncoder</span><span class="p">();</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="w">   </span><span class="p">}</span>
</span></code></pre></div>
<ul>
<li><strong>Password Policies</strong>: Enforce strong password policies, including minimum length, complexity, and expiration. Spring
  Security allows you to customize password validation rules.</li>
</ul>
<h3 id="2-session-management">2. Session Management:<a class="headerlink" href="#2-session-management" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Session Timeout</strong>: Set appropriate session timeouts to ensure that inactive sessions are terminated. Configure
  session management in your Spring Security configuration.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">sessionManagement</span><span class="p">()</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">       </span><span class="p">.</span><span class="na">maximumSessions</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="w">       </span><span class="p">.</span><span class="na">expiredUrl</span><span class="p">(</span><span class="s">&quot;/login?expired&quot;</span><span class="p">)</span>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="w">       </span><span class="p">.</span><span class="na">sessionRegistry</span><span class="p">(</span><span class="n">sessionRegistry</span><span class="p">());</span>
</span></code></pre></div>
<ul>
<li><strong>Session Fixation Protection</strong>: Enable session fixation protection to invalidate and recreate sessions upon user
  login.</li>
</ul>
<h3 id="3-secure-communication">3. Secure Communication:<a class="headerlink" href="#3-secure-communication" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Use HTTPS</strong>: Always use HTTPS to encrypt data transmitted between the client and server, especially during
  authentication and sensitive transactions.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">requiresChannel</span><span class="p">().</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">requiresSecure</span><span class="p">();</span>
</span></code></pre></div>
<ul>
<li><strong>Secure Cookies</strong>: Mark cookies as secure to ensure they are transmitted over HTTPS only.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="w">   </span><span class="n">http</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">       </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="w">           </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/secure/**&quot;</span><span class="p">).</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="w">           </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="w">       </span><span class="p">.</span><span class="na">rememberMe</span><span class="p">()</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="w">           </span><span class="p">.</span><span class="na">key</span><span class="p">(</span><span class="s">&quot;your-secure-key&quot;</span><span class="p">)</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="w">           </span><span class="p">.</span><span class="na">rememberMeCookieName</span><span class="p">(</span><span class="s">&quot;your-secure-cookie&quot;</span><span class="p">)</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="w">           </span><span class="p">.</span><span class="na">useSecureCookie</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="4-user-account-management">4. User Account Management:<a class="headerlink" href="#4-user-account-management" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Account Locking</strong>: Implement account locking mechanisms to prevent brute-force attacks. Lock user accounts after a
  certain number of failed login attempts.</p>
</li>
<li>
<p><strong>Password Reset</strong>: Offer secure password reset and account recovery options, including email verification and
  multi-factor authentication.</p>
</li>
</ul>
<h3 id="5-auditing-and-logging">5. Auditing and Logging:<a class="headerlink" href="#5-auditing-and-logging" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Audit Trails</strong>: Log security-related events and user actions. Maintain an audit trail for potential forensic
  analysis in case of security incidents.</p>
</li>
<li>
<p><strong>Access Control</strong>: Implement detailed access control and authorization checks throughout your application. Ensure
  that users have appropriate permissions to access resources.</p>
</li>
</ul>
<h3 id="6-security-headers">6. Security Headers:<a class="headerlink" href="#6-security-headers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>HTTP Security Headers</strong>: Add security headers to HTTP responses to mitigate common web vulnerabilities. Configure
  headers like <code>X-Content-Type-Options</code>, <code>X-Frame-Options</code>, and <code>Content-Security-Policy</code>.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">headers</span><span class="p">()</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="w">       </span><span class="p">.</span><span class="na">contentSecurityPolicy</span><span class="p">(</span><span class="s">&quot;script-src &#39;self&#39;&quot;</span><span class="p">)</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="w">       </span><span class="p">.</span><span class="na">frameOptions</span><span class="p">().</span><span class="na">deny</span><span class="p">()</span>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="w">       </span><span class="p">.</span><span class="na">contentTypeOptions</span><span class="p">().</span><span class="na">nosniff</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="7-role-based-access-control">7. Role-Based Access Control:<a class="headerlink" href="#7-role-based-access-control" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Role-Based Authorization</strong>: Implement role-based access control (RBAC) to define and enforce fine-grained access
  permissions for different user roles.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="w">       </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin/**&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;ADMIN&quot;</span><span class="p">)</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="w">       </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/user/**&quot;</span><span class="p">).</span><span class="na">hasRole</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">)</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="w">       </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="w">       </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="8-regular-security-updates">8. Regular Security Updates:<a class="headerlink" href="#8-regular-security-updates" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Dependency Management</strong>: Keep Spring Security and its dependencies up to date to benefit from security patches and
  improvements.</li>
</ul>
<p>By following these best practices and continually monitoring and adapting to emerging security threats, you can ensure
that your Spring Security-enabled application remains resilient against potential security risks. Building a secure
application is an ongoing process that requires vigilance and proactive security measures.</p>
<h3 id="9-implement-two-factor-authentication-2fa">9. Implement Two-Factor Authentication (2FA):<a class="headerlink" href="#9-implement-two-factor-authentication-2fa" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Two-Factor Authentication</strong>: Encourage or require users to enable two-factor authentication (2FA) for their
  accounts. 2FA adds an extra layer of security by verifying users' identities using something they know (password) and
  something they have (e.g., a mobile app-generated code).</li>
</ul>
<h3 id="10-protect-against-cross-site-request-forgery-csrf">10. Protect Against Cross-Site Request Forgery (CSRF):<a class="headerlink" href="#10-protect-against-cross-site-request-forgery-csrf" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>CSRF Protection</strong>: Ensure your application is protected against Cross-Site Request Forgery (CSRF) attacks by
  enabling CSRF protection in Spring Security. Use tokens to validate the authenticity of requests.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">csrf</span><span class="p">()</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="w">       </span><span class="p">.</span><span class="na">csrfTokenRepository</span><span class="p">(</span><span class="n">CookieCsrfTokenRepository</span><span class="p">.</span><span class="na">withHttpOnlyFalse</span><span class="p">());</span>
</span></code></pre></div>
<h3 id="11-validate-and-sanitize-user-input">11. Validate and Sanitize User Input:<a class="headerlink" href="#11-validate-and-sanitize-user-input" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Input Validation</strong>: Always validate and sanitize user input to prevent common security vulnerabilities such as SQL
  injection, Cross-Site Scripting (XSS), and other injection attacks.</li>
</ul>
<h3 id="12-rate-limiting-and-brute-force-protection">12. Rate Limiting and Brute-Force Protection:<a class="headerlink" href="#12-rate-limiting-and-brute-force-protection" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Rate Limiting</strong>: Implement rate limiting for login attempts and API requests to mitigate brute-force and
  denial-of-service attacks.</li>
</ul>
<h3 id="13-security-testing">13. Security Testing:<a class="headerlink" href="#13-security-testing" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Security Testing</strong>: Regularly conduct security testing, including penetration testing and vulnerability scanning, to
  identify and address potential security weaknesses in your application.</li>
</ul>
<h3 id="14-error-handling">14. Error Handling:<a class="headerlink" href="#14-error-handling" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Custom Error Pages</strong>: Customize error pages to provide minimal information about errors to prevent information
  leakage to potential attackers.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">exceptionHandling</span><span class="p">()</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="w">       </span><span class="p">.</span><span class="na">accessDeniedPage</span><span class="p">(</span><span class="s">&quot;/error/access-denied&quot;</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="15-security-headers-in-spring-security-filters">15. Security Headers in Spring Security Filters:<a class="headerlink" href="#15-security-headers-in-spring-security-filters" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Security Headers</strong>: Implement security headers within your Spring Security configuration or by using Spring Security
  filters. These headers add extra layers of security to your application.</li>
</ul>
<div class="language-java highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="w">   </span><span class="n">http</span><span class="p">.</span><span class="na">headers</span><span class="p">()</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="w">       </span><span class="p">.</span><span class="na">contentSecurityPolicy</span><span class="p">(</span><span class="s">&quot;script-src &#39;self&#39;&quot;</span><span class="p">)</span>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="w">       </span><span class="p">.</span><span class="na">frameOptions</span><span class="p">().</span><span class="na">deny</span><span class="p">()</span>
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="w">       </span><span class="p">.</span><span class="na">contentTypeOptions</span><span class="p">().</span><span class="na">nosniff</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="16-regular-security-training">16. Regular Security Training:<a class="headerlink" href="#16-regular-security-training" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Security Training</strong>: Train your development and operations teams on security best practices, and encourage a
  security-conscious culture within your organization.</li>
</ul>
<h3 id="17-compliance-with-regulations">17. Compliance with Regulations:<a class="headerlink" href="#17-compliance-with-regulations" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Regulatory Compliance</strong>: If your application handles sensitive data or operates in regulated industries (e.g.,
  healthcare or finance), ensure compliance with relevant regulations (e.g., GDPR, HIPAA, or PCI DSS).</li>
</ul>
<p>By incorporating these security best practices into your Spring Security-enabled application, you can significantly
reduce the risk of security breaches and enhance the overall security posture of your software. Security is an ongoing
process, and staying informed about emerging threats and vulnerabilities is crucial for maintaining a robust defense
against potential security risks.</p>
<hr />
<h2 id="secure-rest-apis">Secure REST APIs<a class="headerlink" href="#secure-rest-apis" title="Permanent link">&para;</a></h2>
<h3 id="introduction-to-securing-rest-apis-with-spring-security">Introduction to Securing REST APIs with Spring Security<a class="headerlink" href="#introduction-to-securing-rest-apis-with-spring-security" title="Permanent link">&para;</a></h3>
<p>Spring Security is a powerful and highly customizable authentication and access-control framework. It is the de-facto standard for securing Spring-based applications. Spring Security offers comprehensive security services for Java EE-based enterprise software applications. When it comes to REST APIs, securing them becomes crucial as they are exposed over the internet and can be potential targets for unauthorized access. In this guide, we will explore how to secure REST APIs using Spring Security, focusing on key concepts and step-by-step implementation.</p>
<h3 id="understanding-the-basics">Understanding the Basics<a class="headerlink" href="#understanding-the-basics" title="Permanent link">&para;</a></h3>
<p>Before diving into the implementation, it's essential to understand some core components of Spring Security that are pivotal in securing REST APIs:</p>
<ul>
<li><strong>Authentication:</strong> The process of verifying the identity of a user or system.</li>
<li><strong>Authorization:</strong> The process of determining whether an authenticated user has access to a particular resource or operation.</li>
<li><strong>Filters:</strong> In Spring Security, filters are used to intercept requests to enforce authentication and authorization.</li>
</ul>
<h3 id="step-by-step-guide-to-securing-rest-apis">Step-by-Step Guide to Securing REST APIs<a class="headerlink" href="#step-by-step-guide-to-securing-rest-apis" title="Permanent link">&para;</a></h3>
<h4 id="1-add-spring-security-dependencies">1. Add Spring Security Dependencies<a class="headerlink" href="#1-add-spring-security-dependencies" title="Permanent link">&para;</a></h4>
<p>First, include Spring Security in your project by adding the following dependencies to your <code>pom.xml</code> for Maven or <code>build.gradle</code> for Gradle.</p>
<p>For Maven:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-security<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div>
<p>For Gradle:</p>
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="n">implementation</span><span class="w"> </span><span class="s1">&#39;org.springframework.boot:spring-boot-starter-security&#39;</span>
</span></code></pre></div>
<h4 id="2-configure-websecurityconfigureradapter">2. Configure WebSecurityConfigurerAdapter<a class="headerlink" href="#2-configure-websecurityconfigureradapter" title="Permanent link">&para;</a></h4>
<p>Create a configuration class that extends <code>WebSecurityConfigurerAdapter</code>. Override the <code>configure(HttpSecurity http)</code> method to define your custom security configurations.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a>
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="w">            </span><span class="p">.</span><span class="na">csrf</span><span class="p">().</span><span class="na">disable</span><span class="p">()</span><span class="w"> </span><span class="c1">// Disable CSRF protection for stateless REST APIs</span>
</span><span id="__span-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-69-10"><a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a><span class="w">                </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span><span class="w"> </span><span class="c1">// Allow public access to certain endpoints</span>
</span><span id="__span-69-11"><a id="__codelineno-69-11" name="__codelineno-69-11" href="#__codelineno-69-11"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span><span class="w"> </span><span class="c1">// Require authentication for any other request</span>
</span><span id="__span-69-12"><a id="__codelineno-69-12" name="__codelineno-69-12" href="#__codelineno-69-12"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-69-13"><a id="__codelineno-69-13" name="__codelineno-69-13" href="#__codelineno-69-13"></a><span class="w">            </span><span class="p">.</span><span class="na">httpBasic</span><span class="p">();</span><span class="w"> </span><span class="c1">// Use HTTP Basic Authentication</span>
</span><span id="__span-69-14"><a id="__codelineno-69-14" name="__codelineno-69-14" href="#__codelineno-69-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-69-15"><a id="__codelineno-69-15" name="__codelineno-69-15" href="#__codelineno-69-15"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="3-implement-authentication-mechanism">3. Implement Authentication Mechanism<a class="headerlink" href="#3-implement-authentication-mechanism" title="Permanent link">&para;</a></h4>
<p>For REST APIs, you can use various authentication mechanisms such as Basic Authentication, JWT, OAuth2, etc. Here, we'll briefly touch upon HTTP Basic Authentication for simplicity.</p>
<p>Spring Security automatically handles HTTP Basic Authentication once you've configured it as shown above.</p>
<h4 id="4-customize-userdetailsservice">4. Customize UserDetailsService<a class="headerlink" href="#4-customize-userdetailsservice" title="Permanent link">&para;</a></h4>
<p>Implement your own <code>UserDetailsService</code> to load user-specific data. This is where you can integrate your user database to authenticate users.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nd">@Service</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomUserDetailsService</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDetailsService</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="nf">loadUserByUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a><span class="w">        </span><span class="c1">// Here, fetch user details from your user database</span>
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">(</span>
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a><span class="w">            </span><span class="s">&quot;user&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// username</span>
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a><span class="w">            </span><span class="s">&quot;{noop}password&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// password (prefix {noop} for no encryption in this example)</span>
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10" href="#__codelineno-70-10"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">()</span><span class="w"> </span><span class="c1">// roles</span>
</span><span id="__span-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11" href="#__codelineno-70-11"></a><span class="w">        </span><span class="p">);</span>
</span><span id="__span-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12" href="#__codelineno-70-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13" href="#__codelineno-70-13"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="5-secure-rest-endpoints">5. Secure REST Endpoints<a class="headerlink" href="#5-secure-rest-endpoints" title="Permanent link">&para;</a></h4>
<p>Use Spring Security annotations to secure individual REST endpoints or controller methods. For example, you can use <code>@PreAuthorize</code> to specify method-level security.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="nd">@RestController</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/secure-data&quot;</span><span class="p">)</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasRole(&#39;ROLE_USER&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getSecureData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="s">&quot;Secure Data&quot;</span><span class="p">);</span>
</span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-71-9"><a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>Securing REST APIs with Spring Security involves setting up authentication and authorization mechanisms tailored to your application's requirements. By following the steps outlined above, you can implement a basic security setup for your REST APIs. Always remember to adapt and extend the security configurations to meet your specific needs, such as using more advanced authentication mechanisms like JWT or OAuth2 for better security and flexibility. Encourage exploration of Spring Security's extensive documentation for deeper understanding and more advanced features.</p>
<h3 id="enhancing-security-with-advanced-features">Enhancing Security with Advanced Features<a class="headerlink" href="#enhancing-security-with-advanced-features" title="Permanent link">&para;</a></h3>
<p>After setting up the basic security configurations for your REST APIs using Spring Security, you might want to explore more advanced features and techniques to further enhance the security of your application. Here are some additional steps and concepts to consider:</p>
<h4 id="6-implement-jwt-authentication">6. Implement JWT Authentication<a class="headerlink" href="#6-implement-jwt-authentication" title="Permanent link">&para;</a></h4>
<p>JSON Web Tokens (JWT) offer a stateless and scalable way to manage user sessions and perform authentication and authorization. To use JWT with Spring Security:</p>
<ul>
<li><strong>Add JWT library dependencies</strong> to your project, such as <code>java-jwt</code> from Auth0.</li>
<li><strong>Implement a filter</strong> to validate JWT tokens in each request.</li>
<li><strong>Customize the authentication entry point</strong> to use JWT for authentication instead of basic authentication.</li>
</ul>
<h4 id="7-secure-rest-apis-with-oauth2">7. Secure REST APIs with OAuth2<a class="headerlink" href="#7-secure-rest-apis-with-oauth2" title="Permanent link">&para;</a></h4>
<p>OAuth2 is a protocol that allows third-party services to exchange web resources on behalf of a user. For more complex security requirements, especially when integrating with external services, consider implementing OAuth2:</p>
<ul>
<li><strong>Use Spring Security OAuth2</strong> support by adding the <code>spring-security-oauth2</code> dependency.</li>
<li><strong>Configure an OAuth2 authorization server</strong> to issue tokens.</li>
<li><strong>Set up resource servers</strong> to protect your APIs using the tokens issued by the authorization server.</li>
</ul>
<h4 id="8-use-https-for-secure-communication">8. Use HTTPS for Secure Communication<a class="headerlink" href="#8-use-https-for-secure-communication" title="Permanent link">&para;</a></h4>
<p>Ensuring that your REST APIs are accessible over HTTPS is crucial for protecting sensitive data in transit. Configure your Spring Boot application to run over HTTPS by:</p>
<ul>
<li><strong>Generating an SSL certificate</strong>, either from a trusted Certificate Authority (CA) or a self-signed certificate for development purposes.</li>
<li><strong>Configuring your Spring Boot application</strong> to use the SSL certificate by setting properties in <code>application.properties</code> or <code>application.yml</code>.</li>
</ul>
<h4 id="9-role-based-access-control-rbac">9. Role-Based Access Control (RBAC)<a class="headerlink" href="#9-role-based-access-control-rbac" title="Permanent link">&para;</a></h4>
<p>Define roles and permissions within your application to implement fine-grained access control. Spring Security supports role-based access control out of the box:</p>
<ul>
<li><strong>Define roles and authorities</strong> in your <code>UserDetailsService</code> implementation.</li>
<li><strong>Use method-level security annotations</strong> like <code>@PreAuthorize</code>, <code>@PostAuthorize</code>, <code>@Secured</code> to enforce role-based access control on your endpoints.</li>
</ul>
<h4 id="10-monitor-and-audit">10. Monitor and Audit<a class="headerlink" href="#10-monitor-and-audit" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Implement logging and auditing</strong> to monitor access and changes to your REST APIs. Spring Security provides support for auditing via its <code>AbstractAuthenticationAuditListener</code> and <code>AbstractAuthorizationAuditListener</code>.</li>
<li><strong>Use Spring Boot Actuator</strong> to monitor your application's health, metrics, and access to sensitive endpoints.</li>
</ul>
<h3 id="final-thoughts">Final Thoughts<a class="headerlink" href="#final-thoughts" title="Permanent link">&para;</a></h3>
<p>Securing REST APIs with Spring Security is an ongoing process that involves constant monitoring, updating, and testing against security threats. Always stay updated with the latest security practices and Spring Security releases. Additionally, consider security from the start of the development process and integrate security testing as part of your CI/CD pipeline to identify and mitigate vulnerabilities early.</p>
<p>By leveraging Spring Security's comprehensive features and following best practices, you can create robust, secure REST APIs that protect sensitive data and ensure a secure experience for your users. Engage with the Spring Security community and explore further documentation and resources to deepen your understanding and stay informed about the latest security trends and features.</p>
<hr />
<h2 id="implementing-jwt-authentication">Implementing JWT Authentication<a class="headerlink" href="#implementing-jwt-authentication" title="Permanent link">&para;</a></h2>
<p>JWT (JSON Web Token) authentication is a popular method for securing REST APIs as it allows for stateless authentication. This means the server does not need to keep a record of tokens. Here's a step-by-step guide on implementing JWT authentication in a Spring Security environment.</p>
<h3 id="step-1-add-dependencies">Step 1: Add Dependencies<a class="headerlink" href="#step-1-add-dependencies" title="Permanent link">&para;</a></h3>
<p>First, add the necessary dependencies for JWT handling to your project. You can use libraries like <code>jjwt</code> by JJWT to create and parse JWT tokens.</p>
<p>For Maven, add to <code>pom.xml</code>:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>io.jsonwebtoken<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>jjwt-api<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>0.11.2<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>io.jsonwebtoken<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>jjwt-impl<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>0.11.2<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a><span class="w">    </span><span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>io.jsonwebtoken<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>jjwt-jackson<span class="nt">&lt;/artifactId&gt;</span><span class="w"> </span><span class="cm">&lt;!-- For JSON processing --&gt;</span>
</span><span id="__span-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>0.11.2<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-72-16"><a id="__codelineno-72-16" name="__codelineno-72-16" href="#__codelineno-72-16"></a><span class="w">    </span><span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
</span><span id="__span-72-17"><a id="__codelineno-72-17" name="__codelineno-72-17" href="#__codelineno-72-17"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div>
<p>For Gradle, add to <code>build.gradle</code>:</p>
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="n">implementation</span><span class="w"> </span><span class="s1">&#39;io.jsonwebtoken:jjwt-api:0.11.2&#39;</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="n">runtimeOnly</span><span class="w"> </span><span class="s1">&#39;io.jsonwebtoken:jjwt-impl:0.11.2&#39;</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="n">runtimeOnly</span><span class="w"> </span><span class="s1">&#39;io.jsonwebtoken:jjwt-jackson:0.11.2&#39;</span><span class="w"> </span><span class="c1">// For JSON processing</span>
</span></code></pre></div>
<h3 id="step-2-create-jwt-utility-class">Step 2: Create JWT Utility Class<a class="headerlink" href="#step-2-create-jwt-utility-class" title="Permanent link">&para;</a></h3>
<p>Create a utility class to handle JWT creation, parsing, and validation. This class will be responsible for generating tokens upon successful authentication and validating tokens in subsequent requests.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.jsonwebtoken.Claims</span><span class="p">;</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.jsonwebtoken.Jwts</span><span class="p">;</span>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.jsonwebtoken.SignatureAlgorithm</span><span class="p">;</span>
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Date</span><span class="p">;</span>
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JwtUtil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;yourSecretKey&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Use a strong, secret key</span>
</span><span id="__span-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a>
</span><span id="__span-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generateToken</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Jwts</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
</span><span id="__span-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a><span class="w">                </span><span class="p">.</span><span class="na">setSubject</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span><span id="__span-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a><span class="w">                </span><span class="p">.</span><span class="na">setIssuedAt</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()))</span>
</span><span id="__span-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a><span class="w">                </span><span class="p">.</span><span class="na">setExpiration</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="c1">// 10 hours expiration</span>
</span><span id="__span-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a><span class="w">                </span><span class="p">.</span><span class="na">signWith</span><span class="p">(</span><span class="n">SignatureAlgorithm</span><span class="p">.</span><span class="na">HS256</span><span class="p">,</span><span class="w"> </span><span class="n">secret</span><span class="p">)</span>
</span><span id="__span-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a><span class="w">                </span><span class="p">.</span><span class="na">compact</span><span class="p">();</span>
</span><span id="__span-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a>
</span><span id="__span-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="nf">validateToken</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="n">userDetails</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extractUsername</span><span class="p">(</span><span class="n">token</span><span class="p">);</span>
</span><span id="__span-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">userDetails</span><span class="p">.</span><span class="na">getUsername</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">isTokenExpired</span><span class="p">(</span><span class="n">token</span><span class="p">));</span>
</span><span id="__span-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a>
</span><span id="__span-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">extractUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">extractClaim</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">Claims</span><span class="p">::</span><span class="n">getSubject</span><span class="p">);</span>
</span><span id="__span-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a>
</span><span id="__span-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">extractExpiration</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">extractClaim</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">Claims</span><span class="p">::</span><span class="n">getExpiration</span><span class="p">);</span>
</span><span id="__span-74-29"><a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-30"><a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a>
</span><span id="__span-74-31"><a id="__codelineno-74-31" name="__codelineno-74-31" href="#__codelineno-74-31"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">extractClaim</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Claims</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">claimsResolver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-32"><a id="__codelineno-74-32" name="__codelineno-74-32" href="#__codelineno-74-32"></a><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">Claims</span><span class="w"> </span><span class="n">claims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extractAllClaims</span><span class="p">(</span><span class="n">token</span><span class="p">);</span>
</span><span id="__span-74-33"><a id="__codelineno-74-33" name="__codelineno-74-33" href="#__codelineno-74-33"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">claimsResolver</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="n">claims</span><span class="p">);</span>
</span><span id="__span-74-34"><a id="__codelineno-74-34" name="__codelineno-74-34" href="#__codelineno-74-34"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-35"><a id="__codelineno-74-35" name="__codelineno-74-35" href="#__codelineno-74-35"></a>
</span><span id="__span-74-36"><a id="__codelineno-74-36" name="__codelineno-74-36" href="#__codelineno-74-36"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Claims</span><span class="w"> </span><span class="nf">extractAllClaims</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-37"><a id="__codelineno-74-37" name="__codelineno-74-37" href="#__codelineno-74-37"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Jwts</span><span class="p">.</span><span class="na">parser</span><span class="p">().</span><span class="na">setSigningKey</span><span class="p">(</span><span class="n">secret</span><span class="p">).</span><span class="na">parseClaimsJws</span><span class="p">(</span><span class="n">token</span><span class="p">).</span><span class="na">getBody</span><span class="p">();</span>
</span><span id="__span-74-38"><a id="__codelineno-74-38" name="__codelineno-74-38" href="#__codelineno-74-38"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-39"><a id="__codelineno-74-39" name="__codelineno-74-39" href="#__codelineno-74-39"></a>
</span><span id="__span-74-40"><a id="__codelineno-74-40" name="__codelineno-74-40" href="#__codelineno-74-40"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="nf">isTokenExpired</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">token</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-41"><a id="__codelineno-74-41" name="__codelineno-74-41" href="#__codelineno-74-41"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">extractExpiration</span><span class="p">(</span><span class="n">token</span><span class="p">).</span><span class="na">before</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">());</span>
</span><span id="__span-74-42"><a id="__codelineno-74-42" name="__codelineno-74-42" href="#__codelineno-74-42"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-74-43"><a id="__codelineno-74-43" name="__codelineno-74-43" href="#__codelineno-74-43"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="step-3-implement-authentication-filter">Step 3: Implement Authentication Filter<a class="headerlink" href="#step-3-implement-authentication-filter" title="Permanent link">&para;</a></h3>
<p>Create a filter to intercept requests and extract the JWT token. This filter will authenticate requests based on the token's validity.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.authentication.UsernamePasswordAuthenticationToken</span><span class="p">;</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.core.context.SecurityContextHolder</span><span class="p">;</span>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.security.web.authentication.WebAuthenticationDetailsSource</span><span class="p">;</span>
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.filter.OncePerRequestFilter</span><span class="p">;</span>
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>
</span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JwtRequestFilter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">OncePerRequestFilter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>
</span><span id="__span-75-8"><a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-75-9"><a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomUserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-75-10"><a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a>
</span><span id="__span-75-11"><a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-75-12"><a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JwtUtil</span><span class="w"> </span><span class="n">jwtUtil</span><span class="p">;</span>
</span><span id="__span-75-13"><a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>
</span><span id="__span-75-14"><a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-75-15"><a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doFilterInternal</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">FilterChain</span><span class="w"> </span><span class="n">chain</span><span class="p">)</span>
</span><span id="__span-75-16"><a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">ServletException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-75-17"><a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">authorizationHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getHeader</span><span class="p">(</span><span class="s">&quot;Authorization&quot;</span><span class="p">);</span>
</span><span id="__span-75-18"><a id="__codelineno-75-18" name="__codelineno-75-18" href="#__codelineno-75-18"></a>
</span><span id="__span-75-19"><a id="__codelineno-75-19" name="__codelineno-75-19" href="#__codelineno-75-19"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-75-20"><a id="__codelineno-75-20" name="__codelineno-75-20" href="#__codelineno-75-20"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-75-21"><a id="__codelineno-75-21" name="__codelineno-75-21" href="#__codelineno-75-21"></a>
</span><span id="__span-75-22"><a id="__codelineno-75-22" name="__codelineno-75-22" href="#__codelineno-75-22"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">authorizationHeader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">authorizationHeader</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;Bearer &quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-75-23"><a id="__codelineno-75-23" name="__codelineno-75-23" href="#__codelineno-75-23"></a><span class="w">            </span><span class="n">jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">authorizationHeader</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-75-24"><a id="__codelineno-75-24" name="__codelineno-75-24" href="#__codelineno-75-24"></a><span class="w">            </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jwtUtil</span><span class="p">.</span><span class="na">extractUsername</span><span class="p">(</span><span class="n">jwt</span><span class="p">);</span>
</span><span id="__span-75-25"><a id="__codelineno-75-25" name="__codelineno-75-25" href="#__codelineno-75-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-75-26"><a id="__codelineno-75-26" name="__codelineno-75-26" href="#__codelineno-75-26"></a>
</span><span id="__span-75-27"><a id="__codelineno-75-27" name="__codelineno-75-27" href="#__codelineno-75-27"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">SecurityContextHolder</span><span class="p">.</span><span class="na">getContext</span><span class="p">().</span><span class="na">getAuthentication</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-75-28"><a id="__codelineno-75-28" name="__codelineno-75-28" href="#__codelineno-75-28"></a><span class="w">            </span><span class="n">UserDetails</span><span class="w"> </span><span class="n">userDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">.</span><span class="na">loadUserByUsername</span><span class="p">(</span><span class="n">username</span><span class="p">);</span>
</span><span id="__span-75-29"><a id="__codelineno-75-29" name="__codelineno-75-29" href="#__codelineno-75-29"></a>
</span><span id="__span-75-30"><a id="__codelineno-75-30" name="__codelineno-75-30" href="#__codelineno-75-30"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jwtUtil</span><span class="p">.</span><span class="na">validateToken</span><span class="p">(</span><span class="n">jwt</span><span class="p">,</span><span class="w"> </span><span class="n">userDetails</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-75-31"><a id="__codelineno-75-31" name="__codelineno-75-31" href="#__codelineno-75-31"></a><span class="w">                </span><span class="n">UsernamePasswordAuthenticationToken</span><span class="w"> </span><span class="n">usernamePasswordAuthenticationToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">(</span>
</span><span id="__span-75-32"><a id="__codelineno-75-32" name="__codelineno-75-32" href="#__codelineno-75-32"></a><span class="w">                        </span><span class="n">userDetails</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">userDetails</span><span class="p">.</span><span class="na">getAuthorities</span><span class="p">());</span>
</span><span id="__span-75-33"><a id="__codelineno-75-33" name="__codelineno-75-33" href="#__codelineno-75-33"></a><span class="w">                </span><span class="n">usernamePasswordAuthenticationToken</span>
</span><span id="__span-75-34"><a id="__codelineno-75-34" name="__codelineno-75-34" href="#__codelineno-75-34"></a><span class="w">                        </span><span class="p">.</span><span class="na">setDetails</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">WebAuthenticationDetailsSource</span><span class="p">().</span><span class="na">buildDetails</span><span class="p">(</span><span class="n">request</span><span class="p">));</span>
</span><span id="__span-75-35"><a id="__codelineno-75-35" name="__codelineno-75-35" href="#__codelineno-75-35"></a><span class="w">                </span><span class="n">SecurityContextHolder</span><span class="p">.</span><span class="na">getContext</span><span class="p">().</span><span class="na">setAuthentication</span><span class="p">(</span><span class="n">usernamePasswordAuthenticationToken</span><span class="p">);</span>
</span><span id="__span-75-36"><a id="__codelineno-75-36" name="__codelineno-75-36" href="#__codelineno-75-36"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-75-37"><a id="__codelineno-75-37" name="__codelineno-75-37" href="#__codelineno-75-37"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-75-38"><a id="__codelineno-75-38" name="__codelineno-75-38" href="#__codelineno-75-38"></a><span class="w">        </span><span class="n">chain</span><span class="p">.</span><span class="na">doFilter</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-75-39"><a id="__codelineno-75-39" name="__codelineno-75-39" href="#__codelineno-75-39"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-75-40"><a id="__codelineno-75-40" name="__codelineno-75-40" href="#__codelineno-75-40"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="step-4-configure-spring-security-to-use-jwt">Step 4: Configure Spring Security to Use JWT<a class="headerlink" href="#step-4-configure-spring-security-to-use-jwt" title="Permanent link">&para;</a></h3>
<p>Modify your Spring Security configuration</p>
<p>to use the <code>JwtRequestFilter</code>.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfigurer</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WebSecurityConfigurerAdapter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomUserDetailsService</span><span class="w"> </span><span class="n">myUserDetailsService</span><span class="p">;</span>
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a>
</span><span id="__span-76-7"><a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-76-8"><a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JwtRequestFilter</span><span class="w"> </span><span class="n">jwtRequestFilter</span><span class="p">;</span>
</span><span id="__span-76-9"><a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a>
</span><span id="__span-76-10"><a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-76-11"><a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-12"><a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a><span class="w">        </span><span class="n">http</span><span class="p">.</span><span class="na">csrf</span><span class="p">().</span><span class="na">disable</span><span class="p">()</span>
</span><span id="__span-76-13"><a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a><span class="w">                </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">().</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/authenticate&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-76-14"><a id="__codelineno-76-14" name="__codelineno-76-14" href="#__codelineno-76-14"></a><span class="w">                </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-76-15"><a id="__codelineno-76-15" name="__codelineno-76-15" href="#__codelineno-76-15"></a><span class="w">                </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-76-16"><a id="__codelineno-76-16" name="__codelineno-76-16" href="#__codelineno-76-16"></a><span class="w">                </span><span class="p">.</span><span class="na">sessionManagement</span><span class="p">()</span>
</span><span id="__span-76-17"><a id="__codelineno-76-17" name="__codelineno-76-17" href="#__codelineno-76-17"></a><span class="w">                </span><span class="p">.</span><span class="na">sessionCreationPolicy</span><span class="p">(</span><span class="n">SessionCreationPolicy</span><span class="p">.</span><span class="na">STATELESS</span><span class="p">);</span>
</span><span id="__span-76-18"><a id="__codelineno-76-18" name="__codelineno-76-18" href="#__codelineno-76-18"></a>
</span><span id="__span-76-19"><a id="__codelineno-76-19" name="__codelineno-76-19" href="#__codelineno-76-19"></a><span class="w">        </span><span class="n">http</span><span class="p">.</span><span class="na">addFilterBefore</span><span class="p">(</span><span class="n">jwtRequestFilter</span><span class="p">,</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationFilter</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-76-20"><a id="__codelineno-76-20" name="__codelineno-76-20" href="#__codelineno-76-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-76-21"><a id="__codelineno-76-21" name="__codelineno-76-21" href="#__codelineno-76-21"></a>
</span><span id="__span-76-22"><a id="__codelineno-76-22" name="__codelineno-76-22" href="#__codelineno-76-22"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-76-23"><a id="__codelineno-76-23" name="__codelineno-76-23" href="#__codelineno-76-23"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">AuthenticationManagerBuilder</span><span class="w"> </span><span class="n">auth</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-24"><a id="__codelineno-76-24" name="__codelineno-76-24" href="#__codelineno-76-24"></a><span class="w">        </span><span class="n">auth</span><span class="p">.</span><span class="na">userDetailsService</span><span class="p">(</span><span class="n">myUserDetailsService</span><span class="p">);</span>
</span><span id="__span-76-25"><a id="__codelineno-76-25" name="__codelineno-76-25" href="#__codelineno-76-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-76-26"><a id="__codelineno-76-26" name="__codelineno-76-26" href="#__codelineno-76-26"></a>
</span><span id="__span-76-27"><a id="__codelineno-76-27" name="__codelineno-76-27" href="#__codelineno-76-27"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-76-28"><a id="__codelineno-76-28" name="__codelineno-76-28" href="#__codelineno-76-28"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PasswordEncoder</span><span class="w"> </span><span class="nf">passwordEncoder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-29"><a id="__codelineno-76-29" name="__codelineno-76-29" href="#__codelineno-76-29"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NoOpPasswordEncoder</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
</span><span id="__span-76-30"><a id="__codelineno-76-30" name="__codelineno-76-30" href="#__codelineno-76-30"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-76-31"><a id="__codelineno-76-31" name="__codelineno-76-31" href="#__codelineno-76-31"></a>
</span><span id="__span-76-32"><a id="__codelineno-76-32" name="__codelineno-76-32" href="#__codelineno-76-32"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-76-33"><a id="__codelineno-76-33" name="__codelineno-76-33" href="#__codelineno-76-33"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-76-34"><a id="__codelineno-76-34" name="__codelineno-76-34" href="#__codelineno-76-34"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AuthenticationManager</span><span class="w"> </span><span class="nf">authenticationManagerBean</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-35"><a id="__codelineno-76-35" name="__codelineno-76-35" href="#__codelineno-76-35"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kd">super</span><span class="p">.</span><span class="na">authenticationManagerBean</span><span class="p">();</span>
</span><span id="__span-76-36"><a id="__codelineno-76-36" name="__codelineno-76-36" href="#__codelineno-76-36"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-76-37"><a id="__codelineno-76-37" name="__codelineno-76-37" href="#__codelineno-76-37"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="step-5-add-authentication-endpoint">Step 5: Add Authentication Endpoint<a class="headerlink" href="#step-5-add-authentication-endpoint" title="Permanent link">&para;</a></h3>
<p>Create an endpoint that authenticates users and returns a JWT token upon successful authentication.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="nd">@RestController</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AuthenticationController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AuthenticationManager</span><span class="w"> </span><span class="n">authenticationManager</span><span class="p">;</span>
</span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JwtUtil</span><span class="w"> </span><span class="n">jwtTokenUtil</span><span class="p">;</span>
</span><span id="__span-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a>
</span><span id="__span-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CustomUserDetailsService</span><span class="w"> </span><span class="n">userDetailsService</span><span class="p">;</span>
</span><span id="__span-77-12"><a id="__codelineno-77-12" name="__codelineno-77-12" href="#__codelineno-77-12"></a>
</span><span id="__span-77-13"><a id="__codelineno-77-13" name="__codelineno-77-13" href="#__codelineno-77-13"></a><span class="w">    </span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/authenticate&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
</span><span id="__span-77-14"><a id="__codelineno-77-14" name="__codelineno-77-14" href="#__codelineno-77-14"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">createAuthenticationToken</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">AuthenticationRequest</span><span class="w"> </span><span class="n">authenticationRequest</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-77-15"><a id="__codelineno-77-15" name="__codelineno-77-15" href="#__codelineno-77-15"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-77-16"><a id="__codelineno-77-16" name="__codelineno-77-16" href="#__codelineno-77-16"></a><span class="w">            </span><span class="n">authenticationManager</span><span class="p">.</span><span class="na">authenticate</span><span class="p">(</span>
</span><span id="__span-77-17"><a id="__codelineno-77-17" name="__codelineno-77-17" href="#__codelineno-77-17"></a><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationToken</span><span class="p">(</span><span class="n">authenticationRequest</span><span class="p">.</span><span class="na">getUsername</span><span class="p">(),</span><span class="w"> </span><span class="n">authenticationRequest</span><span class="p">.</span><span class="na">getPassword</span><span class="p">())</span>
</span><span id="__span-77-18"><a id="__codelineno-77-18" name="__codelineno-77-18" href="#__codelineno-77-18"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-77-19"><a id="__codelineno-77-19" name="__codelineno-77-19" href="#__codelineno-77-19"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BadCredentialsException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-77-20"><a id="__codelineno-77-20" name="__codelineno-77-20" href="#__codelineno-77-20"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&quot;Incorrect username or password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
</span><span id="__span-77-21"><a id="__codelineno-77-21" name="__codelineno-77-21" href="#__codelineno-77-21"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-77-22"><a id="__codelineno-77-22" name="__codelineno-77-22" href="#__codelineno-77-22"></a>
</span><span id="__span-77-23"><a id="__codelineno-77-23" name="__codelineno-77-23" href="#__codelineno-77-23"></a><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="n">userDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userDetailsService</span>
</span><span id="__span-77-24"><a id="__codelineno-77-24" name="__codelineno-77-24" href="#__codelineno-77-24"></a><span class="w">                </span><span class="p">.</span><span class="na">loadUserByUsername</span><span class="p">(</span><span class="n">authenticationRequest</span><span class="p">.</span><span class="na">getUsername</span><span class="p">());</span>
</span><span id="__span-77-25"><a id="__codelineno-77-25" name="__codelineno-77-25" href="#__codelineno-77-25"></a>
</span><span id="__span-77-26"><a id="__codelineno-77-26" name="__codelineno-77-26" href="#__codelineno-77-26"></a><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jwtTokenUtil</span><span class="p">.</span><span class="na">generateToken</span><span class="p">(</span><span class="n">userDetails</span><span class="p">.</span><span class="na">getUsername</span><span class="p">());</span>
</span><span id="__span-77-27"><a id="__codelineno-77-27" name="__codelineno-77-27" href="#__codelineno-77-27"></a>
</span><span id="__span-77-28"><a id="__codelineno-77-28" name="__codelineno-77-28" href="#__codelineno-77-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AuthenticationResponse</span><span class="p">(</span><span class="n">jwt</span><span class="p">));</span>
</span><span id="__span-77-29"><a id="__codelineno-77-29" name="__codelineno-77-29" href="#__codelineno-77-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-77-30"><a id="__codelineno-77-30" name="__codelineno-77-30" href="#__codelineno-77-30"></a><span class="p">}</span>
</span></code></pre></div>
<p>Implementing JWT authentication in Spring Security involves setting up a JWT utility class for token management, configuring Spring Security to use JWT for authentication, and creating a filter to process JWT tokens in each request. With this setup, your Spring application can securely authenticate users and protect REST APIs using JWT tokens. Remember to keep your secret key secure and to consider the use of HTTPS to protect tokens in transit.</p>
<h3 id="advanced-jwt-authentication-concepts">Advanced JWT Authentication Concepts<a class="headerlink" href="#advanced-jwt-authentication-concepts" title="Permanent link">&para;</a></h3>
<p>After establishing the basics of JWT authentication in Spring Security, it's important to consider some advanced concepts and best practices to enhance the security and efficiency of your implementation.</p>
<h4 id="refresh-tokens">Refresh Tokens<a class="headerlink" href="#refresh-tokens" title="Permanent link">&para;</a></h4>
<p>In addition to access tokens (JWTs), implementing refresh tokens is a common practice. Refresh tokens have a longer lifespan and are used to obtain new access tokens after the access token expires. This approach minimizes the need for users to frequently re-authenticate.</p>
<ul>
<li><strong>Store refresh tokens securely</strong>, either in a database or a secure cookie, and implement endpoint(s) in your Spring application to handle refresh token requests.</li>
</ul>
<h4 id="exception-handling">Exception Handling<a class="headerlink" href="#exception-handling" title="Permanent link">&para;</a></h4>
<p>Properly handle exceptions related to JWT processing, such as expired tokens, signature validation failures, or token misuse. Customize the response to these errors to provide clear feedback to the client.</p>
<ul>
<li>Implement an <code>AuthenticationEntryPoint</code> to handle unauthorized access attempts and possibly a custom <code>AccessDeniedHandler</code> for handling insufficient permissions.</li>
</ul>
<h4 id="cors-configuration">CORS Configuration<a class="headerlink" href="#cors-configuration" title="Permanent link">&para;</a></h4>
<p>Cross-Origin Resource Sharing (CORS) needs to be configured properly in Spring Security to allow or restrict requests from different origins, especially for APIs consumed by web applications running on different domains.</p>
<ul>
<li>Use Spring's <code>CorsConfigurationSource</code> to define allowed origins, methods, headers, and other CORS-related settings.</li>
</ul>
<h4 id="secure-token-storage-on-client-side">Secure Token Storage on Client Side<a class="headerlink" href="#secure-token-storage-on-client-side" title="Permanent link">&para;</a></h4>
<p>When tokens are stored in client-side applications (e.g., web or mobile), ensure they are stored securely to prevent XSS or CSRF attacks.</p>
<ul>
<li>For web applications, store tokens in <code>HttpOnly</code> cookies or use secure mechanisms like Web Storage with proper precautions against XSS.</li>
<li>Implement CSRF protection if your application could be susceptible to such attacks, even though JWT is inherently resistant to CSRF.</li>
</ul>
<h4 id="token-revocation-and-blacklisting">Token Revocation and Blacklisting<a class="headerlink" href="#token-revocation-and-blacklisting" title="Permanent link">&para;</a></h4>
<p>Consider strategies for revoking tokens or blacklisting them before they expire, especially in cases of token theft or user logout.</p>
<ul>
<li>Implement a token blacklist using an in-memory store or a persistent storage solution. Check against this list in your custom filter or Spring Security configuration.</li>
</ul>
<h4 id="monitoring-and-analytics">Monitoring and Analytics<a class="headerlink" href="#monitoring-and-analytics" title="Permanent link">&para;</a></h4>
<p>Implement monitoring and logging to track authentication attempts, token issuance, and usage patterns. This data can be invaluable for identifying security incidents and understanding user behavior.</p>
<ul>
<li>Use Spring Boot Actuator, Spring Security events, and custom logging to monitor authentication events and token usage.</li>
</ul>
<h3 id="code-enhancements-and-optimization">Code Enhancements and Optimization<a class="headerlink" href="#code-enhancements-and-optimization" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Asynchronous Processing:</strong> For high-load applications, consider processing JWT validation and user authentication asynchronously to improve performance.</li>
<li><strong>Caching User Details:</strong> Implement caching for user details to reduce database load during frequent token validation.</li>
<li><strong>Key Rotation:</strong> Regularly rotate the secret key used to sign JWT tokens to mitigate the risk of token forgery.</li>
</ul>
<h3 id="continuous-security-assessment">Continuous Security Assessment<a class="headerlink" href="#continuous-security-assessment" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Regularly Update Dependencies:</strong> Keep your Spring Security and JWT library dependencies up to date to mitigate vulnerabilities.</li>
<li><strong>Security Audits:</strong> Regularly audit your security configuration and codebase for security vulnerabilities or misconfigurations.</li>
<li><strong>Automated Security Testing:</strong> Incorporate security testing tools and practices into your CI/CD pipeline to catch vulnerabilities early in the development cycle.</li>
</ul>
<p>JWT authentication in Spring Security is a powerful method for securing REST APIs, offering both flexibility and control over the authentication and authorization processes. By following these advanced concepts and best practices, you can ensure that your Spring Security implementation is robust, secure, and optimized for performance. Remember, security is an ongoing process that requires regular review and updates to protect against evolving threats.</p>
<hr />
<h2 id="spring-security-filter-chain">Spring Security Filter Chain<a class="headerlink" href="#spring-security-filter-chain" title="Permanent link">&para;</a></h2>
<p>The Spring Security Filter Chain is a core component of the Spring Security framework, playing a crucial role in the security process of a Spring-based web application. It consists of a series of Servlet Filters that are responsible for implementing various aspects of security, such as authentication, authorization, and exception handling. Each filter in the chain has a specific responsibility, and together, they form a comprehensive security mechanism that intercepts HTTP requests to your application.</p>
<h3 id="role-in-the-security-process">Role in the Security Process<a class="headerlink" href="#role-in-the-security-process" title="Permanent link">&para;</a></h3>
<p>The Spring Security Filter Chain operates on the principle of a chain of responsibility pattern, where each filter processes the request (or response) and then either passes it to the next filter in the chain or terminates the processing. This design allows for modular, reusable, and extendable security processing. Here's a breakdown of its role in the security process:</p>
<h4 id="1-request-capture">1. Request Capture<a class="headerlink" href="#1-request-capture" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Initial Entry Point:</strong> The filter chain acts as the initial entry point for security processing. It captures incoming HTTP requests and determines if further security processing is required.</li>
</ul>
<h4 id="2-authentication">2. Authentication<a class="headerlink" href="#2-authentication" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Credential Extraction:</strong> Filters such as <code>UsernamePasswordAuthenticationFilter</code> extract credentials (e.g., username and password) from the request.</li>
<li><strong>Authentication Manager:</strong> The extracted credentials are passed to the <code>AuthenticationManager</code>, which attempts to authenticate the user using the configured <code>AuthenticationProvider</code>(s).</li>
<li><strong>Authentication Success or Failure:</strong> Depending on the outcome, the filter chain proceeds to either the next security filter or handles the authentication failure.</li>
</ul>
<h4 id="3-authorization">3. Authorization<a class="headerlink" href="#3-authorization" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Access Decision:</strong> Post-authentication, filters like <code>FilterSecurityInterceptor</code> check if the authenticated user has the necessary permissions or roles to access the requested resource.</li>
<li><strong>Vote-Based Decisions:</strong> The access decision is typically made based on a set of <code>AccessDecisionVoter</code>s that vote on whether to grant or deny access.</li>
</ul>
<h4 id="4-exception-handling">4. Exception Handling<a class="headerlink" href="#4-exception-handling" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Security Exceptions:</strong> The filter chain handles various security-related exceptions, such as <code>AccessDeniedException</code> or <code>AuthenticationException</code>, providing appropriate responses or redirections.</li>
<li><strong>Custom Error Handling:</strong> Filters like <code>ExceptionTranslationFilter</code> are responsible for translating security exceptions into HTTP responses or redirecting to error pages or login forms.</li>
</ul>
<h4 id="5-session-management">5. Session Management<a class="headerlink" href="#5-session-management" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Session Creation:</strong> Filters manage session creation policies, determining whether new sessions should be created for authenticated users or existing sessions should be reused.</li>
<li><strong>Concurrent Session Control:</strong> The framework can limit concurrent sessions per user, preventing multiple logins with the same credentials.</li>
</ul>
<h4 id="6-csrf-protection">6. CSRF Protection<a class="headerlink" href="#6-csrf-protection" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Token Verification:</strong> The filter chain includes CSRF protection filters, such as <code>CsrfFilter</code>, that validate the presence and correctness of CSRF tokens in requests that modify state, preventing CSRF attacks.</li>
</ul>
<h4 id="7-logout-processing">7. Logout Processing<a class="headerlink" href="#7-logout-processing" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Logout Handling:</strong> The <code>LogoutFilter</code> intercepts logout requests, performs logout processing (e.g., invalidating sessions), and redirects users to a configured logout success URL.</li>
</ul>
<h3 id="customization-and-extension">Customization and Extension<a class="headerlink" href="#customization-and-extension" title="Permanent link">&para;</a></h3>
<p>Spring Security's filter chain is highly customizable, allowing developers to add, remove, or replace filters to meet their application's specific security requirements. This customization is typically done through the configuration of <code>HttpSecurity</code> in a class that extends <code>WebSecurityConfigurerAdapter</code> (or by using <code>SecurityFilterChain</code> bean in more recent Spring Security versions).</p>
<p>Customizing the Spring Security Filter Chain allows developers to tailor the security framework to the specific needs of their application, enhancing both security and performance. Let's explore how to customize and extend the filter chain effectively.</p>
<h3 id="customizing-the-filter-chain">Customizing the Filter Chain<a class="headerlink" href="#customizing-the-filter-chain" title="Permanent link">&para;</a></h3>
<h4 id="using-httpsecurity">Using <code>HttpSecurity</code><a class="headerlink" href="#using-httpsecurity" title="Permanent link">&para;</a></h4>
<p>The most common way to customize the filter chain is within a class that extends <code>WebSecurityConfigurerAdapter</code>, by overriding the <code>configure(HttpSecurity http)</code> method. Since Spring Security 5.4, you can also define a <code>SecurityFilterChain</code> bean directly, providing a more modular approach. Here’s how you can do it:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="nd">@EnableWebSecurity</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityConfig</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">SecurityFilterChain</span><span class="w"> </span><span class="nf">filterChain</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a><span class="w">        </span><span class="n">http</span>
</span><span id="__span-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a><span class="w">            </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">(</span><span class="n">authorizeRequests</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a><span class="w">                </span><span class="n">authorizeRequests</span>
</span><span id="__span-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a><span class="w">                    </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/public/**&quot;</span><span class="p">).</span><span class="na">permitAll</span><span class="p">()</span>
</span><span id="__span-78-10"><a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a><span class="w">                    </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-78-11"><a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-78-12"><a id="__codelineno-78-12" name="__codelineno-78-12" href="#__codelineno-78-12"></a><span class="w">            </span><span class="p">.</span><span class="na">httpBasic</span><span class="p">(</span><span class="n">withDefaults</span><span class="p">());</span>
</span><span id="__span-78-13"><a id="__codelineno-78-13" name="__codelineno-78-13" href="#__codelineno-78-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-78-14"><a id="__codelineno-78-14" name="__codelineno-78-14" href="#__codelineno-78-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-78-15"><a id="__codelineno-78-15" name="__codelineno-78-15" href="#__codelineno-78-15"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="adding-custom-filters">Adding Custom Filters<a class="headerlink" href="#adding-custom-filters" title="Permanent link">&para;</a></h4>
<p>To add custom filters, use the <code>addFilterBefore</code>, <code>addFilterAfter</code>, or <code>addFilterAt</code> methods provided by <code>HttpSecurity</code>. This allows you to insert your custom filter at a specific position in the filter chain.</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="n">http</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="w">    </span><span class="p">.</span><span class="na">addFilterBefore</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CustomFilter</span><span class="p">(),</span><span class="w"> </span><span class="n">UsernamePasswordAuthenticationFilter</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="key-filters-in-the-spring-security-filter-chain">Key Filters in the Spring Security Filter Chain<a class="headerlink" href="#key-filters-in-the-spring-security-filter-chain" title="Permanent link">&para;</a></h3>
<p>Understanding some of the key filters in the default filter chain can help you better customize your security configuration:</p>
<ul>
<li><strong>UsernamePasswordAuthenticationFilter</strong>: Handles form-based authentication.</li>
<li><strong>BasicAuthenticationFilter</strong>: Processes HTTP Basic authentication headers.</li>
<li><strong>DigestAuthenticationFilter</strong>: Supports HTTP Digest authentication.</li>
<li><strong>CsrfFilter</strong>: Applies Cross-Site Request Forgery (CSRF) protection.</li>
<li><strong>ExceptionTranslationFilter</strong>: Catches security exceptions and delegates to an <code>AuthenticationEntryPoint</code> or <code>AccessDeniedHandler</code>.</li>
<li><strong>FilterSecurityInterceptor</strong>: Performs the final access control checks.</li>
</ul>
<h3 id="extending-spring-security">Extending Spring Security<a class="headerlink" href="#extending-spring-security" title="Permanent link">&para;</a></h3>
<h4 id="implementing-custom-filters">Implementing Custom Filters<a class="headerlink" href="#implementing-custom-filters" title="Permanent link">&para;</a></h4>
<p>For specific security needs, such as API key authentication or complex logging, you might need to implement custom filters. Here's a basic template for creating a custom filter:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomFilter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">OncePerRequestFilter</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doFilterInternal</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">FilterChain</span><span class="w"> </span><span class="n">filterChain</span><span class="p">)</span>
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">ServletException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a>
</span><span id="__span-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a><span class="w">        </span><span class="c1">// Custom logic here</span>
</span><span id="__span-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a>
</span><span id="__span-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a><span class="w">        </span><span class="n">filterChain</span><span class="p">.</span><span class="na">doFilter</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">);</span><span class="w"> </span><span class="c1">// Proceed with the next filter</span>
</span><span id="__span-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="overriding-default-behavior">Overriding Default Behavior<a class="headerlink" href="#overriding-default-behavior" title="Permanent link">&para;</a></h4>
<p>You might also need to override the behavior of default Spring Security filters or replace them with custom implementations. This can be done by defining a bean of the same type with your custom logic and injecting it into the security configuration.</p>
<h3 id="security-context-persistence-across-requests">Security Context Persistence Across Requests<a class="headerlink" href="#security-context-persistence-across-requests" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>SecurityContextPersistenceFilter</strong>: This filter is responsible for loading and storing the <code>SecurityContext</code> for each request, ensuring that authentication information is available throughout the request's lifecycle. Customizing or extending this filter can help manage security context persistence in advanced scenarios, such as token-based authentication.</li>
</ul>
<p>Customizing the Spring Security Filter Chain is a powerful way to enhance and fine-tune the security of your Spring-based applications. Whether by adding custom filters, overriding default ones, or adjusting the configuration to suit your application’s needs, Spring Security provides the flexibility required to implement robust security measures. Always consider the implications of customizations on the overall security and performance of your application, and thoroughly test changes to ensure they meet your security requirements.</p>
<hr />
<h2 id="creating-custom-roles">Creating Custom Roles<a class="headerlink" href="#creating-custom-roles" title="Permanent link">&para;</a></h2>
<p>Spring Security supports role-based access control (RBAC) as part of its core functionality, allowing you to define roles and assign them to users to control access to resources. Custom roles can be created to fit the specific security requirements of your application. Here's an overview of the process involved in creating and using custom roles in Spring Security.</p>
<h3 id="1-define-custom-roles">1. Define Custom Roles<a class="headerlink" href="#1-define-custom-roles" title="Permanent link">&para;</a></h3>
<p>Custom roles are typically defined as strings, often prefixed with <code>ROLE_</code> to follow Spring Security's convention. For example:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Roles</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">ADMIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ROLE_ADMIN&quot;</span><span class="p">;</span>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ROLE_USER&quot;</span><span class="p">;</span>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">MANAGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ROLE_MANAGER&quot;</span><span class="p">;</span>
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="2-assign-roles-to-users">2. Assign Roles to Users<a class="headerlink" href="#2-assign-roles-to-users" title="Permanent link">&para;</a></h3>
<p>Roles are assigned to users in the application's user management system, which could be a database, an in-memory store, or an external authentication provider. When implementing the <code>UserDetailsService</code> interface, you return a <code>UserDetails</code> object for each user, which includes a collection of <code>GrantedAuthority</code> objects representing their roles.</p>
<p>Here's an example of assigning roles to a user:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="nd">@Override</span>
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">UserDetails</span><span class="w"> </span><span class="nf">loadUserByUsername</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="w">    </span><span class="c1">// Example user retrieval from a database</span>
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a><span class="w">    </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userRepository</span><span class="p">.</span><span class="na">findByUsername</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a><span class="w">        </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UsernameNotFoundException</span><span class="p">(</span><span class="s">&quot;User not found&quot;</span><span class="p">));</span>
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a>
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a><span class="w">    </span><span class="c1">// Convert user roles to GrantedAuthority objects</span>
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">GrantedAuthority</span><span class="o">&gt;</span><span class="w"> </span><span class="n">authorities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="na">getRoles</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span>
</span><span id="__span-82-9"><a id="__codelineno-82-9" name="__codelineno-82-9" href="#__codelineno-82-9"></a><span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">role</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleGrantedAuthority</span><span class="p">(</span><span class="n">role</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span>
</span><span id="__span-82-10"><a id="__codelineno-82-10" name="__codelineno-82-10" href="#__codelineno-82-10"></a><span class="w">            </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
</span><span id="__span-82-11"><a id="__codelineno-82-11" name="__codelineno-82-11" href="#__codelineno-82-11"></a>
</span><span id="__span-82-12"><a id="__codelineno-82-12" name="__codelineno-82-12" href="#__codelineno-82-12"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="na">springframework</span><span class="p">.</span><span class="na">security</span><span class="p">.</span><span class="na">core</span><span class="p">.</span><span class="na">userdetails</span><span class="p">.</span><span class="na">User</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">getUsername</span><span class="p">(),</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="na">getPassword</span><span class="p">(),</span><span class="w"> </span><span class="n">authorities</span><span class="p">);</span>
</span><span id="__span-82-13"><a id="__codelineno-82-13" name="__codelineno-82-13" href="#__codelineno-82-13"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="3-secure-endpoints-using-custom-roles">3. Secure Endpoints Using Custom Roles<a class="headerlink" href="#3-secure-endpoints-using-custom-roles" title="Permanent link">&para;</a></h3>
<p>With custom roles defined and assigned, you can now secure your application's endpoints by specifying which roles have access. This can be done using either method-level security annotations or URL-based security configurations in <code>HttpSecurity</code>.</p>
<h4 id="using-method-level-security-annotations">Using Method-Level Security Annotations<a class="headerlink" href="#using-method-level-security-annotations" title="Permanent link">&para;</a></h4>
<p>Enable method-level security by adding <code>@EnableGlobalMethodSecurity(prePostEnabled = true)</code> to your configuration. Then, use the <code>@PreAuthorize</code> or <code>@Secured</code> annotations to secure methods. For example:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="nd">@RestController</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasAuthority(&#39;ROLE_ADMIN&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/admin&quot;</span><span class="p">)</span>
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">adminOnly</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Admin content&quot;</span><span class="p">;</span>
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a><span class="w">    </span><span class="nd">@PreAuthorize</span><span class="p">(</span><span class="s">&quot;hasAnyAuthority(&#39;ROLE_ADMIN&#39;, &#39;ROLE_MANAGER&#39;)&quot;</span><span class="p">)</span>
</span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/manager&quot;</span><span class="p">)</span>
</span><span id="__span-83-12"><a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">managerOrAdmin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-83-13"><a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Manager or Admin content&quot;</span><span class="p">;</span>
</span><span id="__span-83-14"><a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-83-15"><a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="configuring-url-based-security">Configuring URL-Based Security<a class="headerlink" href="#configuring-url-based-security" title="Permanent link">&para;</a></h4>
<p>You can also configure access based on roles directly in the <code>HttpSecurity</code> configuration. This approach secures URLs or patterns at the web layer:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="nd">@Override</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="n">HttpSecurity</span><span class="w"> </span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="w">    </span><span class="n">http</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a><span class="w">        </span><span class="p">.</span><span class="na">authorizeRequests</span><span class="p">()</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a><span class="w">            </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/admin/**&quot;</span><span class="p">).</span><span class="na">hasAuthority</span><span class="p">(</span><span class="n">Roles</span><span class="p">.</span><span class="na">ADMIN</span><span class="p">)</span>
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a><span class="w">            </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/manager/**&quot;</span><span class="p">).</span><span class="na">hasAnyAuthority</span><span class="p">(</span><span class="n">Roles</span><span class="p">.</span><span class="na">ADMIN</span><span class="p">,</span><span class="w"> </span><span class="n">Roles</span><span class="p">.</span><span class="na">MANAGER</span><span class="p">)</span>
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a><span class="w">            </span><span class="p">.</span><span class="na">antMatchers</span><span class="p">(</span><span class="s">&quot;/user/**&quot;</span><span class="p">).</span><span class="na">hasAuthority</span><span class="p">(</span><span class="n">Roles</span><span class="p">.</span><span class="na">USER</span><span class="p">)</span>
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a><span class="w">            </span><span class="p">.</span><span class="na">anyRequest</span><span class="p">().</span><span class="na">authenticated</span><span class="p">()</span>
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a><span class="w">        </span><span class="p">.</span><span class="na">and</span><span class="p">()</span>
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a><span class="w">        </span><span class="p">.</span><span class="na">formLogin</span><span class="p">();</span>
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="4-role-hierarchy">4. Role Hierarchy<a class="headerlink" href="#4-role-hierarchy" title="Permanent link">&para;</a></h3>
<p>For more complex security requirements, you might need a role hierarchy where certain roles inherently include the authorities of other roles. Spring Security supports role hierarchies through the <code>RoleHierarchy</code> interface, which can be configured in your security configuration:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="nd">@Bean</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">RoleHierarchy</span><span class="w"> </span><span class="nf">roleHierarchy</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="w">    </span><span class="n">RoleHierarchyImpl</span><span class="w"> </span><span class="n">roleHierarchy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RoleHierarchyImpl</span><span class="p">();</span>
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">hierarchy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ROLE_ADMIN &gt; ROLE_MANAGER \n ROLE_MANAGER &gt; ROLE_USER&quot;</span><span class="p">;</span>
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a><span class="w">    </span><span class="n">roleHierarchy</span><span class="p">.</span><span class="na">setHierarchy</span><span class="p">(</span><span class="n">hierarchy</span><span class="p">);</span>
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">roleHierarchy</span><span class="p">;</span>
</span><span id="__span-85-7"><a id="__codelineno-85-7" name="__codelineno-85-7" href="#__codelineno-85-7"></a><span class="p">}</span>
</span></code></pre></div>
<p>Creating and using custom roles in Spring Security is a straightforward process that greatly enhances the flexibility and control of access management in your application. By defining custom roles, assigning them to users, and securing resources based on these roles, you can implement detailed and complex security policies tailored to your application's specific needs.</p>
<h3 id="advanced-role-based-access-control-and-best-practices">Advanced Role-Based Access Control and Best Practices<a class="headerlink" href="#advanced-role-based-access-control-and-best-practices" title="Permanent link">&para;</a></h3>
<p>After setting up basic custom roles in Spring Security, you can further refine your access control mechanisms and adopt best practices to ensure a robust security posture for your application. Here are some advanced considerations and best practices for managing roles and permissions in Spring Security.</p>
<h3 id="dynamic-role-assignment-and-management">Dynamic Role Assignment and Management<a class="headerlink" href="#dynamic-role-assignment-and-management" title="Permanent link">&para;</a></h3>
<p>In larger applications, roles and permissions might need to be managed dynamically, allowing for roles to be added, modified, or removed without redeploying the application. Consider implementing a management interface or utilizing an external service for role management. This approach typically involves:</p>
<ul>
<li><strong>Storing roles and permissions in a database</strong>, allowing for dynamic retrieval and modification.</li>
<li><strong>Caching roles and permissions</strong> to improve performance and reduce database load. Spring's cache abstraction can be used to cache role information after it is loaded from the database.</li>
<li><strong>Providing an admin interface</strong> for managing roles and permissions, enabling administrators to update access controls as needed.</li>
</ul>
<h3 id="fine-grained-permissions-with-spring-security-acl">Fine-Grained Permissions with Spring Security ACL<a class="headerlink" href="#fine-grained-permissions-with-spring-security-acl" title="Permanent link">&para;</a></h3>
<p>For applications requiring fine-grained access control, beyond simple role checks, consider using Spring Security's ACL (Access Control List) module. This module supports complex permission scenarios, such as granting access to specific resources based on user or role. Integrating ACL involves:</p>
<ul>
<li><strong>Adding the Spring Security ACL dependency</strong> to your project.</li>
<li><strong>Configuring an ACL service</strong> to retrieve permissions from a database.</li>
<li><strong>Using ACL annotations or method checks</strong> to enforce access controls on individual domain objects.</li>
</ul>
<h3 id="method-security-expressions">Method Security Expressions<a class="headerlink" href="#method-security-expressions" title="Permanent link">&para;</a></h3>
<p>Spring Security supports SpEL (Spring Expression Language) expressions in method security annotations, providing a powerful way to express complex security rules directly in your code. Use expressions to:</p>
<ul>
<li><strong>Check method arguments</strong>, allowing or denying access based on the values passed to the method.</li>
<li><strong>Access custom security logic</strong>, such as calling methods on beans defined in your Spring application context to determine access.</li>
</ul>
<h3 id="role-and-permission-strategies">Role and Permission Strategies<a class="headerlink" href="#role-and-permission-strategies" title="Permanent link">&para;</a></h3>
<p>When defining roles and permissions, consider strategies that will scale with your application and remain manageable. Some approaches include:</p>
<ul>
<li><strong>Role grouping</strong>: Create roles that represent groups of permissions for specific functionality within your application, reducing the granularity of permissions assigned to individual users.</li>
<li><strong>Composite roles</strong>: Use roles that inherently include other roles, simplifying the assignment of related sets of permissions.</li>
<li><strong>Permission-based access control</strong>: In some cases, checking against specific permissions, rather than roles, may provide more flexibility. This can be particularly useful for fine-grained access control within complex domains.</li>
</ul>
<h3 id="testing-security-configurations">Testing Security Configurations<a class="headerlink" href="#testing-security-configurations" title="Permanent link">&para;</a></h3>
<p>Thoroughly test your security configurations to ensure that access controls work as expected. Spring Security Test provides annotations and utilities for testing security configurations, including support for setting up authentication, testing method security, and mocking LDAP templates.</p>
<h3 id="security-best-practices">Security Best Practices<a class="headerlink" href="#security-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Principle of Least Privilege</strong>: Always assign the minimum necessary permissions to roles and users.</li>
<li><strong>Regular Audits</strong>: Periodically review roles, permissions, and access controls to ensure they still meet the business requirements and have not introduced any security vulnerabilities.</li>
<li><strong>Secure Role Management</strong>: Protect endpoints and interfaces used for managing roles and permissions to prevent unauthorized access or modifications.</li>
</ul>
<p>Implementing custom roles in Spring Security is just the beginning of building a secure application. By considering dynamic role management, leveraging ACL for fine-grained access control, utilizing method security expressions, and following security best practices, you can create a robust and flexible security model that scales with your application's needs. Always keep security at the forefront of your development process, continuously evaluate your security posture, and adapt to new threats and business requirements.</p>
<hr />
<hr />
<hr />
<hr />







  
  




  



                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["search.highlight", "search.suggest", "navigation.path", "navigation.top", "content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.indexes", {"palette": [{"media": "(prefers-color-scheme)", "toggle": {"icon": "material/link", "name": "Switch to light mode"}}, {"accent": "indigo", "media": "(prefers-color-scheme: light)", "primary": "indigo", "scheme": "default", "toggle": {"icon": "material/toggle-switch", "name": "Switch to dark mode"}}, {"accent": "indigo", "media": "(prefers-color-scheme: dark)", "primary": "black", "scheme": "slate", "toggle": {"icon": "material/toggle-switch-off", "name": "Switch to system preference"}}]}], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>